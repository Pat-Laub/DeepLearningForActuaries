<!DOCTYPE html>
<html lang="en"><head>
<script src="computer-vision_files/libs/clipboard/clipboard.min.js"></script>
<script src="computer-vision_files/libs/quarto-html/tabby.min.js"></script>
<script src="computer-vision_files/libs/quarto-html/popper.min.js"></script>
<script src="computer-vision_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="computer-vision_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="computer-vision_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="computer-vision_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Dr Patrick Laub">
  <title>Computer Vision</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="computer-vision_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="computer-vision_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="computer-vision_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="computer-vision_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="computer-vision_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
<div class="line right"></div>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="unsw-yellow-shape.png" data-background-size="contain !important" class="quarto-title-block center">
  <h1 class="title">Computer Vision</h1>
  <p class="subtitle">ACTL3143 &amp; ACTL5111 Deep Learning for Actuaries</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr Patrick Laub 
</div>
</div>
</div>

</section>
<section>
<section id="section" class="title-slide slide level1 center">
<h1></h1>
<h2>
Lecture Outline
</h2>
<p><br></p>
<ul>
<li>Convolutional Layers</li>
<li>Convolutional Neural Networks</li>
<li>Demo: CNNs in Keras</li>
<li>Hyperparameter tuning</li>
</ul>
<p>Slides: original draft thanks to Hang Nguyen.</p>
<p><br><br></p>
</section>
<section id="load-packages" class="slide level2" data-visibility="uncounted">
<h2>Load packages</h2>
<p><br></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> random</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> plot_model</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="op">%</span>load_ext watermark</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="op">%</span>watermark <span class="op">-</span>p numpy,pandas,tensorflow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numpy     : 1.23.4
pandas    : 1.5.1
tensorflow: 2.10.0
</code></pre>
</div>
</div>
</section></section>
<section>
<section id="images" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Images</h1>

</section>
<section id="shapes-of-photos" class="slide level2">
<h2>Shapes of photos</h2>

<img data-src="rgb-channels.png" class="r-stretch quarto-figure-center"><p class="caption">A photo is a rank 3 tensor.</p><div class="footer">
<p>Source: Kim et al (2021), <a href="https://www.mdpi.com/applsci/applsci-11-03418/article_deploy/html/images/applsci-11-03418-g001.png">Data Hiding Method for Color AMBTC Compressed Images Using Color Difference</a>, Applied Sciences.</p>
</div>
</section>
<section id="how-the-computer-sees-them" class="slide level2 smaller">
<h2>How the computer sees them</h2>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> matplotlib.image <span class="im">import</span> imread</span>
<span id="cb3-2"><a href="#cb3-2"></a>img1 <span class="op">=</span> imread(<span class="st">'pu.gif'</span>)<span class="op">;</span> img2 <span class="op">=</span> imread(<span class="st">'pl.gif'</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>img3 <span class="op">=</span> imread(<span class="st">'pr.gif'</span>)<span class="op">;</span> img4 <span class="op">=</span> imread(<span class="st">'pg.bmp'</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="ss">f"Shapes are: </span><span class="sc">{</span>img1<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img2<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img3<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img4<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>'Shapes are: (16, 16, 3), (16, 16, 3), (16, 16, 3), (16, 16, 3).'</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>img1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>img2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>img3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>img4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="how-we-see-them" class="slide level2">
<h2>How we see them</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> imshow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>imshow(img1)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-11-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>imshow(img2)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-12-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>imshow(img3)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-13-output-1.png"></p>
</div>
</div>
</div><div class="column" style="width:25%;">
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>imshow(img4)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-14-output-1.png"></p>
</div>
</div>
</div>
</div>
</section>
<section id="why-is-255-special" class="slide level2">
<h2>Why is 255 special?</h2>
<p>Each pixels colour intensity is stored in one byte.</p>
<p>One byte is 8 bits, so in binary that is 00000000 to 11111111.</p>
<p>The largest <em>unsigned</em> number this can be is <span class="math inline">\(2^8-1 = 255\)</span>.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>np.uint8(<span class="dv">0</span>), np.uint8(<span class="dv">1</span>), np.uint8(<span class="dv">255</span>), np.uint8(<span class="dv">256</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(0, 1, 255, 0)</code></pre>
</div>
</div>
<p>If you had <em>signed</em> numbers, this would go from -128 to 127.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>np.int8(<span class="op">-</span><span class="dv">128</span>), np.int8(<span class="dv">0</span>), np.int8(<span class="dv">127</span>), np.int8(<span class="dv">128</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(-128, 0, 127, -128)</code></pre>
</div>
</div>
<p>Alternatively, <em>hexidecimal</em> numbers are used. E.g. 10100001 is split into 1010 0001, and 1010=A, 0001=1, so combined it is 0xA1.</p>
</section>
<section id="image-editing-with-kernels" class="slide level2">
<h2>Image editing with kernels</h2>
<p>Take a look at <a href="https://setosa.io/ev/image-kernels/">https://setosa.io/ev/image-kernels/</a>.</p>

<img data-src="convolution.gif" class="r-stretch quarto-figure-center"><p class="caption">An example of an image kernel in action.</p><div class="footer">
<p>Source: <a href="http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution">Stanfords deep learning tutorial</a> via <a href="https://stats.stackexchange.com/a/188216">Stack Exchange</a>.</p>
</div>
</section>
<section id="face-detection-visualised" class="slide level2">
<h2>Face detection visualised</h2>
<center>
<iframe src="https://player.vimeo.com/video/12774628?h=5f310c41f4" width="540" height="510" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen="">
</iframe>
</center>
<div class="footer">
<p>Source: Harvey (2010), <a href="https://vimeo.com/12774628"><em>OpenCV Face Detection: Visualized</em></a>, Vimeo.</p>
</div>
</section></section>
<section>
<section id="convolutional-layers" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Convolutional Layers</h1>

</section>
<section id="convolution-not-complicated" class="slide level2">
<h2>Convolution not complicated</h2>
<p><br></p>
<p>Say <span class="math inline">\(X_1, X_2 \sim f_X\)</span> are i.i.d., and we look at <span class="math inline">\(S = X_1 + X_2\)</span>.</p>
<p>The density for <span class="math inline">\(S\)</span> is then</p>
<p><span class="math display">\[
f_S(s) = \int_{x_1=-\infty}^{\infty} f_X(x_1) \, f_X(s-x_1) \,\mathrm{d}s .
\]</span></p>
<p>This is the <em>convolution</em> operation, <span class="math inline">\(f_S = f_X \star f_X\)</span>.</p>
</section>
<section id="tensor" class="slide level2 smaller">
<h2>Tensor</h2>
<ul>
<li>Images are 3D tensors with height, weight and number of channel.</li>
</ul>

<img data-src="Glassner/16-1.png" class="r-stretch quarto-figure-center"><p class="caption">Example of 3D Tensor.</p><ul>
<li>Slices through the channels are called elements. In RGB color images, elements are pixels.</li>
<li>Grayscale image has 1 channel. Color image has 3 channels. Each pixel of a color image contains value for: red, green and blue (RGB color). Example: if RGB values are between 0 and 1, a yellow pixel has red and green values of 1 and blue value of 0.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow" class="slide level2">
<h2>Example: Detecting yellow</h2>
<ul>
<li>To detect yellow color in a color image, apply a neuron to each pixel in the image.</li>
</ul>

<img data-src="Glassner/16-3.png" class="r-stretch quarto-figure-center"><p class="caption">Applying a neuron to an image pixel.</p><ul>
<li>If red/green value decreases or blue value increases, the pixel color shifts away from yellow. So we can set the weights of the neuron to be 1, 1 and -1.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="filter" class="slide level2 smaller">
<h2>Filter</h2>
<ul>
<li>The output is produced by <em>sweeping</em> the neuron over the input, or <em>scanning</em> the input. This is called <strong>convolution</strong>.</li>
</ul>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-4.png"></p>
<p></p><figcaption>Scan the 3-channel input (color image) with the neuron to produce a 1-channel output (grayscale image).</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-5.png"></p>
<p></p><figcaption>The more yellow the pixel in the color image (left), the more white it is in the grayscale image.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>The neuron or its weights is called a <strong>filter</strong>. We <em>convolve</em> the image with a filter, so the filter is a <strong>convolutional filter</strong>.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="weight-sharing" class="slide level2">
<h2>Weight sharing</h2>
<ul>
<li>The same neuron is used to sweep over the image, so we can store the weights in some shared memory and process the pixels in parallel.</li>
<li>We say that the neurons are <em>weight sharing</em>.</li>
</ul>
</section>
<section id="filter-input" class="slide level2">
<h2>Filter input</h2>
<ul>
<li>In the previous example, the neuron only takes one pixel as input.</li>
<li>Usually a larger filter containing a <em>block of weights</em> is used to process not only a pixel but also its neighboring pixels all at once.</li>
<li>The weights are called the filter <strong>kernels</strong>.</li>
<li>The cluster of pixels that forms the input of a filter is called its <em>footprint</em>.</li>
</ul>
</section>
<section id="spatial-filter" class="slide level2">
<h2>Spatial filter</h2>

<img data-src="Glassner/16-9.png" class="r-stretch quarto-figure-center"><p class="caption">Example: a 3x3 filter</p><ul>
<li>Each pixel is multiplied by its corresponding weight, results are summed up and run through an activation function to obtain one <em>single</em> output value.</li>
<li>When a filters footprint is more than one pixel, it is called a <strong>spatial filter</strong>.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="multidimensional-convolution" class="slide level2">
<h2>Multidimensional convolution</h2>
<p>To process an input with multiple channels (ex: a color image), the (spatial) filter also need to have the same number of channels.</p>

<img data-src="Glassner/16-18.png" class="r-stretch quarto-figure-center"><p class="caption">Example: a 3x3 filter with 3 channels, containing 27 weights.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example" class="slide level2 smaller">
<h2>Example</h2>
<ul>
<li>Input is a 3x3 footprint with 3 channels (pixels of a color image).</li>
<li>Each channel of the filter is applied to each channel of the footprint.</li>
<li>One single output is produced for each channel.</li>
<li>Sum them up and run through an activation function. Final output is a single grayscale image pixel.</li>
</ul>

<img data-src="Glassner/16-19.png" class="r-stretch quarto-figure-center"><p class="caption">Example of channels applied separately.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="input-output-relationship" class="slide level2">
<h2>Input-output relationship</h2>

<img data-src="Glassner/16-10.png" class="r-stretch quarto-figure-center"><p class="caption">Matching the original image footprints against the output location.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section></section>
<section>
<section id="convolutional-layer-options" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Convolutional Layer Options</h1>

</section>
<section id="padding" class="slide level2">
<h2>Padding</h2>

<img data-src="Glassner/16-15.png" class="r-stretch quarto-figure-center"><p class="caption">What happens when filters go off the edge of the input?</p><ul>
<li>How to avoid the filters receptive field falling off the side of the input.</li>
<li>If we only scan the filter over places of the input where the filter can fit perfectly, it will lead to loss of information, especially after many filters.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="padding-1" class="slide level2">
<h2>Padding</h2>
<p>Add a border of extra elements around the input, called <strong>padding</strong>. Normally we place zeros in all the new elements, called <strong>zero padding</strong>.</p>

<img data-src="Glassner/16-17.png" class="r-stretch quarto-figure-center"><p class="caption">Padded values can be added to the outside of the input.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="convolution-layer" class="slide level2">
<h2>Convolution layer</h2>
<ul>
<li>Multiple filters are bundled together in one layer (of the CNN).</li>
<li>The filters are applied <em>simultaneously</em> and <em>independently</em> to the input.</li>
<li>Filters can have different footprints, but in practice we almost always use the same footprint for every filter in a convolution layer.</li>
<li>Number of channels in the output will be the same as the number of filters (like in the previous example, 3-channel color image turns into 1-channel grayscale image when only 1 filter is applied).</li>
</ul>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<div class="columns">
<div class="column">
<p>In the image:</p>
<ul>
<li>6-channel input tensor</li>
<li>input pixels</li>
<li>four 3x3 filters</li>
<li>four output tensors</li>
<li>final output tensor.</li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-21.png"></p>
<p></p><figcaption>Example network highlighting that the number of output channels equals the number of filters.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="x1-convolution-and-feature-reduction" class="slide level2">
<h2>1x1 convolution and feature reduction</h2>
<ul>
<li>Feature reduction: Reduce the number of channels in the input tensor (removing correlated features) by using fewer filters than the number of channels in the input. This is because the number of channels in the output is always the same as number of filters.</li>
<li>1x1 convolution: Convolution using 1x1 filters.</li>
<li>When the channels are correlated, 1x1 convolution is very effective at reducing channels without loss of information.</li>
</ul>
</section>
<section id="example-of-1x1-convolution" class="slide level2 smaller">
<h2>Example of 1x1 convolution</h2>

<img data-src="Glassner/16-23.png" class="r-stretch quarto-figure-center"><p class="caption">Example network with 1x1 convolution.</p><ul>
<li>Input tensor contains 300 channels.</li>
<li>Use 175 1x1 filters in the convolution layer (each filter obviously has 300 channels, same number as the input).</li>
<li>Each filter produces a 1-channel output.</li>
<li>Final output tensor has 175 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="thought-experiment-1x1-use-case" class="slide level2">
<h2>Thought experiment / 1x1 use case</h2>
<ul>
<li>A classifier is created to identify the presence of eyes in a photograph.</li>
<li>A convolution layer containing 12 different filters are used to detect different kinds of eyes in the input: human eyes, cat eye, fish eyes, and so on.</li>
<li>But we only need to detect eyes, regardless of the species. Only need 1 channel representing whether or not an eye is found.</li>
<li>We add another convolution layer containing 1 filter, then 12 channels will reduce to 1 channel.</li>
</ul>
</section>
<section id="training-cnns" class="slide level2">
<h2>Training CNNs</h2>
<ul>
<li>To train the network, we need to specify:
<ul>
<li>number of filters,</li>
<li>their footprints,</li>
<li>activation functions,</li>
<li>padding.</li>
</ul></li>
<li>The filter weights are learned by the network (backprop).</li>
</ul>
</section></section>
<section>
<section id="convolutional-neural-networks" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Convolutional Neural Networks</h1>

</section>
<section id="definition-of-cnn" class="slide level2">
<h2>Definition of CNN</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><br> <br></p>
<p>A neural network that uses <em>convolution layers</em> is called a <em>convolutional neural network</em>.</p>
</div><div class="column" style="width:40%;">
<p><img data-src="xkcd-trained_a_neural_net_2x.png"></p>
</div>
</div>
<div class="footer">
<p>Source: Randall Munroe (2019), <a href="https://xkcd.com/2173/">xkcd #2173: Trained a Neural Net</a>.</p>
</div>
</section>
<section id="architecture" class="slide level2">
<h2>Architecture</h2>
<p><br> <br></p>

<img data-src="Geron-mls2_1411-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Typical CNN architecture.</p><div class="footer">
<p>Source: Aurlien Gron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-11.</p>
</div>
</section>
<section id="architecture-2" class="slide level2">
<h2>Architecture #2</h2>

<img data-src="mathworks-typical-cnn.svg" class="r-stretch"><div class="footer">
<p>Source: MathWorks, <a href="https://au.mathworks.com/campaigns/offers/next/deep-learning-ebook.html"><em>Introducing Deep Learning with MATLAB</em></a>, Ebook.</p>
</div>
</section>
<section id="pooling" class="slide level2">
<h2>Pooling</h2>
<p><strong>Pooling</strong>, or <strong>downsampling</strong>, is a technique to blur a tensor.</p>

<img data-src="Glassner/16-27.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of pool operations.</p><p>(a): Input tensor<br> (b): Subdivide input tensor into 2x2 blocks<br> (c): Average pooling<br> (d): Max pooling<br> (e): Icon for a pooling layer<br></p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="pooling-for-multiple-channels" class="slide level2 smaller">
<h2>Pooling for multiple channels</h2>

<img data-src="Glassner/16-28.png" class="r-stretch quarto-figure-center"><p class="caption">Pooling a multichannel input.</p><ul>
<li>Input tensor: 6x6 with 1 channel, zero padding.</li>
<li>Convolution layer: Three 3x3 filters.</li>
<li>Convolution layer output: 6x6 with 3 channels.</li>
<li>Pooling layer: apply max pooling to each channel.</li>
<li>Pooling layer output: 3x3, 3 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="whywhy-not-use-pooling" class="slide level2">
<h2>Why/why not use pooling?</h2>
<p><strong>Why?</strong> Pooling <em>reduces the size</em> of tensors, therefore reduces memory usage and execution time (recall that 1x1 convolution <em>reduces the number of channels</em> in a tensor).</p>
<p><strong>Why not?</strong></p>
<center>
<iframe id="reddit-embed" src="https://www.redditmedia.com/r/MachineLearning/comments/2lmo0l/ama_geoffrey_hinton/clyj4jv/?depth=1&amp;showmore=false&amp;embed=true&amp;showmedia=false" sandbox="allow-scripts allow-same-origin allow-popups" style="border: none;" height="481" width="640" scrolling="no">
</iframe>
</center>
<div class="footer">
<p>Source: Hinton, <a href="https://www.reddit.com/r/MachineLearning/comments/2lmo0l/comment/clyj4jv/?utm_source=share&amp;utm_medium=web2x&amp;context=3">Reddit AMA</a>.</p>
</div>
</section>
<section id="striding" class="slide level2">
<h2>Striding</h2>
<p>When a filter scans the input, instead of making it sweep the input step by step, make it take strides larger than 1 step at a time.</p>

<img data-src="Glassner/16-29.png" class="r-stretch quarto-figure-center"><p class="caption">Example: Use a stride of three horizontally and two vertically.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="choosing-strides" class="slide level2 smaller">
<h2>Choosing strides</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-31.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-32.png"></p>
</div>
</div>
</div>
<ul>
<li>When a filter scans the input step by step, it processes the same input elements multiple times. Even with larger strides, this can still happen (left image).</li>
<li><strong>If</strong> we want to save time, we can choose strides that prevents input elements from being used more than once. Example (right image): 3x3 filter, stride 3 in both directions.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="why-striding" class="slide level2">
<h2>Why striding</h2>
<ul>
<li>Normally the same stride is used for both axes.</li>
<li>Suppose stride is 2 for both axes: output has the same dimension as the output of <em>normal</em> sweeping (striding by 1) and then pooling with 2x2 blocks.</li>
<li>Striding is almost as if pooling is bundled into the convolution process. Striding is faster because we evaluate the filter fewer times.</li>
</ul>
</section>
<section id="why-striding-1" class="slide level2">
<h2>Why striding</h2>
<ul>
<li>While two procedures result in different tensors, in practice striding proves to be as useful as convolution + pooling but much faster. However, depending on the dataset and architecture, sometimes convolution followed by pooling works better.</li>
<li>Striding also reduces the size of the tensor like pooling, so it has the same benefit of reducing memory requirement and execution time.</li>
<li>We cant take a trained network and replace pairs of convolution and pooling with strided convolution (or vice versa). We have to retrain the network.</li>
</ul>
</section></section>
<section>
<section id="demo-character-recognition" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Demo: Character Recognition</h1>

</section>
<section id="mnist-dataset" class="slide level2">
<h2>MNIST Dataset</h2>

<img data-src="wiki-MnistExamples.png" class="r-stretch quarto-figure-center"><p class="caption">The MNIST dataset.</p><div class="footer">
<p>Source: Wikipedia, <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST database</a>.</p>
</div>
</section>
<section id="psam-dataset" class="slide level2">
<h2>PSAM Dataset</h2>
<p>57 poorly written Mandarin characters (<span class="math inline">\(57 \times 7 = 399\)</span>).</p>

<img data-src="mandarin-practice-notebook3.png" class="r-stretch quarto-figure-center"><p class="caption">The <em>Pat Sucks At Mandarin (PSAM)</em> dataset.</p></section>
<section id="downloading-the-dataset" class="slide level2">
<h2>Downloading the dataset</h2>
<p>The data is zipped (6.9 MB) and stored on my GitHub homepage.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Download the dataset if it hasn't already been downloaded.</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="cf">if</span> <span class="kw">not</span> Path(<span class="st">"mandarin"</span>).exists():</span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="bu">print</span>(<span class="st">"Downloading dataset..."</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="op">!</span>wget https:<span class="op">//</span>pat<span class="op">-</span>laub.github.io<span class="op">/</span>data<span class="op">/</span>mandarin.<span class="bu">zip</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="op">!</span>unzip mandarin.<span class="bu">zip</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="cf">else</span>:</span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="bu">print</span>(<span class="st">"Already downloaded."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Already downloaded.</code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Remember, the Jupyter notebook associated with your final report should either download your dataset when it is run, or you should supply the data separately.</p>
</div>
</div>
</div>
</section>
<section id="directory-structure" class="slide level2">
<h2>Directory structure</h2>
<div class="columns">
<div class="column">
<p>Inspect the directory structure using the <code>tree</code> command-line tool.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="im">from</span> directory_tree <span class="im">import</span> display_tree</span>
<span id="cb24-2"><a href="#cb24-2"></a>display_tree(<span class="st">"mandarin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin/
 bai/
    bai-1.png
    bai-2.png
    bai-3.png
    bai-4.png
    bai-5.png
    bai-6.png
    bai-7.png
 ben/
    ben-1.png
    ben-2.png
    ben-3.png
    ben-4.png
    ben-5.png
    ben-6.png
    ben-7.png
 chong/
    chong-1.png
    chong-2.png
    chong-3.png
    chong-4.png
    chong-5.png
    chong-6.png
    chong-7.png
 chu/
    chu-1.png
    chu-2.png
    chu-3.png
    chu-4.png
    chu-5.png
    chu-6.png
    chu-7.png
 chuan/
    chuan-1.png
    chuan-2.png
    chuan-3.png
    chuan-4.png
    chuan-5.png
    chuan-6.png
    chuan-7.png
 cong/
    cong-1.png
    cong-2.png
    cong-3.png
    cong-4.png
    cong-5.png
    cong-6.png
    cong-7.png
 da/
    da-1.png
    da-2.png
    da-3.png
    da-4.png
    da-5.png
    da-6.png
    da-7.png
 dan/
    dan-1.png
    dan-2.png
    dan-3.png
    dan-4.png
    dan-5.png
    dan-6.png
    dan-7.png
 dong/
    dong-1.png
    dong-2.png
    dong-3.png
    dong-4.png
    dong-5.png
    dong-6.png
    dong-7.png
 fei/
    fei-1.png
    fei-2.png
    fei-3.png
    fei-4.png
    fei-5.png
    fei-6.png
    fei-7.png
 fu/
    fu-1.png
    fu-2.png
    fu-3.png
    fu-4.png
    fu-5.png
    fu-6.png
    fu-7.png
 fu2/
    fu2-1.png
    fu2-2.png
    fu2-3.png
    fu2-4.png
    fu2-5.png
    fu2-6.png
    fu2-7.png
 gao/
    gao-1.png
    gao-2.png
    gao-3.png
    gao-4.png
    gao-5.png
    gao-6.png
    gao-7.png
 gong/
    gong-1.png
    gong-2.png
    gong-3.png
    gong-4.png
    gong-5.png
    gong-6.png
    gong-7.png
 guo/
    guo-1.png
    guo-2.png
    guo-3.png
    guo-4.png
    guo-5.png
    guo-6.png
    guo-7.png
 hu/
    hu-1.png
    hu-2.png
    hu-3.png
    hu-4.png
    hu-5.png
    hu-6.png
    hu-7.png
 huo/
    huo-1.png
    huo-2.png
    huo-3.png
    huo-4.png
    huo-5.png
    huo-6.png
    huo-7.png
 kou/
    kou-1.png
    kou-2.png
    kou-3.png
    kou-4.png
    kou-5.png
    kou-6.png
    kou-7.png
 ku/
    ku-1.png
    ku-2.png
    ku-3.png
    ku-4.png
    ku-5.png
    ku-6.png
    ku-7.png
 lin/
    lin-1.png
    lin-2.png
    lin-3.png
    lin-4.png
    lin-5.png
    lin-6.png
    lin-7.png
 ma/
    ma-1.png
    ma-2.png
    ma-3.png
    ma-4.png
    ma-5.png
    ma-6.png
    ma-7.png
 ma2/
    ma2-1.png
    ma2-2.png
    ma2-3.png
    ma2-4.png
    ma2-5.png
    ma2-6.png
    ma2-7.png
 ma3/
    ma3-1.png
    ma3-2.png
    ma3-3.png
    ma3-4.png
    ma3-5.png
    ma3-6.png
    ma3-7.png
 mei/
    mei-1.png
    mei-2.png
    mei-3.png
    mei-4.png
    mei-5.png
    mei-6.png
    mei-7.png
 men/
    men-1.png
    men-2.png
    men-3.png
    men-4.png
    men-5.png
    men-6.png
    men-7.png
 ming/
    ming-1.png
    ming-2.png
    ming-3.png
    ming-4.png
    ming-5.png
    ming-6.png
    ming-7.png
 mu/
    mu-1.png
    mu-2.png
    mu-3.png
    mu-4.png
    mu-5.png
    mu-6.png
    mu-7.png
 nan/
    nan-1.png
    nan-2.png
    nan-3.png
    nan-4.png
    nan-5.png
    nan-6.png
    nan-7.png
 niao/
    niao-1.png
    niao-2.png
    niao-3.png
    niao-4.png
    niao-5.png
    niao-6.png
    niao-7.png
 niu/
    niu-1.png
    niu-2.png
    niu-3.png
    niu-4.png
    niu-5.png
    niu-6.png
    niu-7.png
 nu/
    nu-1.png
    nu-2.png
    nu-3.png
    nu-4.png
    nu-5.png
    nu-6.png
    nu-7.png
 nuan/
    nuan-1.png
    nuan-2.png
    nuan-3.png
    nuan-4.png
    nuan-5.png
    nuan-6.png
    nuan-7.png
 peng/
    peng-1.png
    peng-2.png
    peng-3.png
    peng-4.png
    peng-5.png
    peng-6.png
    peng-7.png
 quan/
    quan-1.png
    quan-2.png
    quan-3.png
    quan-4.png
    quan-5.png
    quan-6.png
    quan-7.png
 ren/
    ren-1.png
    ren-2.png
    ren-3.png
    ren-4.png
    ren-5.png
    ren-6.png
    ren-7.png
 ri/
    ri-1.png
    ri-2.png
    ri-3.png
    ri-4.png
    ri-5.png
    ri-6.png
    ri-7.png
 rou/
    rou-1.png
    rou-2.png
    rou-3.png
    rou-4.png
    rou-5.png
    rou-6.png
    rou-7.png
 sen/
    sen-1.png
    sen-2.png
    sen-3.png
    sen-4.png
    sen-5.png
    sen-6.png
    sen-7.png
 shan/
    shan-1.png
    shan-2.png
    shan-3.png
    shan-4.png
    shan-5.png
    shan-6.png
    shan-7.png
 shan2/
    shan2-1.png
    shan2-2.png
    shan2-3.png
    shan2-4.png
    shan2-5.png
    shan2-6.png
    shan2-7.png
 shui/
    shui-1.png
    shui-2.png
    shui-3.png
    shui-4.png
    shui-5.png
    shui-6.png
    shui-7.png
 tai/
    tai-1.png
    tai-2.png
    tai-3.png
    tai-4.png
    tai-5.png
    tai-6.png
    tai-7.png
 tian/
    tian-1.png
    tian-2.png
    tian-3.png
    tian-4.png
    tian-5.png
    tian-6.png
    tian-7.png
 wang/
    wang-1.png
    wang-2.png
    wang-3.png
    wang-4.png
    wang-5.png
    wang-6.png
    wang-7.png
 wen/
    wen-1.png
    wen-2.png
    wen-3.png
    wen-4.png
    wen-5.png
    wen-6.png
    wen-7.png
 xian/
    xian-1.png
    xian-2.png
    xian-3.png
    xian-4.png
    xian-5.png
    xian-6.png
    xian-7.png
 xuan/
    xuan-1.png
    xuan-2.png
    xuan-3.png
    xuan-4.png
    xuan-5.png
    xuan-6.png
    xuan-7.png
 yan/
    yan-1.png
    yan-2.png
    yan-3.png
    yan-4.png
    yan-5.png
    yan-6.png
    yan-7.png
 yang/
    yang-1.png
    yang-2.png
    yang-3.png
    yang-4.png
    yang-5.png
    yang-6.png
    yang-7.png
 yin/
    yin-1.png
    yin-2.png
    yin-3.png
    yin-4.png
    yin-5.png
    yin-6.png
    yin-7.png
 yu/
    yu-1.png
    yu-2.png
    yu-3.png
    yu-4.png
    yu-5.png
    yu-6.png
    yu-7.png
 yu2/
    yu2-1.png
    yu2-2.png
    yu2-3.png
    yu2-4.png
    yu2-5.png
    yu2-6.png
    yu2-7.png
 yue/
    yue-1.png
    yue-2.png
    yue-3.png
    yue-4.png
    yue-5.png
    yue-6.png
    yue-7.png
 zhong/
    zhong-1.png
    zhong-2.png
    zhong-3.png
    zhong-4.png
    zhong-5.png
    zhong-6.png
    zhong-7.png
 zhu/
    zhu-1.png
    zhu-2.png
    zhu-3.png
    zhu-4.png
    zhu-5.png
    zhu-6.png
    zhu-7.png
 zhu2/
    zhu2-1.png
    zhu2-2.png
    zhu2-3.png
    zhu2-4.png
    zhu2-5.png
    zhu2-6.png
    zhu2-7.png
 zhuo/
     zhuo-1.png
     zhuo-2.png
     zhuo-3.png
     zhuo-4.png
     zhuo-5.png
     zhuo-6.png
     zhuo-7.png</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>tree <span class="op">=</span> display_tree(<span class="st">"mandarin"</span>, string_rep<span class="op">=</span><span class="va">True</span>).split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tree[:<span class="dv">12</span>]))</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="bu">print</span>(<span class="st">"..."</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tree[<span class="op">-</span><span class="dv">4</span>:]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin/
 bai/
    bai-1.png
    bai-2.png
    bai-3.png
    bai-4.png
    bai-5.png
    bai-6.png
    bai-7.png
 ben/
    ben-1.png
    ben-2.png
...
     zhuo-5.png
     zhuo-6.png
     zhuo-7.png
</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="splitting-into-trainvaltest-sets" class="slide level2">
<h2>Splitting into train/val/test sets</h2>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="op">!</span>pip install split<span class="op">-</span>folders</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="im">import</span> splitfolders</span>
<span id="cb29-2"><a href="#cb29-2"></a>splitfolders.ratio(<span class="st">"mandarin"</span>, output<span class="op">=</span><span class="st">"mandarin-split"</span>,</span>
<span id="cb29-3"><a href="#cb29-3"></a>    seed<span class="op">=</span><span class="dv">1337</span>, ratio<span class="op">=</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>))</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a>display_tree(<span class="st">"mandarin-split"</span>, max_depth<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/
 test/
 train/
 val/</code></pre>
</div>
</div>
</section>
<section id="directory-structure-ii" class="slide level2">
<h2>Directory structure II</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>display_tree(<span class="st">"mandarin-split"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/
 test/
    bai/
       bai-5.png
    ben/
       ben-5.png
    chong/
       chong-5.png
    chu/
       chu-5.png
    chuan/
       chuan-5.png
    cong/
       cong-5.png
    da/
       da-5.png
    dan/
       dan-5.png
    dong/
       dong-5.png
    fei/
       fei-5.png
    fu/
       fu-5.png
    fu2/
       fu2-5.png
    gao/
       gao-5.png
    gong/
       gong-5.png
    guo/
       guo-5.png
    hu/
       hu-5.png
    huo/
       huo-5.png
    kou/
       kou-5.png
    ku/
       ku-5.png
    lin/
       lin-5.png
    ma/
       ma-5.png
    ma2/
       ma2-5.png
    ma3/
       ma3-5.png
    mei/
       mei-5.png
    men/
       men-5.png
    ming/
       ming-5.png
    mu/
       mu-5.png
    nan/
       nan-5.png
    niao/
       niao-5.png
    niu/
       niu-5.png
    nu/
       nu-5.png
    nuan/
       nuan-5.png
    peng/
       peng-5.png
    quan/
       quan-5.png
    ren/
       ren-5.png
    ri/
       ri-5.png
    rou/
       rou-5.png
    sen/
       sen-5.png
    shan/
       shan-5.png
    shan2/
       shan2-5.png
    shui/
       shui-5.png
    tai/
       tai-5.png
    tian/
       tian-5.png
    wang/
       wang-5.png
    wen/
       wen-5.png
    xian/
       xian-5.png
    xuan/
       xuan-5.png
    yan/
       yan-5.png
    yang/
       yang-5.png
    yin/
       yin-5.png
    yu/
       yu-5.png
    yu2/
       yu2-5.png
    yue/
       yue-5.png
    zhong/
       zhong-5.png
    zhu/
       zhu-5.png
    zhu2/
       zhu2-5.png
    zhuo/
        zhuo-5.png
 train/
    bai/
       bai-1.png
       bai-2.png
       bai-3.png
       bai-4.png
       bai-6.png
    ben/
       ben-1.png
       ben-2.png
       ben-3.png
       ben-4.png
       ben-6.png
    chong/
       chong-1.png
       chong-2.png
       chong-3.png
       chong-4.png
       chong-6.png
    chu/
       chu-1.png
       chu-2.png
       chu-3.png
       chu-4.png
       chu-6.png
    chuan/
       chuan-1.png
       chuan-2.png
       chuan-3.png
       chuan-4.png
       chuan-6.png
    cong/
       cong-1.png
       cong-2.png
       cong-3.png
       cong-4.png
       cong-6.png
    da/
       da-1.png
       da-2.png
       da-3.png
       da-4.png
       da-6.png
    dan/
       dan-1.png
       dan-2.png
       dan-3.png
       dan-4.png
       dan-6.png
    dong/
       dong-1.png
       dong-2.png
       dong-3.png
       dong-4.png
       dong-6.png
    fei/
       fei-1.png
       fei-2.png
       fei-3.png
       fei-4.png
       fei-6.png
    fu/
       fu-1.png
       fu-2.png
       fu-3.png
       fu-4.png
       fu-6.png
    fu2/
       fu2-1.png
       fu2-2.png
       fu2-3.png
       fu2-4.png
       fu2-6.png
    gao/
       gao-1.png
       gao-2.png
       gao-3.png
       gao-4.png
       gao-6.png
    gong/
       gong-1.png
       gong-2.png
       gong-3.png
       gong-4.png
       gong-6.png
    guo/
       guo-1.png
       guo-2.png
       guo-3.png
       guo-4.png
       guo-6.png
    hu/
       hu-1.png
       hu-2.png
       hu-3.png
       hu-4.png
       hu-6.png
    huo/
       huo-1.png
       huo-2.png
       huo-3.png
       huo-4.png
       huo-6.png
    kou/
       kou-1.png
       kou-2.png
       kou-3.png
       kou-4.png
       kou-6.png
    ku/
       ku-1.png
       ku-2.png
       ku-3.png
       ku-4.png
       ku-6.png
    lin/
       lin-1.png
       lin-2.png
       lin-3.png
       lin-4.png
       lin-6.png
    ma/
       ma-1.png
       ma-2.png
       ma-3.png
       ma-4.png
       ma-6.png
    ma2/
       ma2-1.png
       ma2-2.png
       ma2-3.png
       ma2-4.png
       ma2-6.png
    ma3/
       ma3-1.png
       ma3-2.png
       ma3-3.png
       ma3-4.png
       ma3-6.png
    mei/
       mei-1.png
       mei-2.png
       mei-3.png
       mei-4.png
       mei-6.png
    men/
       men-1.png
       men-2.png
       men-3.png
       men-4.png
       men-6.png
    ming/
       ming-1.png
       ming-2.png
       ming-3.png
       ming-4.png
       ming-6.png
    mu/
       mu-1.png
       mu-2.png
       mu-3.png
       mu-4.png
       mu-6.png
    nan/
       nan-1.png
       nan-2.png
       nan-3.png
       nan-4.png
       nan-6.png
    niao/
       niao-1.png
       niao-2.png
       niao-3.png
       niao-4.png
       niao-6.png
    niu/
       niu-1.png
       niu-2.png
       niu-3.png
       niu-4.png
       niu-6.png
    nu/
       nu-1.png
       nu-2.png
       nu-3.png
       nu-4.png
       nu-6.png
    nuan/
       nuan-1.png
       nuan-2.png
       nuan-3.png
       nuan-4.png
       nuan-6.png
    peng/
       peng-1.png
       peng-2.png
       peng-3.png
       peng-4.png
       peng-6.png
    quan/
       quan-1.png
       quan-2.png
       quan-3.png
       quan-4.png
       quan-6.png
    ren/
       ren-1.png
       ren-2.png
       ren-3.png
       ren-4.png
       ren-6.png
    ri/
       ri-1.png
       ri-2.png
       ri-3.png
       ri-4.png
       ri-6.png
    rou/
       rou-1.png
       rou-2.png
       rou-3.png
       rou-4.png
       rou-6.png
    sen/
       sen-1.png
       sen-2.png
       sen-3.png
       sen-4.png
       sen-6.png
    shan/
       shan-1.png
       shan-2.png
       shan-3.png
       shan-4.png
       shan-6.png
    shan2/
       shan2-1.png
       shan2-2.png
       shan2-3.png
       shan2-4.png
       shan2-6.png
    shui/
       shui-1.png
       shui-2.png
       shui-3.png
       shui-4.png
       shui-6.png
    tai/
       tai-1.png
       tai-2.png
       tai-3.png
       tai-4.png
       tai-6.png
    tian/
       tian-1.png
       tian-2.png
       tian-3.png
       tian-4.png
       tian-6.png
    wang/
       wang-1.png
       wang-2.png
       wang-3.png
       wang-4.png
       wang-6.png
    wen/
       wen-1.png
       wen-2.png
       wen-3.png
       wen-4.png
       wen-6.png
    xian/
       xian-1.png
       xian-2.png
       xian-3.png
       xian-4.png
       xian-6.png
    xuan/
       xuan-1.png
       xuan-2.png
       xuan-3.png
       xuan-4.png
       xuan-6.png
    yan/
       yan-1.png
       yan-2.png
       yan-3.png
       yan-4.png
       yan-6.png
    yang/
       yang-1.png
       yang-2.png
       yang-3.png
       yang-4.png
       yang-6.png
    yin/
       yin-1.png
       yin-2.png
       yin-3.png
       yin-4.png
       yin-6.png
    yu/
       yu-1.png
       yu-2.png
       yu-3.png
       yu-4.png
       yu-6.png
    yu2/
       yu2-1.png
       yu2-2.png
       yu2-3.png
       yu2-4.png
       yu2-6.png
    yue/
       yue-1.png
       yue-2.png
       yue-3.png
       yue-4.png
       yue-6.png
    zhong/
       zhong-1.png
       zhong-2.png
       zhong-3.png
       zhong-4.png
       zhong-6.png
    zhu/
       zhu-1.png
       zhu-2.png
       zhu-3.png
       zhu-4.png
       zhu-6.png
    zhu2/
       zhu2-1.png
       zhu2-2.png
       zhu2-3.png
       zhu2-4.png
       zhu2-6.png
    zhuo/
        zhuo-1.png
        zhuo-2.png
        zhuo-3.png
        zhuo-4.png
        zhuo-6.png
 val/
     bai/
        bai-7.png
     ben/
        ben-7.png
     chong/
        chong-7.png
     chu/
        chu-7.png
     chuan/
        chuan-7.png
     cong/
        cong-7.png
     da/
        da-7.png
     dan/
        dan-7.png
     dong/
        dong-7.png
     fei/
        fei-7.png
     fu/
        fu-7.png
     fu2/
        fu2-7.png
     gao/
        gao-7.png
     gong/
        gong-7.png
     guo/
        guo-7.png
     hu/
        hu-7.png
     huo/
        huo-7.png
     kou/
        kou-7.png
     ku/
        ku-7.png
     lin/
        lin-7.png
     ma/
        ma-7.png
     ma2/
        ma2-7.png
     ma3/
        ma3-7.png
     mei/
        mei-7.png
     men/
        men-7.png
     ming/
        ming-7.png
     mu/
        mu-7.png
     nan/
        nan-7.png
     niao/
        niao-7.png
     niu/
        niu-7.png
     nu/
        nu-7.png
     nuan/
        nuan-7.png
     peng/
        peng-7.png
     quan/
        quan-7.png
     ren/
        ren-7.png
     ri/
        ri-7.png
     rou/
        rou-7.png
     sen/
        sen-7.png
     shan/
        shan-7.png
     shan2/
        shan2-7.png
     shui/
        shui-7.png
     tai/
        tai-7.png
     tian/
        tian-7.png
     wang/
        wang-7.png
     wen/
        wen-7.png
     xian/
        xian-7.png
     xuan/
        xuan-7.png
     yan/
        yan-7.png
     yang/
        yang-7.png
     yin/
        yin-7.png
     yu/
        yu-7.png
     yu2/
        yu2-7.png
     yue/
        yue-7.png
     zhong/
        zhong-7.png
     zhu/
        zhu-7.png
     zhu2/
        zhu2-7.png
     zhuo/
         zhuo-7.png</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="22">
<div class="cell-output cell-output-stdout">
<pre><code>train/
 bai/
    bai-1.png
    bai-2.png
    bai-3.png
    bai-4.png
    bai-6.png
...
val/
 bai/
    bai-7.png
 ben/
    ben-7.png
...
test/
 bai/
    bai-5.png
 ben/
    ben-5.png
...</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="keras-image-dataset-loading" class="slide level2">
<h2>Keras image dataset loading</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span><span class="op">\</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>  image_dataset_from_directory</span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a>dataDir <span class="op">=</span> <span class="st">"mandarin-split"</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>batchSize <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>imgHeight <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>imgWidth <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>imgSize <span class="op">=</span> (imgHeight, imgWidth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>trainDS <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb35-2"><a href="#cb35-2"></a>    dataDir <span class="op">+</span> <span class="st">"/train"</span>,</span>
<span id="cb35-3"><a href="#cb35-3"></a>    image_size<span class="op">=</span>imgSize,</span>
<span id="cb35-4"><a href="#cb35-4"></a>    batch_size<span class="op">=</span>batchSize,</span>
<span id="cb35-5"><a href="#cb35-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb35-6"><a href="#cb35-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 285 files belonging to 57 classes.</code></pre>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>valDS <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb37-2"><a href="#cb37-2"></a>    dataDir <span class="op">+</span> <span class="st">"/val"</span>,</span>
<span id="cb37-3"><a href="#cb37-3"></a>    image_size<span class="op">=</span>imgSize,</span>
<span id="cb37-4"><a href="#cb37-4"></a>    batch_size<span class="op">=</span>batchSize,</span>
<span id="cb37-5"><a href="#cb37-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb37-6"><a href="#cb37-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 57 files belonging to 57 classes.</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>testDS <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb39-2"><a href="#cb39-2"></a>    dataDir <span class="op">+</span> <span class="st">"/test"</span>,</span>
<span id="cb39-3"><a href="#cb39-3"></a>    image_size<span class="op">=</span>imgSize,</span>
<span id="cb39-4"><a href="#cb39-4"></a>    batch_size<span class="op">=</span>batchSize,</span>
<span id="cb39-5"><a href="#cb39-5"></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb39-6"><a href="#cb39-6"></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 57 files belonging to 57 classes.</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="inspecting-the-datasets" class="slide level2">
<h2>Inspecting the datasets</h2>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="bu">print</span>(trainDS.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['bai', 'ben', 'chong', 'chu', 'chuan', 'cong', 'da', 'dan', 'dong', 'fei', 'fu', 'fu2', 'gao', 'gong', 'guo', 'hu', 'huo', 'kou', 'ku', 'lin', 'ma', 'ma2', 'ma3', 'mei', 'men', 'ming', 'mu', 'nan', 'niao', 'niu', 'nu', 'nuan', 'peng', 'quan', 'ren', 'ri', 'rou', 'sen', 'shan', 'shan2', 'shui', 'tai', 'tian', 'wang', 'wen', 'xian', 'xuan', 'yan', 'yang', 'yin', 'yu', 'yu2', 'yue', 'zhong', 'zhu', 'zhu2', 'zhuo']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># NB: Need shuffle=False earlier for these X &amp; y to line up.</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>X_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(trainDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb43-3"><a href="#cb43-3"></a>y_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(trainDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb43-4"><a href="#cb43-4"></a></span>
<span id="cb43-5"><a href="#cb43-5"></a>X_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(valDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb43-6"><a href="#cb43-6"></a>y_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(valDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb43-7"><a href="#cb43-7"></a></span>
<span id="cb43-8"><a href="#cb43-8"></a>X_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(testDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb43-9"><a href="#cb43-9"></a>y_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(testDS.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb43-10"><a href="#cb43-10"></a></span>
<span id="cb43-11"><a href="#cb43-11"></a>X_train.shape, y_train.shape, X_val.shape, y_val.shape, X_test.shape, y_test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>((285, 80, 80, 1), (285,), (57, 80, 80, 1), (57,), (57, 80, 80, 1), (57,))</code></pre>
</div>
</div>
</section>
<section id="plotting-some-characters-setup" class="slide level2">
<h2>Plotting some characters (setup)</h2>
<p><br></p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">def</span> plot_mandarin_characters(ds, plotCharLabel <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb45-2"><a href="#cb45-2"></a>    numPlotted <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> ds:</span>
<span id="cb45-4"><a href="#cb45-4"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(images.shape[<span class="dv">0</span>]):</span>
<span id="cb45-5"><a href="#cb45-5"></a>            label <span class="op">=</span> labels[i]</span>
<span id="cb45-6"><a href="#cb45-6"></a>            <span class="cf">if</span> label <span class="op">==</span> plotCharLabel:</span>
<span id="cb45-7"><a href="#cb45-7"></a>                plt.subplot(<span class="dv">1</span>, <span class="dv">5</span>, numPlotted <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb45-8"><a href="#cb45-8"></a>                plt.imshow(images[i].numpy().astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb45-9"><a href="#cb45-9"></a>                plt.title(ds.class_names[label])</span>
<span id="cb45-10"><a href="#cb45-10"></a>                plt.axis(<span class="st">"off"</span>)</span>
<span id="cb45-11"><a href="#cb45-11"></a>                numPlotted <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb45-12"><a href="#cb45-12"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-some-training-characters" class="slide level2 smaller">
<h2>Plotting some training characters</h2>
<div class="cell" data-execution_count="30">
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-31-output-1.png"></p>
</div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-31-output-2.png"></p>
</div>
</div>
</section>
<section id="plotting-some-valtest-characters" class="slide level2">
<h2>Plotting some val/test characters</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>baiVal <span class="op">=</span> X_val[y_val <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb46-2"><a href="#cb46-2"></a>plt.imshow(baiVal, cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-32-output-1.png"></p>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>baiTest <span class="op">=</span> X_test[y_test <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb47-2"><a href="#cb47-2"></a>plt.imshow(baiTest)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-33-output-1.png"></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="section-1" class="title-slide slide level1 center">
<h1></h1>
<h2>
Make the CNN
</h2>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="op">\</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="im">import</span> Rescaling, Conv2D, MaxPooling2D, Flatten</span>
<span id="cb48-3"><a href="#cb48-3"></a></span>
<span id="cb48-4"><a href="#cb48-4"></a>numClasses <span class="op">=</span> np.unique(y_train).shape[<span class="dv">0</span>]</span>
<span id="cb48-5"><a href="#cb48-5"></a>random.seed(<span class="dv">123</span>)</span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a>model <span class="op">=</span> Sequential([</span>
<span id="cb48-8"><a href="#cb48-8"></a>  Rescaling(<span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>, input_shape<span class="op">=</span>(imgHeight, imgWidth, <span class="dv">1</span>)),</span>
<span id="cb48-9"><a href="#cb48-9"></a>  Conv2D(<span class="dv">16</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv1"</span>),</span>
<span id="cb48-10"><a href="#cb48-10"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool1"</span>),</span>
<span id="cb48-11"><a href="#cb48-11"></a>  Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv2"</span>),</span>
<span id="cb48-12"><a href="#cb48-12"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool2"</span>),</span>
<span id="cb48-13"><a href="#cb48-13"></a>  Conv2D(<span class="dv">64</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv3"</span>),</span>
<span id="cb48-14"><a href="#cb48-14"></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool3"</span>),</span>
<span id="cb48-15"><a href="#cb48-15"></a>  Flatten(), Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">"relu"</span>), Dense(numClasses)</span>
<span id="cb48-16"><a href="#cb48-16"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The <code>Rescaling</code> layer will rescale the intensities to [0, 1].</p>
</div>
</div>
</div>
<div class="footer">
<p>Architecture inspired by <a href="https://www.tensorflow.org/tutorials/images/classification">https://www.tensorflow.org/tutorials/images/classification</a>.</p>
</div>
</section>
<section id="inspect-the-model" class="slide level2">
<h2>Inspect the model</h2>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>model.summary(print_fn<span class="op">=</span>skip_empty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
Layer (type)                Output Shape              Param #
=================================================================
rescaling (Rescaling)       (None, 80, 80, 1)         0
conv1 (Conv2D)              (None, 80, 80, 16)        160
pool1 (MaxPooling2D)        (None, 40, 40, 16)        0
conv2 (Conv2D)              (None, 40, 40, 32)        4640
pool2 (MaxPooling2D)        (None, 20, 20, 32)        0
conv3 (Conv2D)              (None, 20, 20, 64)        18496
pool3 (MaxPooling2D)        (None, 10, 10, 64)        0
flatten (Flatten)           (None, 6400)              0
dense (Dense)               (None, 128)               819328
dense_1 (Dense)             (None, 57)                7353
=================================================================
Total params: 849,977
Trainable params: 849,977
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="plot-the-cnn" class="slide level2">
<h2>Plot the CNN</h2>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>plot_model(model, layer_range<span class="op">=</span>(<span class="st">""</span>, <span class="st">"pool2"</span>), show_shapes<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<p><img data-src="computer-vision_files/figure-revealjs/cell-36-output-1.png"></p>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>plot_model(model, layer_range<span class="op">=</span>(<span class="st">"pool2"</span>, <span class="st">""</span>), show_shapes<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<p><img data-src="computer-vision_files/figure-revealjs/cell-37-output-1.png"></p>
</div>
</div>
</div>
</div>
</section>
<section id="fit-the-cnn" class="slide level2">
<h2>Fit the CNN</h2>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>loss <span class="op">=</span> tf.keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>topk <span class="op">=</span> tf.keras.metrics.SparseTopKCategoricalAccuracy(k<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span>loss, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>, topk])</span>
<span id="cb53-4"><a href="#cb53-4"></a></span>
<span id="cb53-5"><a href="#cb53-5"></a>epochs <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb53-6"><a href="#cb53-6"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">15</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb53-7"><a href="#cb53-7"></a>    monitor<span class="op">=</span><span class="st">"val_accuracy"</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb53-8"><a href="#cb53-8"></a></span>
<span id="cb53-9"><a href="#cb53-9"></a>hist <span class="op">=</span> model.fit(trainDS.shuffle(<span class="dv">1000</span>), validation_data<span class="op">=</span>valDS,</span>
<span id="cb53-10"><a href="#cb53-10"></a>  epochs<span class="op">=</span>epochs, callbacks<span class="op">=</span>[es], verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Restoring model weights from the end of the best epoch: 38.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 53: early stopping</code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Instead of using softmax activation, just added <code>from_logits=True</code> to the loss function; this is more numerically stable.</p>
</div>
</div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves-setup" class="slide level2">
<h2>Plot the loss/accuracy curves (setup)</h2>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">def</span> plot_history(hist):</span>
<span id="cb56-2"><a href="#cb56-2"></a>    epochs <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(hist.history[<span class="st">"loss"</span>]))</span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb56-5"><a href="#cb56-5"></a>    plt.plot(epochs, hist.history[<span class="st">"accuracy"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb56-6"><a href="#cb56-6"></a>    plt.plot(epochs, hist.history[<span class="st">"val_accuracy"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb56-7"><a href="#cb56-7"></a>    plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>)</span>
<span id="cb56-8"><a href="#cb56-8"></a>    plt.title(<span class="st">"Accuracy"</span>)</span>
<span id="cb56-9"><a href="#cb56-9"></a></span>
<span id="cb56-10"><a href="#cb56-10"></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb56-11"><a href="#cb56-11"></a>    plt.plot(epochs, hist.history[<span class="st">"loss"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb56-12"><a href="#cb56-12"></a>    plt.plot(epochs, hist.history[<span class="st">"val_loss"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb56-13"><a href="#cb56-13"></a>    plt.legend(loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb56-14"><a href="#cb56-14"></a>    plt.title(<span class="st">"Loss"</span>)</span>
<span id="cb56-15"><a href="#cb56-15"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves" class="slide level2">
<h2>Plot the loss/accuracy curves</h2>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>plot_history(hist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-41-output-1.png" class="r-stretch"></section>
<section id="look-at-the-metrics" class="slide level2">
<h2>Look at the metrics</h2>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a><span class="bu">print</span>(model.evaluate(trainDS, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="bu">print</span>(model.evaluate(valDS, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="bu">print</span>(model.evaluate(testDS, verbose<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.0004939546925015748, 1.0, 1.0]
[0.5680586099624634, 0.8771929740905762, 0.9649122953414917]
[0.4571843147277832, 0.9298245906829834, 0.9824561476707458]</code></pre>
</div>
</div>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Feel free to try to improve on this for this weeks StoryWall (instead of the cyclone damage dataset). If you do this, try a different architecture, and add more training examples or clean up the existing ones.</p>
</div>
</div>
</div>
</section>
<section id="predict-on-the-test-set" class="slide level2">
<h2>Predict on the test set</h2>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>model.predict(X_test[<span class="dv">17</span>], verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:Model was constructed with shape (None, 80, 80, 1) for input KerasTensor(type_spec=TensorSpec(shape=(None, 80, 80, 1), dtype=tf.float32, name='rescaling_input'), name='rescaling_input', description="created by layer 'rescaling_input'"), but it was called on an input with incompatible shape (None, 80, 1, 1).</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>X_test[<span class="dv">17</span>].shape, X_test[<span class="dv">17</span>][np.newaxis, :].shape, X_test[[<span class="dv">17</span>]].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>((80, 80, 1), (1, 80, 80, 1), (1, 80, 80, 1))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>array([[ -4.98, -23.68,  -9.79, -10.47,   1.29,  -5.93, -35.34,  -5.15,
        -10.06,  -4.73, -12.45,  -3.55,  -8.52, -11.08,   1.94,  -7.  ,
        -11.66,   9.66,  -3.11, -14.39,  -4.76,  -2.72,   1.68, -15.28,
          1.33,   5.88, -13.27,  -5.57,  -5.75,  -8.42, -16.63, -10.53,
         -4.94, -23.51, -20.6 ,  -1.14,  -1.41,  -4.67,   1.53,   0.12,
        -13.77, -18.89,  -5.6 , -11.04,  -9.07,  -9.61,   4.39,  -2.88,
         -7.66,   3.97, -17.8 ,  -3.66,   0.86,  -8.54,  -8.82, -12.5 ,
         -8.88]], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="predict-on-the-test-set-ii" class="slide level2">
<h2>Predict on the test set II</h2>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>).argmax()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>17</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>testDS.class_names[model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>).argmax()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>'kou'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>plt.imshow(X_test[<span class="dv">17</span>], cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-49-output-1.png" class="r-stretch"></section></section>
<section>
<section id="section-2" class="title-slide slide level1 center">
<h1></h1>
<h2>
Error analysis (setup)
</h2>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">def</span> plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, classNames):</span>
<span id="cb71-2"><a href="#cb71-2"></a>  plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb71-3"><a href="#cb71-3"></a></span>
<span id="cb71-4"><a href="#cb71-4"></a>  numErrors <span class="op">=</span> np.<span class="bu">sum</span>(y_pred <span class="op">!=</span> y_test)</span>
<span id="cb71-5"><a href="#cb71-5"></a>  errNum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb71-6"><a href="#cb71-6"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X_test.shape[<span class="dv">0</span>]):</span>
<span id="cb71-7"><a href="#cb71-7"></a>      <span class="cf">if</span> y_pred[i] <span class="op">!=</span> y_test[i]:</span>
<span id="cb71-8"><a href="#cb71-8"></a>          ax <span class="op">=</span> plt.subplot(numErrors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>errNum <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb71-9"><a href="#cb71-9"></a>          plt.imshow(X_test[i].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb71-10"><a href="#cb71-10"></a>          plt.title(<span class="ss">f"Guessed '</span><span class="sc">{</span>classNames[y_pred[i]]<span class="sc">}</span><span class="ss">' True '</span><span class="sc">{</span>classNames[y_test[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb71-11"><a href="#cb71-11"></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb71-12"><a href="#cb71-12"></a>          </span>
<span id="cb71-13"><a href="#cb71-13"></a>          actualPredCharInd <span class="op">=</span> np.argmax(y_test <span class="op">==</span> y_pred[i])</span>
<span id="cb71-14"><a href="#cb71-14"></a>          ax <span class="op">=</span> plt.subplot(numErrors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>errNum <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb71-15"><a href="#cb71-15"></a>          plt.imshow(X_val[actualPredCharInd].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb71-16"><a href="#cb71-16"></a>          plt.title(<span class="ss">f"A real '</span><span class="sc">{</span>classNames[y_pred[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb71-17"><a href="#cb71-17"></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb71-18"><a href="#cb71-18"></a>          errNum <span class="op">+=</span> <span class="dv">1</span>     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="error-analysis-i" class="slide level2">
<h2>Error analysis I</h2>

<img data-src="error-analysis-found-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from first assessment of test errors.</p></section>
<section id="error-analysis-ii" class="slide level2">
<h2>Error analysis II</h2>

<img data-src="error-analysis-found-another-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from second assessment of test errors.</p></section>
<section id="error-analysis-iii" class="slide level2">
<h2>Error analysis III</h2>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>y_pred <span class="op">=</span> model.predict(X_val, verbose<span class="op">=</span><span class="dv">0</span>).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>plot_error_analysis(X_train, y_train, X_val, y_val, y_pred, valDS.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-51-output-1.png" class="r-stretch"></section>
<section id="error-analysis-iv" class="slide level2">
<h2>Error analysis IV</h2>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>y_pred <span class="op">=</span> model.predict(X_test, verbose<span class="op">=</span><span class="dv">0</span>).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb73-2"><a href="#cb73-2"></a>plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, testDS.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-52-output-1.png" class="r-stretch"></section>
<section id="confidence-of-predictions" class="slide level2">
<h2>Confidence of predictions</h2>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a>y_pred <span class="op">=</span> tf.keras.activations.softmax(model(X_test)).numpy()</span>
<span id="cb74-2"><a href="#cb74-2"></a>y_pred_class <span class="op">=</span> y_pred.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a>y_pred_prob <span class="op">=</span> y_pred[np.arange(y_pred.shape[<span class="dv">0</span>]), y_pred_class]</span>
<span id="cb74-4"><a href="#cb74-4"></a></span>
<span id="cb74-5"><a href="#cb74-5"></a>confidenceWhenCorrect <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">==</span> y_test]</span>
<span id="cb74-6"><a href="#cb74-6"></a>confidenceWhenWrong <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">!=</span> y_test]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>plt.hist(confidenceWhenCorrect)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-54-output-1.png"></p>
</div>
</div>
</div><div class="column">
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>plt.hist(confidenceWhenWrong)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img data-src="computer-vision_files/figure-revealjs/cell-55-output-1.png"></p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="hyperparameter-tuning" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Hyperparameter tuning</h1>

</section>
<section id="trial-error" class="slide level2">
<h2>Trial &amp; error</h2>
<p><br> <br></p>
<div class="columns">
<div class="column">
<p><br></p>
<p>Frankly, a lot of this is just enlightened trial and error</p>
</div><div class="column">
<center>
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">
One trick that I like to use when training my neural networks is to add some noise ~Laplace(time(), sqrt(time())) to the gradients of the 13th layer at epoch 3 for batch 7.
</p>
 antonio vergari  hiring PhD troublemakers  (<span class="citation" data-cites="tetraduzione">@tetraduzione</span>) <a href="https://twitter.com/tetraduzione/status/1525501171221274627?ref_src=twsrc%5Etfw">May 14, 2022</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>
</div>
</div>
<div class="footer">
<p>Source: <a href="https://twitter.com/tetraduzione/status/1525501171221274627?s=20&amp;t=ulVFesw-f7hCuG9KyaoYbQ">Twitter</a>.</p>
</div>
</section>
<section id="keras-tuner" class="slide level2">
<h2>Keras Tuner</h2>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a><span class="op">!</span>pip install keras<span class="op">-</span>tuner</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a><span class="im">import</span> keras_tuner <span class="im">as</span> kt</span>
<span id="cb78-2"><a href="#cb78-2"></a></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb78-4"><a href="#cb78-4"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb78-5"><a href="#cb78-5"></a>    model.add(</span>
<span id="cb78-6"><a href="#cb78-6"></a>        Dense(</span>
<span id="cb78-7"><a href="#cb78-7"></a>            hp.Choice(<span class="st">"neurons"</span>, [<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>]),</span>
<span id="cb78-8"><a href="#cb78-8"></a>            activation<span class="op">=</span>hp.Choice(<span class="st">"activation"</span>,</span>
<span id="cb78-9"><a href="#cb78-9"></a>                [<span class="st">"relu"</span>, <span class="st">"leaky_relu"</span>, <span class="st">"tanh"</span>]),</span>
<span id="cb78-10"><a href="#cb78-10"></a>        )</span>
<span id="cb78-11"><a href="#cb78-11"></a>    )</span>
<span id="cb78-12"><a href="#cb78-12"></a>  </span>
<span id="cb78-13"><a href="#cb78-13"></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb78-14"><a href="#cb78-14"></a>    </span>
<span id="cb78-15"><a href="#cb78-15"></a>    learningRate <span class="op">=</span> hp.Float(<span class="st">"lr"</span>,</span>
<span id="cb78-16"><a href="#cb78-16"></a>        min_value<span class="op">=</span><span class="fl">1e-4</span>, max_value<span class="op">=</span><span class="fl">1e-2</span>, sampling<span class="op">=</span><span class="st">"log"</span>)</span>
<span id="cb78-17"><a href="#cb78-17"></a>    opt <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span>learningRate)</span>
<span id="cb78-18"><a href="#cb78-18"></a></span>
<span id="cb78-19"><a href="#cb78-19"></a>    model.<span class="bu">compile</span>(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb78-20"><a href="#cb78-20"></a>    </span>
<span id="cb78-21"><a href="#cb78-21"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-random-search" class="slide level2">
<h2>Do a random search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>tuner <span class="op">=</span> kt.RandomSearch(</span>
<span id="cb79-2"><a href="#cb79-2"></a>  build_model,</span>
<span id="cb79-3"><a href="#cb79-3"></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb79-4"><a href="#cb79-4"></a>  max_trials<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb79-5"><a href="#cb79-5"></a>  directory<span class="op">=</span><span class="st">"random-search"</span>)</span>
<span id="cb79-6"><a href="#cb79-6"></a></span>
<span id="cb79-7"><a href="#cb79-7"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb79-8"><a href="#cb79-8"></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb79-9"><a href="#cb79-9"></a></span>
<span id="cb79-10"><a href="#cb79-10"></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb79-11"><a href="#cb79-11"></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb79-12"><a href="#cb79-12"></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb79-13"><a href="#cb79-13"></a></span>
<span id="cb79-14"><a href="#cb79-14"></a>bestModel <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trial 10 Complete [00h 00m 19s]
val_loss: 0.3373011350631714

Best val_loss So Far: 0.3266565799713135
Total elapsed time: 00h 02m 10s</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in random-search\untitled_project
Showing 1 best trials
&lt;keras_tuner.engine.objective.Objective object at 0x0000017BCA793190&gt;
Trial summary
Hyperparameters:
neurons: 64
activation: leaky_relu
lr: 0.0014989134756062332
Score: 0.3266565799713135</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tune-layers-separately" class="slide level2">
<h2>Tune layers separately</h2>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb83-2"><a href="#cb83-2"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb83-3"><a href="#cb83-3"></a></span>
<span id="cb83-4"><a href="#cb83-4"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(hp.Int(<span class="st">"numHiddenLayers"</span>, <span class="dv">1</span>, <span class="dv">3</span>)):</span>
<span id="cb83-5"><a href="#cb83-5"></a>      <span class="co"># Tune number of units in each layer separately.</span></span>
<span id="cb83-6"><a href="#cb83-6"></a>      model.add(</span>
<span id="cb83-7"><a href="#cb83-7"></a>          Dense(</span>
<span id="cb83-8"><a href="#cb83-8"></a>              hp.Choice(<span class="ss">f"neurons_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, [<span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>]),</span>
<span id="cb83-9"><a href="#cb83-9"></a>              activation<span class="op">=</span><span class="st">"relu"</span></span>
<span id="cb83-10"><a href="#cb83-10"></a>          )</span>
<span id="cb83-11"><a href="#cb83-11"></a>      )</span>
<span id="cb83-12"><a href="#cb83-12"></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb83-13"><a href="#cb83-13"></a></span>
<span id="cb83-14"><a href="#cb83-14"></a>    opt <span class="op">=</span> tf.keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">0.0005</span>)</span>
<span id="cb83-15"><a href="#cb83-15"></a>    model.<span class="bu">compile</span>(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb83-16"><a href="#cb83-16"></a>    </span>
<span id="cb83-17"><a href="#cb83-17"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-bayesian-search" class="slide level2">
<h2>Do a Bayesian search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>tuner <span class="op">=</span> kt.BayesianOptimization(</span>
<span id="cb84-2"><a href="#cb84-2"></a>  build_model,</span>
<span id="cb84-3"><a href="#cb84-3"></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb84-4"><a href="#cb84-4"></a>  directory<span class="op">=</span><span class="st">"bayesian-search"</span>,</span>
<span id="cb84-5"><a href="#cb84-5"></a>  max_trials<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb84-6"><a href="#cb84-6"></a></span>
<span id="cb84-7"><a href="#cb84-7"></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb84-8"><a href="#cb84-8"></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb84-9"><a href="#cb84-9"></a></span>
<span id="cb84-10"><a href="#cb84-10"></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb84-11"><a href="#cb84-11"></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb84-12"><a href="#cb84-12"></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb84-13"><a href="#cb84-13"></a></span>
<span id="cb84-14"><a href="#cb84-14"></a>bestModel <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Trial 10 Complete [00h 00m 17s]
val_loss: 0.3318481147289276

Best val_loss So Far: 0.31578028202056885
Total elapsed time: 00h 02m 30s</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in bayesian-search\untitled_project
Showing 1 best trials
&lt;keras_tuner.engine.objective.Objective object at 0x0000017BC7BC5690&gt;
Trial summary
Hyperparameters:
numHiddenLayers: 3
neurons_0: 16
neurons_1: 8
neurons_2: 8
Score: 0.31578028202056885</code></pre>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="transfer-learning" class="title-slide slide level1 center" data-background-image="unsw-yellow-shape.png" data-visibility="uncounted">
<h1>Transfer Learning</h1>

</section>
<section id="demo-object-classification" class="slide level2">
<h2>Demo: Object classification</h2>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="teach-images.png"></p>
<p></p><figcaption>Example object classification run.</figcaption><p></p>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://info.deeplearning.ai/hs-fs/hubfs/NOCODE.gif?width=1199&amp;upscale=true&amp;name=NOCODE.gif"></p>
<p></p><figcaption>Example of object classification.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Teachable Machine, <a href="https://teachablemachine.withgoogle.com/">https://teachablemachine.withgoogle.com/</a>.</p>
</div>
</section>
<section id="how-does-that-work" class="slide level2">
<h2>How does that work?</h2>
<blockquote>
<p> these models use a technique called transfer learning. Theres a pretrained neural network, and when you create your own classes, you can sort of picture that your classes are becoming the last layer or step of the neural net. Specifically, both the image and pose models are learning off of pretrained mobilenet models </p>
</blockquote>
<p><a href="https://teachablemachine.withgoogle.com/faq#Diving-Deeper">Teachable Machine FAQ</a></p>
</section>
<section id="benchmarks" class="slide level2">
<h2>Benchmarks</h2>
<p><a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-11 / CIFAR-100 dataset</a> from Canadian Institute for Advanced Research</p>
<ul>
<li>9 classes: 60000 32x32 colour images</li>
<li>99 classes: 60000 32x32 colour images</li>
</ul>
<p><a href="https://www.image-net.org/index.php">ImageNet</a> and the <em>ImageNet Large Scale Visual Recognition Challenge (ILSVRC)</em>; originally <a href="https://image-net.org/challenges/LSVRC/2014/browse-synsets">0,000 synsets</a>.</p>
<ul>
<li>In 2021: 14,197,122 labelled images from 21,841 synsets.</li>
<li>See <a href="https://keras.io/api/applications/">Keras applications</a> for downloadable models.</li>
</ul>
</section>
<section id="lenet-6-1998" class="slide level2 smaller">
<h2>LeNet-6 (1998)</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 9%">
<col style="width: 23%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel size</th>
<th>Stride</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>0</td>
<td>3232</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>C0</td>
<td>Convolution</td>
<td>6</td>
<td>2828</td>
<td>55</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S1</td>
<td>Avg pooling</td>
<td>6</td>
<td>1414</td>
<td>22</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C2</td>
<td>Convolution</td>
<td>16</td>
<td>1010</td>
<td>55</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>Avg pooling</td>
<td>16</td>
<td>55</td>
<td>22</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C4</td>
<td>Convolution</td>
<td>120</td>
<td>11</td>
<td>55</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>F5</td>
<td>Fully connected</td>
<td></td>
<td>84</td>
<td></td>
<td></td>
<td>tanh</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully connected</td>
<td></td>
<td>9</td>
<td></td>
<td></td>
<td>RBF</td>
</tr>
</tbody>
</table>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>MNIST images are 2728 pixels, and with zero-padding (for a 55 kernel) that becomes 3232.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: Aurlien Gron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Chapter 14.</p>
</div>
</section>
<section id="alexnet-2011" class="slide level2 smaller">
<h2>AlexNet (2011)</h2>
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel</th>
<th>Stride</th>
<th>Padding</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>2</td>
<td>227227</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>C0</td>
<td>Convolution</td>
<td>96</td>
<td>5555</td>
<td>1111</td>
<td>4</td>
<td>valid</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S1</td>
<td>Max pool</td>
<td>96</td>
<td>2727</td>
<td>33</td>
<td>2</td>
<td>valid</td>
<td></td>
</tr>
<tr class="even">
<td>C2</td>
<td>Convolution</td>
<td>256</td>
<td>2727</td>
<td>55</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>Max pool</td>
<td>256</td>
<td>1313</td>
<td>33</td>
<td>2</td>
<td>valid</td>
<td></td>
</tr>
<tr class="even">
<td>C4</td>
<td>Convolution</td>
<td>384</td>
<td>1313</td>
<td>33</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>C5</td>
<td>Convolution</td>
<td>384</td>
<td>1313</td>
<td>33</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>C6</td>
<td>Convolution</td>
<td>256</td>
<td>1313</td>
<td>33</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S7</td>
<td>Max pool</td>
<td>256</td>
<td>66</td>
<td>33</td>
<td>2</td>
<td>valid</td>
<td></td>
</tr>
<tr class="even">
<td>F8</td>
<td>Fully conn.</td>
<td></td>
<td>4,096</td>
<td></td>
<td></td>
<td></td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>F9</td>
<td>Fully conn.</td>
<td></td>
<td>4,096</td>
<td></td>
<td></td>
<td></td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully conn.</td>
<td></td>
<td>0,000</td>
<td></td>
<td></td>
<td></td>
<td>Softmax</td>
</tr>
</tbody>
</table>
<div class="footer">
<p>Winner of the ILSVRC 2011 challenge (top-five error 17%), developed by Alex Krizhevsky, Ilya Sutskever, and Geoffrey Hinton.</p>
</div>
</section>
<section id="data-augmentation" class="slide level2">
<h2>Data Augmentation</h2>

<img data-src="data-augmentation.png" class="r-stretch quarto-figure-center"><p class="caption">Examples of data augmentation.</p><div class="footer">
<p>Source: Buah et al.&nbsp;(2019), <em>Can Artificial Intelligence Assist Project Developers in Long-Term Management of Energy Projects? The Case of CO2 Capture and Storage</em>.</p>
</div>
</section>
<section id="inception-module-2013" class="slide level2">
<h2>Inception module (2013)</h2>
<p>Used in ILSVRC 2013 winning solution (top-5 error &lt; 7%).</p>
<div class="columns">
<div class="column" style="width:59%;">
<p><img data-src="inception-module-fig-2b.png"></p>
</div><div class="column" style="width:39%;">
<p><br></p>
<p><img data-src="inception-meme.jpeg"></p>
</div>
</div>
<p>VGGNet was the runner-up.</p>
<div class="footer">
<p>Source: Szegedy, C. et al.&nbsp;(2014), <a href="https://arxiv.org/pdf/1409.4842.pdf"><em>Going deeper with convolutions</em></a>. and <a href="https://knowyourmeme.com/memes/we-need-to-go-deeper">KnowYourMeme.com</a></p>
</div>
</section>
<section id="googlenet-inception_v0-2014" class="slide level2">
<h2>GoogLeNet / Inception_v0 (2014)</h2>

<img data-src="Geron-mls2_1414-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Schematic of the GoogLeNet architecture.</p><div class="footer">
<p>Source: Aurlien Gron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-14.</p>
</div>
</section>
<section id="depth-is-important-for-image-tasks" class="slide level2">
<h2>Depth is important for image tasks</h2>

<img data-src="goodfellow-depth-matters.png" class="r-stretch quarto-figure-center"><p class="caption">Deeper models arent just better because they have more parameters. Model depth given in the legend. Accuracy is on the Street View House Numbers dataset.</p><div class="footer">
<p>Source: Goodfellow et al.&nbsp;(2015), <a href="http://www.deeplearningbook.org">Deep Learning</a>, Figure 6.7.</p>
</div>
</section>
<section id="residual-connection" class="slide level2">
<h2>Residual connection</h2>

<img data-src="Geron-mls2_1415-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of a residual connection.</p><div class="footer">
<p>Source: Aurlien Gron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-15.</p>
</div>
</section>
<section id="resnet-2014" class="slide level2">
<h2>ResNet (2014)</h2>
<p>ResNet won the ILSVRC 2014 challenge (top-5 error 3.6%), developed by <a href="https://arxiv.org/abs/1512.03385">Kaiming He et al.</a></p>

<img data-src="Geron-mls2_1417-blur.png" class="r-stretch quarto-figure-center"><p class="caption">Diagram of the ResNet architecture.</p><div class="footer">
<p>Source: Aurlien Gron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-17.</p>
</div>
</section>
<section id="pretrained-model" class="slide level2">
<h2>Pretrained model</h2>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a><span class="im">from</span> tensorflow.keras.applications <span class="im">import</span> mobilenet</span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb88-3"><a href="#cb88-3"></a></span>
<span id="cb88-4"><a href="#cb88-4"></a>model <span class="op">=</span> mobilenet.MobileNet(weights<span class="op">=</span><span class="st">"imagenet"</span>)</span>
<span id="cb88-5"><a href="#cb88-5"></a></span>
<span id="cb88-6"><a href="#cb88-6"></a>imageFilenames <span class="op">=</span> [<span class="st">"patrick-0.jpg"</span>, <span class="st">"umbrella-0.jpg"</span>, <span class="st">"hand-15.jpg"</span>]</span>
<span id="cb88-7"><a href="#cb88-7"></a>images <span class="op">=</span> [np.asarray(Image.<span class="bu">open</span>(name)) <span class="cf">for</span> name <span class="kw">in</span> imageFilenames]</span>
<span id="cb88-8"><a href="#cb88-8"></a></span>
<span id="cb88-9"><a href="#cb88-9"></a>images_resized <span class="op">=</span> tf.image.resize(images, [<span class="dv">224</span>, <span class="dv">224</span>])</span>
<span id="cb88-10"><a href="#cb88-10"></a>inputs <span class="op">=</span> mobilenet.preprocess_input(images_resized)</span>
<span id="cb88-11"><a href="#cb88-11"></a></span>
<span id="cb88-12"><a href="#cb88-12"></a>Y_proba <span class="op">=</span> model.predict(inputs, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb88-13"><a href="#cb88-13"></a>top_K <span class="op">=</span> mobilenet.decode_predictions(Y_proba, top<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb88-14"><a href="#cb88-14"></a></span>
<span id="cb88-15"><a href="#cb88-15"></a><span class="cf">for</span> image_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(images)):</span>
<span id="cb88-16"><a href="#cb88-16"></a>    <span class="bu">print</span>(<span class="ss">f"Image #</span><span class="sc">{</span>image_index<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb88-17"><a href="#cb88-17"></a>    <span class="cf">for</span> class_id, name, y_proba <span class="kw">in</span> top_K[image_index]:</span>
<span id="cb88-18"><a href="#cb88-18"></a>        <span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>class_id<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span><span class="bu">int</span>(y_proba<span class="op">*</span><span class="dv">100</span>)<span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb88-19"><a href="#cb88-19"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicted-classes-mobilenet" class="slide level2">
<h2>Predicted classes (MobileNet)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="66">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 39%
 n04591157 - Windsor_tie 34%
 n02749479 - assault_rifle 13%

Image #1:
 n03529860 - home_theater 25%
 n02749479 - assault_rifle 9%
 n04009552 - projector 5%

Image #2:
 n03529860 - home_theater 9%
 n03924679 - photocopier 7%
 n02786058 - Band_Aid 6%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenetv2" class="slide level2">
<h2>Predicted classes (MobileNetV2)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="67">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 34%
 n04591157 - Windsor_tie 8%
 n03630383 - lab_coat 7%

Image #1:
 n04023962 - punching_bag 9%
 n04336792 - stretcher 4%
 n03529860 - home_theater 4%

Image #2:
 n04404412 - television 42%
 n02977058 - cash_machine 6%
 n04152593 - screen 3%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-inceptionv3" class="slide level2">
<h2>Predicted classes (InceptionV3)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="68">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 25%
 n04591157 - Windsor_tie 10%
 n03630383 - lab_coat 4%

Image #1:
 n04507155 - umbrella 46%
 n03529860 - home_theater 2%
 n04344873 - studio_couch 2%

Image #2:
 n04404412 - television 20%
 n03630383 - lab_coat 7%
 n02777292 - balance_beam 7%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenet-1" class="slide level2">
<h2>Predicted classes (MobileNet)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="69">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n03483316 - hand_blower 21%
 n03271574 - electric_fan 8%
 n07579787 - plate 4%

Image #1:
 n03942813 - ping-pong_ball 88%
 n02782093 - balloon 3%
 n04023962 - punching_bag 1%

Image #2:
 n04557648 - water_bottle 31%
 n04336792 - stretcher 14%
 n03868863 - oxygen_mask 7%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenetv2-1" class="slide level2">
<h2>Predicted classes (MobileNetV2)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="70">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n03868863 - oxygen_mask 37%
 n03483316 - hand_blower 7%
 n03271574 - electric_fan 7%

Image #1:
 n03942813 - ping-pong_ball 29%
 n04270147 - spatula 12%
 n03970156 - plunger 8%

Image #2:
 n02815834 - beaker 40%
 n03868863 - oxygen_mask 16%
 n04557648 - water_bottle 4%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-inceptionv3-1" class="slide level2">
<h2>Predicted classes (InceptionV3)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div class="cell" data-execution_count="71">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n02815834 - beaker 41%
 n03630383 - lab_coat 6%
 n03179701 - desk 6%

Image #1:
 n03942813 - ping-pong_ball 82%
 n02782093 - balloon 10%
 n03447721 - gong 0%

Image #2:
 n04557648 - water_bottle 72%
 n03983396 - pop_bottle 10%
 n03868863 - oxygen_mask 1%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="transfer-learned-model" class="slide level2">
<h2>Transfer learned model</h2>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1"></a>modelFile <span class="op">=</span> <span class="st">"teachable-machine-model-3143.h5"</span></span>
<span id="cb95-2"><a href="#cb95-2"></a>model <span class="op">=</span> keras.models.load_model(modelFile)</span>
<span id="cb95-3"><a href="#cb95-3"></a>model.layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>[&lt;keras.engine.sequential.Sequential at 0x17bca5d5c30&gt;,
 &lt;keras.engine.sequential.Sequential at 0x17bcdd95e40&gt;]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1"></a>model.layers[<span class="dv">0</span>].layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>[&lt;keras.engine.functional.Functional at 0x17bcdd95f60&gt;,
 &lt;keras.layers.pooling.global_average_pooling2d.GlobalAveragePooling2D at 0x17bc7d2f190&gt;]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a>model.layers[<span class="dv">1</span>].layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>[&lt;keras.layers.core.dense.Dense at 0x17bcb0ca830&gt;,
 &lt;keras.layers.core.dense.Dense at 0x17bca25d390&gt;]</code></pre>
</div>
</div>
</div><div class="column" style="width:35%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="turtles-all-the-way-down.jpeg"></p>
<p></p><figcaption>Models inside of models</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: <a href="https://www.behance.net/gallery/66946885/Turtles-All-the-Way-Down">Behance</a></p>
</div>
</section>
<section id="transfer-learned-model-ii" class="slide level2">
<h2>Transfer learned model II</h2>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a>model.layers[<span class="dv">0</span>].layers[<span class="dv">0</span>].layers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>[&lt;keras.engine.input_layer.InputLayer at 0x17bcdd94400&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x17c0eef7010&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bcb86edd0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bcb86f0a0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bcb86f2e0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bcb86f9a0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bcb86ffa0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bcb86fd60&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bcdd96140&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1e4970&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca1e4bb0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1e5330&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca1e5570&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x17bca1e5c30&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca1e5e70&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1e6440&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca1e6290&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca1e6ad0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1e6dd0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca1e7010&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1e7790&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca1e79d0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca1e69e0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2946d0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca294520&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca294d60&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca295060&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca2952d0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca2958d0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca295c00&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca295e40&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x17bca296500&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca296740&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca296d10&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca296b60&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca2973a0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2976a0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca2978e0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca297e20&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bcdd94340&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca20c9a0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca20cfa0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca20cdf0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca20d630&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca20d930&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca20dba0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca20e1a0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca20e4d0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca20e710&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca20edd0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca20f3d0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca20f220&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca20fa60&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca20fd60&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca20f970&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca2972b0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1f4940&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca1f4b80&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x17bca1f5240&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca1f5480&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1f5a50&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca1f58a0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca1f60e0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1f63e0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca1f6620&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1f6da0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca1f6fe0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca1f76a0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca1f7ca0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca1f7af0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca20ffa0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2b0670&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca2b08e0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca2b0ee0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2b1210&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca2b1450&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca2b1b10&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2b2110&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca2b1f60&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca2b27a0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2b2aa0&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca2b2d10&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca2b3310&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2b3640&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca2b3880&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca2b3f40&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca274580&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca2743d0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca274c10&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca274f10&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca275180&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca275780&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca275ab0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca275cf0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca2763b0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca2769b0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca276800&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca277040&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca277340&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca277580&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca277d00&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca277f70&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca1f7cd0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca25cc40&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca25ca90&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca25d2d0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca25d5d0&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca25d840&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca25de40&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca25e170&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca25e3b0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bca25ea70&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca25f070&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bca25eec0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca25f700&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca25fa00&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bca25fc70&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bca25ffd0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca276f50&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7cd0820&gt;,
 &lt;keras.layers.reshaping.zero_padding2d.ZeroPadding2D at 0x17bc7cd0ee0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bc7cd1120&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7cd16f0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7cd1540&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7cd1d80&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7cd2080&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7cd22c0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7cd2a40&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7cd2c80&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bc7cd3340&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7cd3940&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7cd3790&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7cd3970&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bca25fc40&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bc7d50580&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7d50b80&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7d50eb0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7d510f0&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bc7d517b0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7d51db0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7d51c00&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7d52440&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7d52740&gt;,
 &lt;keras.layers.merging.add.Add at 0x17bc7d529b0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7d52fb0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7d532e0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7d53520&gt;,
 &lt;keras.layers.convolutional.depthwise_conv2d.DepthwiseConv2D at 0x17bc7d53be0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7cd3ee0&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7d2c070&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7d2c8b0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7d2cbb0&gt;,
 &lt;keras.layers.convolutional.conv2d.Conv2D at 0x17bc7d2cdf0&gt;,
 &lt;keras.layers.normalization.batch_normalization.BatchNormalization at 0x17bc7d2d570&gt;,
 &lt;keras.layers.activation.relu.ReLU at 0x17bc7d2d7b0&gt;]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a><span class="bu">len</span>(model.layers[<span class="dv">0</span>].layers[<span class="dv">0</span>].layers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>155</code></pre>
</div>
</div>
</section>
<section id="transfer-learned-model-iii" class="slide level2">
<h2>Transfer learned model III</h2>
<div style="overflow:auto; height: 90%">
<p><img src="mobilenet-model.png"></p>
</div>
</section>
<section id="transfer-learning-1" class="slide level2">
<h2>Transfer learning</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a><span class="co"># Pull in the base model we are transferring from.</span></span>
<span id="cb105-2"><a href="#cb105-2"></a>base_model <span class="op">=</span> keras.applications.Xception(</span>
<span id="cb105-3"><a href="#cb105-3"></a>    weights<span class="op">=</span><span class="st">'imagenet'</span>,  <span class="co"># Load weights pre-trained on ImageNet.</span></span>
<span id="cb105-4"><a href="#cb105-4"></a>    input_shape<span class="op">=</span>(<span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">3</span>),</span>
<span id="cb105-5"><a href="#cb105-5"></a>    include_top<span class="op">=</span><span class="va">False</span>)  <span class="co"># Discard the ImageNet classifier at the top.</span></span>
<span id="cb105-6"><a href="#cb105-6"></a></span>
<span id="cb105-7"><a href="#cb105-7"></a><span class="co"># Tell it not to update its weights.</span></span>
<span id="cb105-8"><a href="#cb105-8"></a>base_model.trainable <span class="op">=</span> <span class="va">False</span></span>
<span id="cb105-9"><a href="#cb105-9"></a></span>
<span id="cb105-10"><a href="#cb105-10"></a><span class="co"># Make our new model on top of the base model.</span></span>
<span id="cb105-11"><a href="#cb105-11"></a>inputs <span class="op">=</span> keras.Input(shape<span class="op">=</span>(<span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">3</span>))</span>
<span id="cb105-12"><a href="#cb105-12"></a>x <span class="op">=</span> base_model(inputs, training<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb105-13"><a href="#cb105-13"></a>x <span class="op">=</span> keras.layers.GlobalAveragePooling1D()(x)</span>
<span id="cb105-14"><a href="#cb105-14"></a>outputs <span class="op">=</span> keras.layers.Dense(<span class="dv">0</span>)(x)</span>
<span id="cb105-15"><a href="#cb105-15"></a>model <span class="op">=</span> keras.Model(inputs, outputs)</span>
<span id="cb105-16"><a href="#cb105-16"></a></span>
<span id="cb105-17"><a href="#cb105-17"></a><span class="co"># Compile and fit on our data.</span></span>
<span id="cb105-18"><a href="#cb105-18"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span>keras.optimizers.Adam(),</span>
<span id="cb105-19"><a href="#cb105-19"></a>              loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb105-20"><a href="#cb105-20"></a>              metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb105-21"><a href="#cb105-21"></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">19</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="footer">
<p>Source: Franois Chollet (2019), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section>
<section id="fine-tuning" class="slide level2">
<h2>Fine-tuning</h2>
<div class="sourceCode" id="cb106"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># Unfreeze the base model</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>base_model.trainable <span class="op">=</span> <span class="va">True</span></span>
<span id="cb106-3"><a href="#cb106-3"></a></span>
<span id="cb106-4"><a href="#cb106-4"></a><span class="co"># It's important to recompile your model after you make any changes</span></span>
<span id="cb106-5"><a href="#cb106-5"></a><span class="co"># to the `trainable` attribute of any inner layer, so that your changes</span></span>
<span id="cb106-6"><a href="#cb106-6"></a><span class="co"># are take into account</span></span>
<span id="cb106-7"><a href="#cb106-7"></a>model.<span class="bu">compile</span>(</span>
<span id="cb106-8"><a href="#cb106-8"></a>    optimizer<span class="op">=</span>keras.optimizers.Adam(<span class="fl">0e-5</span>),  <span class="co"># Very low learning rate</span></span>
<span id="cb106-9"><a href="#cb106-9"></a>    loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb106-10"><a href="#cb106-10"></a>    metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb106-11"><a href="#cb106-11"></a></span>
<span id="cb106-12"><a href="#cb106-12"></a><span class="co"># Train end-to-end. Be careful to stop before you overfit!</span></span>
<span id="cb106-13"><a href="#cb106-13"></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">9</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-caution callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Danger</strong></p>
</div>
<div class="callout-content">
<p>Keep the learning rate low, otherwise you may accidentally throw away the useful information in the base model.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: Franois Chollet (2019), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section>
<section id="what-do-the-cnn-layers-learn" class="slide level2">
<h2>What do the CNN layers learn?</h2>

<img data-src="distill-feature-visualisation.png" class="r-stretch"><div class="footer">
<p>Source: Distill article, <a href="https://distill.pub/2016/feature-visualization/">Feature Visualization</a>.</p>
</div>
</section></section>
<section id="section-3" class="title-slide slide level1 center" data-visibility="uncounted">
<h1></h1>
<h2>
Glossary
</h2>
<div class="columns">
<div class="column">
<ul>
<li>channels</li>
<li>computer vision</li>
<li>convolutional layer &amp; CNN</li>
<li>error analysis</li>
<li>filter</li>
</ul>
</div><div class="column">
<ul>
<li>flatten layer</li>
<li>kernel</li>
<li>max pooling</li>
<li>MNIST</li>
<li>stride</li>
</ul>
</div>
</div>
<script defer="">
    // Remove the highlight.js class for the 'compile', 'min', 'max'
    // as there's a bug where they are treated like the Python built-in
    // global functions but we only ever see it as methods like
    // 'model.compile()' or 'predictions.max()'
    buggyBuiltIns = ["compile", "min", "max", "round", "sum"];

    document.querySelectorAll('.bu').forEach((elem) => {
        if (buggyBuiltIns.includes(elem.innerHTML)) {
            elem.classList.remove('bu');
        }
    })

    var registerRevealCallbacks = function() {
        Reveal.on('overviewshown', event => {
            document.querySelector(".line.right").hidden = true;
        });
        Reveal.on('overviewhidden', event => {
            document.querySelector(".line.right").hidden = false;
        });
    };
</script>

<img src="unsw-logo.svg" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Slides: <a href="https://pat-laub.github.io">Dr Patrick Laub</a> (<span class="citation" data-cites="PatrickLaub">@PatrickLaub</span>).</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="computer-vision_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="computer-vision_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="computer-vision_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="computer-vision_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":6,"grid":false,"background":["rgba(255,255,255,0.0)","https://github.com/rajgoel/reveal.js-plugins/raw/master/chalkboard/img/blackboard.png"]},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.2,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    <script>registerRevealCallbacks();</script>
    

</body></html>