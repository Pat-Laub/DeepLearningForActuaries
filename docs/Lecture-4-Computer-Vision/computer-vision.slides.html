<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Patrick Laub">
  <title>AI for Actuaries - Computer Vision</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {  background-color: #e9ecef; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #0040ff; font-weight: bold; } /* Alert */
    code span.an { color: #4090c0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #336699; } /* Attribute */
    code span.bn { color: #0033a0; } /* BaseN */
    code span.bu { color: #0055cc; } /* BuiltIn */
    code span.cf { color: #0055cc; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #002080; } /* Constant */
    code span.co { color: #4090c0; font-style: italic; } /* Comment */
    code span.cv { color: #4090c0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #3060a0; font-style: italic; } /* Documentation */
    code span.dt { color: #0044bb; } /* DataType */
    code span.dv { color: #0033a0; } /* DecVal */
    code span.er { color: #0040ff; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0033a0; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #0055cc; font-weight: bold; } /* Import */
    code span.in { color: #4090c0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #0055cc; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #0055cc; } /* Other */
    code span.pp { color: #336699; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #336699; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #4090c0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Computer Vision</h1>
  <p class="subtitle">ACTL3143 &amp; ACTL5111 Deep Learning for Actuaries</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Patrick Laub 
</div>
</div>
</div>

</section>
<section id="load-packages" class="slide level2" data-visibility="uncounted">
<h2>Load packages</h2>
<div id="c30087f5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> random</span>
<span id="cb1-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a></a></span>
<span id="cb1-6"><a></a><span class="im">import</span> keras</span>
<span id="cb1-7"><a></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-8"><a></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, Input</span>
<span id="cb1-9"><a></a><span class="im">from</span> keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-10"><a></a><span class="im">from</span> keras.utils <span class="im">import</span> plot_model</span>
<span id="cb1-11"><a></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-12"><a></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="dd8be684" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a><span class="im">from</span> watermark <span class="im">import</span> watermark</span>
<span id="cb2-2"><a></a><span class="bu">print</span>(watermark(python<span class="op">=</span><span class="va">True</span>, packages<span class="op">=</span><span class="st">"sklearn,keras,torch,tensorflow"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Python implementation: CPython
Python version       : 3.11.0
IPython version      : 8.20.0

sklearn   : 1.4.0
keras     : 3.0.4
torch     : 2.2.0
tensorflow: 2.15.0.post1
</code></pre>
</div>
</div>
</section>
<section>
<section id="images" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Images</h1>

</section>
<section id="shapes-of-data" class="slide level2">
<h2>Shapes of data</h2>

<img data-src="medium-tensor-rank.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of tensors of different rank.</p><div class="footer">
<p>Source: Paras Patidar (2019), <a href="https://medium.com/mlait/tensors-representation-of-data-in-neural-networks-bbe8a711b93b">Tensors â€” Representation of Data In Neural Networks</a>, Medium article.</p>
</div>
</section>
<section id="shapes-of-photos" class="slide level2">
<h2>Shapes of photos</h2>

<img data-src="rgb-channels.png" class="r-stretch quarto-figure-center"><p class="caption">A photo is a rank 3 tensor.</p><div class="footer">
<p>Source: Kim et al (2021), <a href="https://www.mdpi.com/applsci/applsci-11-03418/article_deploy/html/images/applsci-11-03418-g001.png">Data Hiding Method for Color AMBTC Compressed Images Using Color Difference</a>, Applied Sciences.</p>
</div>
</section>
<section id="how-the-computer-sees-them" class="slide level2 smaller">
<h2>How the computer sees them</h2>
<div id="1f84e8a5" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="im">from</span> matplotlib.image <span class="im">import</span> imread</span>
<span id="cb4-2"><a></a>img1 <span class="op">=</span> imread(<span class="st">'pu.gif'</span>)<span class="op">;</span> img2 <span class="op">=</span> imread(<span class="st">'pl.gif'</span>)</span>
<span id="cb4-3"><a></a>img3 <span class="op">=</span> imread(<span class="st">'pr.gif'</span>)<span class="op">;</span> img4 <span class="op">=</span> imread(<span class="st">'pg.bmp'</span>)</span>
<span id="cb4-4"><a></a><span class="ss">f"Shapes are: </span><span class="sc">{</span>img1<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img2<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img3<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>img4<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2435b903" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>'Shapes are: (16, 16, 3), (16, 16, 3), (16, 16, 3), (16, 16, 3).'</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div id="96698f43" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a>img1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="d16ef2f7" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a>img2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="263fb728" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a>img3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [255, 255,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="334398d9" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>img4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([[[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [ 51,   0, 255],
        [ 51,   0, 255],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 255, 255],
        [255, 255, 255],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177]],

       [[255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0]],

       [[255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [255, 163, 177],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0]],

       [[255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0],
        [255, 163, 177],
        [  0,   0,   0],
        [  0,   0,   0],
        [  0,   0,   0]]], dtype=uint8)</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="how-we-see-them" class="slide level2">
<h2>How we see them</h2>
<div id="5b694598" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> imshow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:25%;">
<div id="a73e5695" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a>imshow(img1)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-12-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="40b16751" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>imshow(img2)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-13-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="85146685" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a>imshow(img3)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-14-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:25%;">
<div id="f5f9b55c" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a></a>imshow(img4)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-15-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="why-is-255-special" class="slide level2">
<h2>Why is 255 special?</h2>
<p>Each pixelâ€™s colour intensity is stored in one byte.</p>
<p>One byte is 8 bits, so in binary that is 00000000 to 11111111.</p>
<p>The largest <em>unsigned</em> number this can be is <span class="math inline">2^8-1 = 255</span>.</p>
<div id="bdfbf17e" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a></a>np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">255</span>, <span class="dv">256</span>]).astype(np.uint8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([  0,   1, 255,   0], dtype=uint8)</code></pre>
</div>
</div>
<p>If you had <em>signed</em> numbers, this would go from -128 to 127.</p>
<div id="8670c73c" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a></a>np.array([<span class="op">-</span><span class="dv">128</span>, <span class="dv">1</span>, <span class="dv">127</span>, <span class="dv">128</span>]).astype(np.int8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([-128,    1,  127, -128], dtype=int8)</code></pre>
</div>
</div>
<p>Alternatively, <em>hexidecimal</em> numbers are used. E.g. 10100001 is split into 1010 0001, and 1010=A, 0001=1, so combined it is 0xA1.</p>
</section>
<section id="image-editing-with-kernels" class="slide level2">
<h2>Image editing with kernels</h2>
<p>Take a look at <a href="https://setosa.io/ev/image-kernels/">https://setosa.io/ev/image-kernels/</a>.</p>

<img data-src="convolution.gif" class="r-stretch quarto-figure-center"><p class="caption">An example of an image kernel in action.</p><div class="footer">
<p>Source: <a href="http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution">Stanfordâ€™s deep learning tutorial</a> via <a href="https://stats.stackexchange.com/a/188216">Stack Exchange</a>.</p>
</div>
</section></section>
<section>
<section id="convolutional-layers" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Convolutional Layers</h1>

</section>
<section id="convolution-not-complicated" class="slide level2">
<h2>â€˜Convolutionâ€™ not â€˜complicatedâ€™</h2>
<p>Say <span class="math inline">X_1, X_2 \sim f_X</span> are i.i.d., and we look at <span class="math inline">S = X_1 + X_2</span>.</p>
<p>The density for <span class="math inline">S</span> is then</p>
<p><span class="math display">
f_S(s) = \int_{x_1=-\infty}^{\infty} f_X(x_1) \, f_X(s-x_1) \,\mathrm{d}s .
</span></p>
<p>This is the <em>convolution</em> operation, <span class="math inline">f_S = f_X \star f_X</span>.</p>
</section>
<section id="images-are-rank-3-tensors" class="slide level2">
<h2>Images are rank 3 tensors</h2>
<p>Height, width, and number of channels.</p>

<img data-src="Glassner/16-1.png" class="r-stretch quarto-figure-center"><p class="caption">Examples of rank 3 tensors.</p><p>Grayscale image has 1 channel. RGB image has 3 channels.</p>
<p>Example: Yellow = Red + Green.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow" class="slide level2">
<h2>Example: Detecting yellow</h2>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-3.png"></p>
<figcaption>Applying a neuron to an image pixel.</figcaption>
</figure>
</div>
</div><div class="column">
<p><br></p>
<p>Apply a neuron to each pixel in the image.</p>
<p><br></p>
<p>If red/green <span class="math inline">\nearrow</span> or blue <span class="math inline">\searrow</span> then yellowness <span class="math inline">\nearrow</span>.</p>
<p><br></p>
<p>Set RGB weights to 1, 1, -1.</p>
</div>
</div>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow-ii" class="slide level2">
<h2>Example: Detecting yellow II</h2>

<img data-src="Glassner/16-4.png" class="r-stretch quarto-figure-center"><p class="caption">Scan the 3-channel input (colour image) with the neuron to produce a 1-channel output (grayscale image).</p><p>The output is produced by <em>sweeping</em> the neuron over the input. This is called <strong>convolution</strong>.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-detecting-yellow-iii" class="slide level2" data-visibility="uncounted">
<h2>Example: Detecting yellow III</h2>

<img data-src="Glassner/16-5.png" class="r-stretch quarto-figure-center"><p class="caption">The more yellow the pixel in the colour image (left), the more white it is in the grayscale image.</p><p>The neuron or its weights is called a <strong>filter</strong>. We <em>convolve</em> the image with a filter, i.e.&nbsp;a <strong>convolutional filter</strong>.</p>
</section>
<section id="terminology" class="slide level2">
<h2>Terminology</h2>
<ul>
<li>The same neuron is used to sweep over the image, so we can store the weights in some shared memory and process the pixels in parallel. We say that the neurons are <em>weight sharing</em>.</li>
<li>In the previous example, the neuron only takes one pixel as input. Usually a larger filter containing a <em>block of weights</em> is used to process not only a pixel but also its neighboring pixels all at once.</li>
<li>The weights are called the filter <strong>kernels</strong>.</li>
<li>The cluster of pixels that forms the input of a filter is called its <em>footprint</em>.</li>
</ul>
</section>
<section id="spatial-filter" class="slide level2">
<h2>Spatial filter</h2>

<img data-src="Glassner/16-9.png" class="r-stretch quarto-figure-center"><p class="caption">Example 3x3 filter</p><p>When a filterâ€™s footprint is &gt; 1 pixel, it is a <strong>spatial filter</strong>.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="multidimensional-convolution" class="slide level2">
<h2>Multidimensional convolution</h2>
<p>Need <span class="math inline">\# \text{ Channels in Input} = \# \text{ Channels in Filter}</span>.</p>

<img data-src="Glassner/16-18.png" class="r-stretch quarto-figure-center"><p class="caption">Example: a 3x3 filter with 3 channels, containing 27 weights.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="example-3x3-filter-over-rgb-input" class="slide level2">
<h2>Example: 3x3 filter over RGB input</h2>

<img data-src="Glassner/16-19.png" class="r-stretch quarto-figure-center"><p class="caption">Each channel is multipled separately &amp; then added together.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="input-output-relationship" class="slide level2">
<h2>Input-output relationship</h2>

<img data-src="Glassner/16-10.png" class="r-stretch quarto-figure-center"><p class="caption">Matching the original image footprints against the output location.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section></section>
<section>
<section id="convolutional-layer-options" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Convolutional Layer Options</h1>

</section>
<section id="padding" class="slide level2">
<h2>Padding</h2>

<img data-src="Glassner/16-15.png" class="r-stretch quarto-figure-center"><p class="caption">What happens when filters go off the edge of the input?</p><ul>
<li>How to avoid the filterâ€™s receptive field falling off the side of the input.</li>
<li>If we only scan the filter over places of the input where the filter can fit perfectly, it will lead to loss of information, especially after many filters.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="padding-1" class="slide level2">
<h2>Padding</h2>
<p>Add a border of extra elements around the input, called <strong>padding</strong>. Normally we place zeros in all the new elements, called <strong>zero padding</strong>.</p>

<img data-src="Glassner/16-17.png" class="r-stretch quarto-figure-center"><p class="caption">Padded values can be added to the outside of the input.</p><div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="convolution-layer" class="slide level2">
<h2>Convolution layer</h2>
<ul>
<li>Multiple filters are bundled together in one layer.</li>
<li>The filters are applied <em>simultaneously</em> and <em>independently</em> to the input.</li>
<li>Filters can have different footprints, but in practice we almost always use the same footprint for every filter in a convolution layer.</li>
<li>Number of channels in the output will be the same as the number of filters.</li>
</ul>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="columns">
<div class="column">
<p>In the image:</p>
<ul>
<li>6-channel input tensor</li>
<li>input pixels</li>
<li>four 3x3 filters</li>
<li>four output tensors</li>
<li>final output tensor.</li>
</ul>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Glassner/16-21.png"></p>
<figcaption>Example network highlighting that the number of output channels equals the number of filters.</figcaption>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="x1-convolution" class="slide level2">
<h2>1x1 convolution</h2>
<ul>
<li>Feature reduction: Reduce the number of channels in the input tensor (removing correlated features) by using fewer filters than the number of channels in the input. This is because the number of channels in the output is always the same as number of filters.</li>
<li>1x1 convolution: Convolution using 1x1 filters.</li>
<li>When the channels are correlated, 1x1 convolution is very effective at reducing channels without loss of information.</li>
</ul>
</section>
<section id="example-of-1x1-convolution" class="slide level2 smaller">
<h2>Example of 1x1 convolution</h2>

<img data-src="Glassner/16-23.png" class="r-stretch quarto-figure-center"><p class="caption">Example network with 1x1 convolution.</p><ul>
<li>Input tensor contains 300 channels.</li>
<li>Use 175 1x1 filters in the convolution layer (300 weights each).</li>
<li>Each filter produces a 1-channel output.</li>
<li>Final output tensor has 175 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="striding" class="slide level2">
<h2>Striding</h2>
<p>We donâ€™t have to go one pixel across/down at a time.</p>

<img data-src="Glassner/16-29.png" class="r-stretch quarto-figure-center"><p class="caption">Example: Use a stride of three horizontally and two vertically.</p><p>Dimension of output will be smaller than input.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="choosing-strides" class="slide level2 smaller">
<h2>Choosing strides</h2>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-31.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="Glassner/16-32.png"></p>
</div>
</div>
</div>
<p>When a filter scans the input step by step, it processes the same input elements multiple times. Even with larger strides, this can still happen (left image).</p>
<p><strong>If</strong> we want to save time, we can choose strides that prevents input elements from being used more than once. Example (right image): 3x3 filter, stride 3 in both directions.</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="specifying-a-convolutional-layer" class="slide level2">
<h2>Specifying a convolutional layer</h2>
<p>Need to choose:</p>
<ul>
<li>number of filters,</li>
<li>their footprints (e.g.&nbsp;3x3, 5x5, etc.),</li>
<li>activation functions,</li>
<li>padding &amp; striding (optional).</li>
</ul>
<p>All the filter weights are learned during training.</p>
</section></section>
<section>
<section id="convolutional-neural-networks" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Convolutional Neural Networks</h1>

</section>
<section id="definition-of-cnn" class="slide level2">
<h2>Definition of CNN</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><br> <br></p>
<p>A neural network that uses <em>convolution layers</em> is called a <em>convolutional neural network</em>.</p>
</div><div class="column" style="width:40%;">
<p><img data-src="xkcd-trained_a_neural_net_2x.png"></p>
</div>
</div>
<div class="footer">
<p>Source: Randall Munroe (2019), <a href="https://xkcd.com/2173/">xkcd #2173: Trained a Neural Net</a>.</p>
</div>
</section>
<section id="architecture" class="slide level2">
<h2>Architecture</h2>

<img data-src="Geron-mls2_1411.png" class="r-stretch quarto-figure-center"><p class="caption">Typical CNN architecture.</p><div class="footer">
<p>Source: AurÃ©lien GÃ©ron (2019), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-11.</p>
</div>
</section>
<section id="architecture-2" class="slide level2">
<h2>Architecture #2</h2>

<img data-src="mathworks-typical-cnn.svg" class="r-stretch"><div class="footer">
<p>Source: MathWorks, <a href="https://au.mathworks.com/campaigns/offers/next/deep-learning-ebook.html"><em>Introducing Deep Learning with MATLAB</em></a>, Ebook.</p>
</div>
</section>
<section id="pooling" class="slide level2">
<h2>Pooling</h2>
<p><strong>Pooling</strong>, or <strong>downsampling</strong>, is a technique to blur a tensor.</p>

<img data-src="Glassner/16-27.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of pool operations.</p><p>(a): Input tensor (b): Subdivide input tensor into 2x2 blocks (c): Average pooling (d): Max pooling (e): Icon for a pooling layer</p>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="pooling-for-multiple-channels" class="slide level2 smaller">
<h2>Pooling for multiple channels</h2>

<img data-src="Glassner/16-28.png" class="r-stretch quarto-figure-center"><p class="caption">Pooling a multichannel input.</p><ul>
<li>Input tensor: 6x6 with 1 channel, zero padding.</li>
<li>Convolution layer: Three 3x3 filters.</li>
<li>Convolution layer output: 6x6 with 3 channels.</li>
<li>Pooling layer: apply max pooling to each channel.</li>
<li>Pooling layer output: 3x3, 3 channels.</li>
</ul>
<div class="footer">
<p>Source: Glassner (2021), <em>Deep Learning: A Visual Approach</em>, Chapter 16.</p>
</div>
</section>
<section id="whywhy-not-use-pooling" class="slide level2">
<h2>Why/why not use pooling?</h2>
<p><strong>Why?</strong> Pooling <em>reduces the size</em> of tensors, therefore reduces memory usage and execution time (recall that 1x1 convolution <em>reduces the number of channels</em> in a tensor).</p>
<p><strong>Why not?</strong></p>

<img data-src="reddit-hinton-pooling.png" class="r-stretch quarto-figure-center"><p class="caption">Geoffrey Hinton</p><div class="footer">
<p>Source: Hinton, <a href="https://www.reddit.com/r/MachineLearning/comments/2lmo0l/comment/clyj4jv/?utm_source=share&amp;utm_medium=web2x&amp;context=3">Reddit AMA</a>.</p>
</div>
</section>
<section id="what-do-the-cnn-layers-learn" class="slide level2">
<h2>What do the CNN layers learn?</h2>

<img data-src="distill-feature-visualisation.png" class="r-stretch"><div class="footer">
<p>Source: Distill article, <a href="https://distill.pub/2017/feature-visualization/">Feature Visualization</a>.</p>
</div>
</section></section>
<section>
<section id="demo-character-recognition" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Demo: Character Recognition</h1>

</section>
<section id="mnist-dataset" class="slide level2">
<h2>MNIST Dataset</h2>

<img data-src="wiki-MnistExamples.png" class="r-stretch quarto-figure-center"><p class="caption">The MNIST dataset.</p><div class="footer">
<p>Source: Wikipedia, <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST database</a>.</p>
</div>
</section>
<section id="mandarin-characters-dataset" class="slide level2">
<h2>Mandarin Characters Dataset</h2>
<p>57 poorly written Mandarin characters (<span class="math inline">57 \times 7 = 399</span>).</p>

<img data-src="mandarin-practice-notebook3.png" class="r-stretch quarto-figure-center"><p class="caption">Dataset of notes when learning/practising basic characters.</p></section>
<section id="downloading-the-dataset" class="slide level2">
<h2>Downloading the dataset</h2>
<p>The data is zipped (6.9 MB) and stored on my GitHub homepage.</p>
<div id="88149e02" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a><span class="co"># Download the dataset if it hasn't already been downloaded.</span></span>
<span id="cb23-2"><a></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb23-3"><a></a><span class="cf">if</span> <span class="kw">not</span> Path(<span class="st">"mandarin"</span>).exists():</span>
<span id="cb23-4"><a></a>  <span class="bu">print</span>(<span class="st">"Downloading dataset..."</span>)</span>
<span id="cb23-5"><a></a>  <span class="op">!</span>wget https:<span class="op">//</span>laub.au<span class="op">/</span>data<span class="op">/</span>mandarin.<span class="bu">zip</span></span>
<span id="cb23-6"><a></a>  <span class="op">!</span>unzip mandarin.<span class="bu">zip</span></span>
<span id="cb23-7"><a></a><span class="cf">else</span>:</span>
<span id="cb23-8"><a></a>  <span class="bu">print</span>(<span class="st">"Already downloaded."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Already downloaded.</code></pre>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Remember, the Jupyter notebook associated with your final report should either download your dataset when it is run, or you should supply the data separately.</p>
</div>
</div>
</div>
</section>
<section id="directory-structure" class="slide level2">
<h2>Directory structure</h2>
<div class="columns">
<div class="column">
<p>Inspect directory structure</p>
<div id="44dbdad3" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="op">!</span>pip install directory_tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="815712d9" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a></a><span class="im">from</span> directory_tree <span class="im">import</span> display_tree</span>
<span id="cb26-2"><a></a>display_tree(<span class="st">"mandarin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin/
â”œâ”€â”€ bai/
â”‚   â”œâ”€â”€ bai-1.png
â”‚   â”œâ”€â”€ bai-2.png
â”‚   â”œâ”€â”€ bai-3.png
â”‚   â”œâ”€â”€ bai-4.png
â”‚   â”œâ”€â”€ bai-5.png
â”‚   â”œâ”€â”€ bai-6.png
â”‚   â””â”€â”€ bai-7.png
â”œâ”€â”€ ben/
â”‚   â”œâ”€â”€ ben-1.png
â”‚   â”œâ”€â”€ ben-2.png
â”‚   â”œâ”€â”€ ben-3.png
â”‚   â”œâ”€â”€ ben-4.png
â”‚   â”œâ”€â”€ ben-5.png
â”‚   â”œâ”€â”€ ben-6.png
â”‚   â””â”€â”€ ben-7.png
â”œâ”€â”€ chong/
â”‚   â”œâ”€â”€ chong-1.png
â”‚   â”œâ”€â”€ chong-2.png
â”‚   â”œâ”€â”€ chong-3.png
â”‚   â”œâ”€â”€ chong-4.png
â”‚   â”œâ”€â”€ chong-5.png
â”‚   â”œâ”€â”€ chong-6.png
â”‚   â””â”€â”€ chong-7.png
â”œâ”€â”€ chu/
â”‚   â”œâ”€â”€ chu-1.png
â”‚   â”œâ”€â”€ chu-2.png
â”‚   â”œâ”€â”€ chu-3.png
â”‚   â”œâ”€â”€ chu-4.png
â”‚   â”œâ”€â”€ chu-5.png
â”‚   â”œâ”€â”€ chu-6.png
â”‚   â””â”€â”€ chu-7.png
â”œâ”€â”€ chuan/
â”‚   â”œâ”€â”€ chuan-1.png
â”‚   â”œâ”€â”€ chuan-2.png
â”‚   â”œâ”€â”€ chuan-3.png
â”‚   â”œâ”€â”€ chuan-4.png
â”‚   â”œâ”€â”€ chuan-5.png
â”‚   â”œâ”€â”€ chuan-6.png
â”‚   â””â”€â”€ chuan-7.png
â”œâ”€â”€ cong/
â”‚   â”œâ”€â”€ cong-1.png
â”‚   â”œâ”€â”€ cong-2.png
â”‚   â”œâ”€â”€ cong-3.png
â”‚   â”œâ”€â”€ cong-4.png
â”‚   â”œâ”€â”€ cong-5.png
â”‚   â”œâ”€â”€ cong-6.png
â”‚   â””â”€â”€ cong-7.png
â”œâ”€â”€ da/
â”‚   â”œâ”€â”€ da-1.png
â”‚   â”œâ”€â”€ da-2.png
â”‚   â”œâ”€â”€ da-3.png
â”‚   â”œâ”€â”€ da-4.png
â”‚   â”œâ”€â”€ da-5.png
â”‚   â”œâ”€â”€ da-6.png
â”‚   â””â”€â”€ da-7.png
â”œâ”€â”€ dan/
â”‚   â”œâ”€â”€ dan-1.png
â”‚   â”œâ”€â”€ dan-2.png
â”‚   â”œâ”€â”€ dan-3.png
â”‚   â”œâ”€â”€ dan-4.png
â”‚   â”œâ”€â”€ dan-5.png
â”‚   â”œâ”€â”€ dan-6.png
â”‚   â””â”€â”€ dan-7.png
â”œâ”€â”€ dong/
â”‚   â”œâ”€â”€ dong-1.png
â”‚   â”œâ”€â”€ dong-2.png
â”‚   â”œâ”€â”€ dong-3.png
â”‚   â”œâ”€â”€ dong-4.png
â”‚   â”œâ”€â”€ dong-5.png
â”‚   â”œâ”€â”€ dong-6.png
â”‚   â””â”€â”€ dong-7.png
â”œâ”€â”€ fei/
â”‚   â”œâ”€â”€ fei-1.png
â”‚   â”œâ”€â”€ fei-2.png
â”‚   â”œâ”€â”€ fei-3.png
â”‚   â”œâ”€â”€ fei-4.png
â”‚   â”œâ”€â”€ fei-5.png
â”‚   â”œâ”€â”€ fei-6.png
â”‚   â””â”€â”€ fei-7.png
â”œâ”€â”€ fu/
â”‚   â”œâ”€â”€ fu-1.png
â”‚   â”œâ”€â”€ fu-2.png
â”‚   â”œâ”€â”€ fu-3.png
â”‚   â”œâ”€â”€ fu-4.png
â”‚   â”œâ”€â”€ fu-5.png
â”‚   â”œâ”€â”€ fu-6.png
â”‚   â””â”€â”€ fu-7.png
â”œâ”€â”€ fu2/
â”‚   â”œâ”€â”€ fu2-1.png
â”‚   â”œâ”€â”€ fu2-2.png
â”‚   â”œâ”€â”€ fu2-3.png
â”‚   â”œâ”€â”€ fu2-4.png
â”‚   â”œâ”€â”€ fu2-5.png
â”‚   â”œâ”€â”€ fu2-6.png
â”‚   â””â”€â”€ fu2-7.png
â”œâ”€â”€ gao/
â”‚   â”œâ”€â”€ gao-1.png
â”‚   â”œâ”€â”€ gao-2.png
â”‚   â”œâ”€â”€ gao-3.png
â”‚   â”œâ”€â”€ gao-4.png
â”‚   â”œâ”€â”€ gao-5.png
â”‚   â”œâ”€â”€ gao-6.png
â”‚   â””â”€â”€ gao-7.png
â”œâ”€â”€ gong/
â”‚   â”œâ”€â”€ gong-1.png
â”‚   â”œâ”€â”€ gong-2.png
â”‚   â”œâ”€â”€ gong-3.png
â”‚   â”œâ”€â”€ gong-4.png
â”‚   â”œâ”€â”€ gong-5.png
â”‚   â”œâ”€â”€ gong-6.png
â”‚   â””â”€â”€ gong-7.png
â”œâ”€â”€ guo/
â”‚   â”œâ”€â”€ guo-1.png
â”‚   â”œâ”€â”€ guo-2.png
â”‚   â”œâ”€â”€ guo-3.png
â”‚   â”œâ”€â”€ guo-4.png
â”‚   â”œâ”€â”€ guo-5.png
â”‚   â”œâ”€â”€ guo-6.png
â”‚   â””â”€â”€ guo-7.png
â”œâ”€â”€ hu/
â”‚   â”œâ”€â”€ hu-1.png
â”‚   â”œâ”€â”€ hu-2.png
â”‚   â”œâ”€â”€ hu-3.png
â”‚   â”œâ”€â”€ hu-4.png
â”‚   â”œâ”€â”€ hu-5.png
â”‚   â”œâ”€â”€ hu-6.png
â”‚   â””â”€â”€ hu-7.png
â”œâ”€â”€ huo/
â”‚   â”œâ”€â”€ huo-1.png
â”‚   â”œâ”€â”€ huo-2.png
â”‚   â”œâ”€â”€ huo-3.png
â”‚   â”œâ”€â”€ huo-4.png
â”‚   â”œâ”€â”€ huo-5.png
â”‚   â”œâ”€â”€ huo-6.png
â”‚   â””â”€â”€ huo-7.png
â”œâ”€â”€ kou/
â”‚   â”œâ”€â”€ kou-1.png
â”‚   â”œâ”€â”€ kou-2.png
â”‚   â”œâ”€â”€ kou-3.png
â”‚   â”œâ”€â”€ kou-4.png
â”‚   â”œâ”€â”€ kou-5.png
â”‚   â”œâ”€â”€ kou-6.png
â”‚   â””â”€â”€ kou-7.png
â”œâ”€â”€ ku/
â”‚   â”œâ”€â”€ ku-1.png
â”‚   â”œâ”€â”€ ku-2.png
â”‚   â”œâ”€â”€ ku-3.png
â”‚   â”œâ”€â”€ ku-4.png
â”‚   â”œâ”€â”€ ku-5.png
â”‚   â”œâ”€â”€ ku-6.png
â”‚   â””â”€â”€ ku-7.png
â”œâ”€â”€ lin/
â”‚   â”œâ”€â”€ lin-1.png
â”‚   â”œâ”€â”€ lin-2.png
â”‚   â”œâ”€â”€ lin-3.png
â”‚   â”œâ”€â”€ lin-4.png
â”‚   â”œâ”€â”€ lin-5.png
â”‚   â”œâ”€â”€ lin-6.png
â”‚   â””â”€â”€ lin-7.png
â”œâ”€â”€ ma/
â”‚   â”œâ”€â”€ ma-1.png
â”‚   â”œâ”€â”€ ma-2.png
â”‚   â”œâ”€â”€ ma-3.png
â”‚   â”œâ”€â”€ ma-4.png
â”‚   â”œâ”€â”€ ma-5.png
â”‚   â”œâ”€â”€ ma-6.png
â”‚   â””â”€â”€ ma-7.png
â”œâ”€â”€ ma2/
â”‚   â”œâ”€â”€ ma2-1.png
â”‚   â”œâ”€â”€ ma2-2.png
â”‚   â”œâ”€â”€ ma2-3.png
â”‚   â”œâ”€â”€ ma2-4.png
â”‚   â”œâ”€â”€ ma2-5.png
â”‚   â”œâ”€â”€ ma2-6.png
â”‚   â””â”€â”€ ma2-7.png
â”œâ”€â”€ ma3/
â”‚   â”œâ”€â”€ ma3-1.png
â”‚   â”œâ”€â”€ ma3-2.png
â”‚   â”œâ”€â”€ ma3-3.png
â”‚   â”œâ”€â”€ ma3-4.png
â”‚   â”œâ”€â”€ ma3-5.png
â”‚   â”œâ”€â”€ ma3-6.png
â”‚   â””â”€â”€ ma3-7.png
â”œâ”€â”€ mei/
â”‚   â”œâ”€â”€ mei-1.png
â”‚   â”œâ”€â”€ mei-2.png
â”‚   â”œâ”€â”€ mei-3.png
â”‚   â”œâ”€â”€ mei-4.png
â”‚   â”œâ”€â”€ mei-5.png
â”‚   â”œâ”€â”€ mei-6.png
â”‚   â””â”€â”€ mei-7.png
â”œâ”€â”€ men/
â”‚   â”œâ”€â”€ men-1.png
â”‚   â”œâ”€â”€ men-2.png
â”‚   â”œâ”€â”€ men-3.png
â”‚   â”œâ”€â”€ men-4.png
â”‚   â”œâ”€â”€ men-5.png
â”‚   â”œâ”€â”€ men-6.png
â”‚   â””â”€â”€ men-7.png
â”œâ”€â”€ ming/
â”‚   â”œâ”€â”€ ming-1.png
â”‚   â”œâ”€â”€ ming-2.png
â”‚   â”œâ”€â”€ ming-3.png
â”‚   â”œâ”€â”€ ming-4.png
â”‚   â”œâ”€â”€ ming-5.png
â”‚   â”œâ”€â”€ ming-6.png
â”‚   â””â”€â”€ ming-7.png
â”œâ”€â”€ mu/
â”‚   â”œâ”€â”€ mu-1.png
â”‚   â”œâ”€â”€ mu-2.png
â”‚   â”œâ”€â”€ mu-3.png
â”‚   â”œâ”€â”€ mu-4.png
â”‚   â”œâ”€â”€ mu-5.png
â”‚   â”œâ”€â”€ mu-6.png
â”‚   â””â”€â”€ mu-7.png
â”œâ”€â”€ nan/
â”‚   â”œâ”€â”€ nan-1.png
â”‚   â”œâ”€â”€ nan-2.png
â”‚   â”œâ”€â”€ nan-3.png
â”‚   â”œâ”€â”€ nan-4.png
â”‚   â”œâ”€â”€ nan-5.png
â”‚   â”œâ”€â”€ nan-6.png
â”‚   â””â”€â”€ nan-7.png
â”œâ”€â”€ niao/
â”‚   â”œâ”€â”€ niao-1.png
â”‚   â”œâ”€â”€ niao-2.png
â”‚   â”œâ”€â”€ niao-3.png
â”‚   â”œâ”€â”€ niao-4.png
â”‚   â”œâ”€â”€ niao-5.png
â”‚   â”œâ”€â”€ niao-6.png
â”‚   â””â”€â”€ niao-7.png
â”œâ”€â”€ niu/
â”‚   â”œâ”€â”€ niu-1.png
â”‚   â”œâ”€â”€ niu-2.png
â”‚   â”œâ”€â”€ niu-3.png
â”‚   â”œâ”€â”€ niu-4.png
â”‚   â”œâ”€â”€ niu-5.png
â”‚   â”œâ”€â”€ niu-6.png
â”‚   â””â”€â”€ niu-7.png
â”œâ”€â”€ nu/
â”‚   â”œâ”€â”€ nu-1.png
â”‚   â”œâ”€â”€ nu-2.png
â”‚   â”œâ”€â”€ nu-3.png
â”‚   â”œâ”€â”€ nu-4.png
â”‚   â”œâ”€â”€ nu-5.png
â”‚   â”œâ”€â”€ nu-6.png
â”‚   â””â”€â”€ nu-7.png
â”œâ”€â”€ nuan/
â”‚   â”œâ”€â”€ nuan-1.png
â”‚   â”œâ”€â”€ nuan-2.png
â”‚   â”œâ”€â”€ nuan-3.png
â”‚   â”œâ”€â”€ nuan-4.png
â”‚   â”œâ”€â”€ nuan-5.png
â”‚   â”œâ”€â”€ nuan-6.png
â”‚   â””â”€â”€ nuan-7.png
â”œâ”€â”€ peng/
â”‚   â”œâ”€â”€ peng-1.png
â”‚   â”œâ”€â”€ peng-2.png
â”‚   â”œâ”€â”€ peng-3.png
â”‚   â”œâ”€â”€ peng-4.png
â”‚   â”œâ”€â”€ peng-5.png
â”‚   â”œâ”€â”€ peng-6.png
â”‚   â””â”€â”€ peng-7.png
â”œâ”€â”€ quan/
â”‚   â”œâ”€â”€ quan-1.png
â”‚   â”œâ”€â”€ quan-2.png
â”‚   â”œâ”€â”€ quan-3.png
â”‚   â”œâ”€â”€ quan-4.png
â”‚   â”œâ”€â”€ quan-5.png
â”‚   â”œâ”€â”€ quan-6.png
â”‚   â””â”€â”€ quan-7.png
â”œâ”€â”€ ren/
â”‚   â”œâ”€â”€ ren-1.png
â”‚   â”œâ”€â”€ ren-2.png
â”‚   â”œâ”€â”€ ren-3.png
â”‚   â”œâ”€â”€ ren-4.png
â”‚   â”œâ”€â”€ ren-5.png
â”‚   â”œâ”€â”€ ren-6.png
â”‚   â””â”€â”€ ren-7.png
â”œâ”€â”€ ri/
â”‚   â”œâ”€â”€ ri-1.png
â”‚   â”œâ”€â”€ ri-2.png
â”‚   â”œâ”€â”€ ri-3.png
â”‚   â”œâ”€â”€ ri-4.png
â”‚   â”œâ”€â”€ ri-5.png
â”‚   â”œâ”€â”€ ri-6.png
â”‚   â””â”€â”€ ri-7.png
â”œâ”€â”€ rou/
â”‚   â”œâ”€â”€ rou-1.png
â”‚   â”œâ”€â”€ rou-2.png
â”‚   â”œâ”€â”€ rou-3.png
â”‚   â”œâ”€â”€ rou-4.png
â”‚   â”œâ”€â”€ rou-5.png
â”‚   â”œâ”€â”€ rou-6.png
â”‚   â””â”€â”€ rou-7.png
â”œâ”€â”€ sen/
â”‚   â”œâ”€â”€ sen-1.png
â”‚   â”œâ”€â”€ sen-2.png
â”‚   â”œâ”€â”€ sen-3.png
â”‚   â”œâ”€â”€ sen-4.png
â”‚   â”œâ”€â”€ sen-5.png
â”‚   â”œâ”€â”€ sen-6.png
â”‚   â””â”€â”€ sen-7.png
â”œâ”€â”€ shan/
â”‚   â”œâ”€â”€ shan-1.png
â”‚   â”œâ”€â”€ shan-2.png
â”‚   â”œâ”€â”€ shan-3.png
â”‚   â”œâ”€â”€ shan-4.png
â”‚   â”œâ”€â”€ shan-5.png
â”‚   â”œâ”€â”€ shan-6.png
â”‚   â””â”€â”€ shan-7.png
â”œâ”€â”€ shan2/
â”‚   â”œâ”€â”€ shan2-1.png
â”‚   â”œâ”€â”€ shan2-2.png
â”‚   â”œâ”€â”€ shan2-3.png
â”‚   â”œâ”€â”€ shan2-4.png
â”‚   â”œâ”€â”€ shan2-5.png
â”‚   â”œâ”€â”€ shan2-6.png
â”‚   â””â”€â”€ shan2-7.png
â”œâ”€â”€ shui/
â”‚   â”œâ”€â”€ shui-1.png
â”‚   â”œâ”€â”€ shui-2.png
â”‚   â”œâ”€â”€ shui-3.png
â”‚   â”œâ”€â”€ shui-4.png
â”‚   â”œâ”€â”€ shui-5.png
â”‚   â”œâ”€â”€ shui-6.png
â”‚   â””â”€â”€ shui-7.png
â”œâ”€â”€ tai/
â”‚   â”œâ”€â”€ tai-1.png
â”‚   â”œâ”€â”€ tai-2.png
â”‚   â”œâ”€â”€ tai-3.png
â”‚   â”œâ”€â”€ tai-4.png
â”‚   â”œâ”€â”€ tai-5.png
â”‚   â”œâ”€â”€ tai-6.png
â”‚   â””â”€â”€ tai-7.png
â”œâ”€â”€ tian/
â”‚   â”œâ”€â”€ tian-1.png
â”‚   â”œâ”€â”€ tian-2.png
â”‚   â”œâ”€â”€ tian-3.png
â”‚   â”œâ”€â”€ tian-4.png
â”‚   â”œâ”€â”€ tian-5.png
â”‚   â”œâ”€â”€ tian-6.png
â”‚   â””â”€â”€ tian-7.png
â”œâ”€â”€ wang/
â”‚   â”œâ”€â”€ wang-1.png
â”‚   â”œâ”€â”€ wang-2.png
â”‚   â”œâ”€â”€ wang-3.png
â”‚   â”œâ”€â”€ wang-4.png
â”‚   â”œâ”€â”€ wang-5.png
â”‚   â”œâ”€â”€ wang-6.png
â”‚   â””â”€â”€ wang-7.png
â”œâ”€â”€ wen/
â”‚   â”œâ”€â”€ wen-1.png
â”‚   â”œâ”€â”€ wen-2.png
â”‚   â”œâ”€â”€ wen-3.png
â”‚   â”œâ”€â”€ wen-4.png
â”‚   â”œâ”€â”€ wen-5.png
â”‚   â”œâ”€â”€ wen-6.png
â”‚   â””â”€â”€ wen-7.png
â”œâ”€â”€ xian/
â”‚   â”œâ”€â”€ xian-1.png
â”‚   â”œâ”€â”€ xian-2.png
â”‚   â”œâ”€â”€ xian-3.png
â”‚   â”œâ”€â”€ xian-4.png
â”‚   â”œâ”€â”€ xian-5.png
â”‚   â”œâ”€â”€ xian-6.png
â”‚   â””â”€â”€ xian-7.png
â”œâ”€â”€ xuan/
â”‚   â”œâ”€â”€ xuan-1.png
â”‚   â”œâ”€â”€ xuan-2.png
â”‚   â”œâ”€â”€ xuan-3.png
â”‚   â”œâ”€â”€ xuan-4.png
â”‚   â”œâ”€â”€ xuan-5.png
â”‚   â”œâ”€â”€ xuan-6.png
â”‚   â””â”€â”€ xuan-7.png
â”œâ”€â”€ yan/
â”‚   â”œâ”€â”€ yan-1.png
â”‚   â”œâ”€â”€ yan-2.png
â”‚   â”œâ”€â”€ yan-3.png
â”‚   â”œâ”€â”€ yan-4.png
â”‚   â”œâ”€â”€ yan-5.png
â”‚   â”œâ”€â”€ yan-6.png
â”‚   â””â”€â”€ yan-7.png
â”œâ”€â”€ yang/
â”‚   â”œâ”€â”€ yang-1.png
â”‚   â”œâ”€â”€ yang-2.png
â”‚   â”œâ”€â”€ yang-3.png
â”‚   â”œâ”€â”€ yang-4.png
â”‚   â”œâ”€â”€ yang-5.png
â”‚   â”œâ”€â”€ yang-6.png
â”‚   â””â”€â”€ yang-7.png
â”œâ”€â”€ yin/
â”‚   â”œâ”€â”€ yin-1.png
â”‚   â”œâ”€â”€ yin-2.png
â”‚   â”œâ”€â”€ yin-3.png
â”‚   â”œâ”€â”€ yin-4.png
â”‚   â”œâ”€â”€ yin-5.png
â”‚   â”œâ”€â”€ yin-6.png
â”‚   â””â”€â”€ yin-7.png
â”œâ”€â”€ yu/
â”‚   â”œâ”€â”€ yu-1.png
â”‚   â”œâ”€â”€ yu-2.png
â”‚   â”œâ”€â”€ yu-3.png
â”‚   â”œâ”€â”€ yu-4.png
â”‚   â”œâ”€â”€ yu-5.png
â”‚   â”œâ”€â”€ yu-6.png
â”‚   â””â”€â”€ yu-7.png
â”œâ”€â”€ yu2/
â”‚   â”œâ”€â”€ yu2-1.png
â”‚   â”œâ”€â”€ yu2-2.png
â”‚   â”œâ”€â”€ yu2-3.png
â”‚   â”œâ”€â”€ yu2-4.png
â”‚   â”œâ”€â”€ yu2-5.png
â”‚   â”œâ”€â”€ yu2-6.png
â”‚   â””â”€â”€ yu2-7.png
â”œâ”€â”€ yue/
â”‚   â”œâ”€â”€ yue-1.png
â”‚   â”œâ”€â”€ yue-2.png
â”‚   â”œâ”€â”€ yue-3.png
â”‚   â”œâ”€â”€ yue-4.png
â”‚   â”œâ”€â”€ yue-5.png
â”‚   â”œâ”€â”€ yue-6.png
â”‚   â””â”€â”€ yue-7.png
â”œâ”€â”€ zhong/
â”‚   â”œâ”€â”€ zhong-1.png
â”‚   â”œâ”€â”€ zhong-2.png
â”‚   â”œâ”€â”€ zhong-3.png
â”‚   â”œâ”€â”€ zhong-4.png
â”‚   â”œâ”€â”€ zhong-5.png
â”‚   â”œâ”€â”€ zhong-6.png
â”‚   â””â”€â”€ zhong-7.png
â”œâ”€â”€ zhu/
â”‚   â”œâ”€â”€ zhu-1.png
â”‚   â”œâ”€â”€ zhu-2.png
â”‚   â”œâ”€â”€ zhu-3.png
â”‚   â”œâ”€â”€ zhu-4.png
â”‚   â”œâ”€â”€ zhu-5.png
â”‚   â”œâ”€â”€ zhu-6.png
â”‚   â””â”€â”€ zhu-7.png
â”œâ”€â”€ zhu2/
â”‚   â”œâ”€â”€ zhu2-1.png
â”‚   â”œâ”€â”€ zhu2-2.png
â”‚   â”œâ”€â”€ zhu2-3.png
â”‚   â”œâ”€â”€ zhu2-4.png
â”‚   â”œâ”€â”€ zhu2-5.png
â”‚   â”œâ”€â”€ zhu2-6.png
â”‚   â””â”€â”€ zhu2-7.png
â””â”€â”€ zhuo/
    â”œâ”€â”€ zhuo-1.png
    â”œâ”€â”€ zhuo-2.png
    â”œâ”€â”€ zhuo-3.png
    â”œâ”€â”€ zhuo-4.png
    â”œâ”€â”€ zhuo-5.png
    â”œâ”€â”€ zhuo-6.png
    â””â”€â”€ zhuo-7.png</code></pre>
</div>
</div>
</div><div class="column">
<div id="9dcb323d" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a></a>tree <span class="op">=</span> display_tree(<span class="st">"mandarin"</span>, string_rep<span class="op">=</span><span class="va">True</span>).split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb28-2"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tree[:<span class="dv">12</span>]))</span>
<span id="cb28-3"><a></a><span class="bu">print</span>(<span class="st">"..."</span>)</span>
<span id="cb28-4"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(tree[<span class="op">-</span><span class="dv">4</span>:]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin/
â”œâ”€â”€ bai/
â”‚   â”œâ”€â”€ bai-1.png
â”‚   â”œâ”€â”€ bai-2.png
â”‚   â”œâ”€â”€ bai-3.png
â”‚   â”œâ”€â”€ bai-4.png
â”‚   â”œâ”€â”€ bai-5.png
â”‚   â”œâ”€â”€ bai-6.png
â”‚   â””â”€â”€ bai-7.png
â”œâ”€â”€ ben/
â”‚   â”œâ”€â”€ ben-1.png
â”‚   â”œâ”€â”€ ben-2.png
...
    â”œâ”€â”€ zhuo-5.png
    â”œâ”€â”€ zhuo-6.png
    â””â”€â”€ zhuo-7.png
</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="splitting-into-trainvaltest-sets" class="slide level2">
<h2>Splitting into train/val/test sets</h2>
<div id="20b7f08b" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="op">!</span>pip install split<span class="op">-</span>folders</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ff5ede07" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a></a><span class="im">import</span> splitfolders</span>
<span id="cb31-2"><a></a>splitfolders.ratio(<span class="st">"mandarin"</span>, output<span class="op">=</span><span class="st">"mandarin-split"</span>,</span>
<span id="cb31-3"><a></a>    seed<span class="op">=</span><span class="dv">1337</span>, ratio<span class="op">=</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">7</span>))</span>
<span id="cb31-4"><a></a></span>
<span id="cb31-5"><a></a>display_tree(<span class="st">"mandarin-split"</span>, max_depth<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/
â”œâ”€â”€ test/
â”œâ”€â”€ train/
â””â”€â”€ val/</code></pre>
</div>
</div>
</section>
<section id="directory-structure-ii" class="slide level2">
<h2>Directory structure II</h2>
<div class="columns">
<div class="column">
<div id="b08538a1" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a></a>display_tree(<span class="st">"mandarin-split"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mandarin-split/
â”œâ”€â”€ test/
â”‚   â”œâ”€â”€ bai/
â”‚   â”‚   â””â”€â”€ bai-5.png
â”‚   â”œâ”€â”€ ben/
â”‚   â”‚   â””â”€â”€ ben-5.png
â”‚   â”œâ”€â”€ chong/
â”‚   â”‚   â””â”€â”€ chong-5.png
â”‚   â”œâ”€â”€ chu/
â”‚   â”‚   â””â”€â”€ chu-5.png
â”‚   â”œâ”€â”€ chuan/
â”‚   â”‚   â””â”€â”€ chuan-5.png
â”‚   â”œâ”€â”€ cong/
â”‚   â”‚   â””â”€â”€ cong-5.png
â”‚   â”œâ”€â”€ da/
â”‚   â”‚   â””â”€â”€ da-5.png
â”‚   â”œâ”€â”€ dan/
â”‚   â”‚   â””â”€â”€ dan-5.png
â”‚   â”œâ”€â”€ dong/
â”‚   â”‚   â””â”€â”€ dong-5.png
â”‚   â”œâ”€â”€ fei/
â”‚   â”‚   â””â”€â”€ fei-5.png
â”‚   â”œâ”€â”€ fu/
â”‚   â”‚   â””â”€â”€ fu-5.png
â”‚   â”œâ”€â”€ fu2/
â”‚   â”‚   â””â”€â”€ fu2-5.png
â”‚   â”œâ”€â”€ gao/
â”‚   â”‚   â””â”€â”€ gao-5.png
â”‚   â”œâ”€â”€ gong/
â”‚   â”‚   â””â”€â”€ gong-5.png
â”‚   â”œâ”€â”€ guo/
â”‚   â”‚   â””â”€â”€ guo-5.png
â”‚   â”œâ”€â”€ hu/
â”‚   â”‚   â””â”€â”€ hu-5.png
â”‚   â”œâ”€â”€ huo/
â”‚   â”‚   â””â”€â”€ huo-5.png
â”‚   â”œâ”€â”€ kou/
â”‚   â”‚   â””â”€â”€ kou-5.png
â”‚   â”œâ”€â”€ ku/
â”‚   â”‚   â””â”€â”€ ku-5.png
â”‚   â”œâ”€â”€ lin/
â”‚   â”‚   â””â”€â”€ lin-5.png
â”‚   â”œâ”€â”€ ma/
â”‚   â”‚   â””â”€â”€ ma-5.png
â”‚   â”œâ”€â”€ ma2/
â”‚   â”‚   â””â”€â”€ ma2-5.png
â”‚   â”œâ”€â”€ ma3/
â”‚   â”‚   â””â”€â”€ ma3-5.png
â”‚   â”œâ”€â”€ mei/
â”‚   â”‚   â””â”€â”€ mei-5.png
â”‚   â”œâ”€â”€ men/
â”‚   â”‚   â””â”€â”€ men-5.png
â”‚   â”œâ”€â”€ ming/
â”‚   â”‚   â””â”€â”€ ming-5.png
â”‚   â”œâ”€â”€ mu/
â”‚   â”‚   â””â”€â”€ mu-5.png
â”‚   â”œâ”€â”€ nan/
â”‚   â”‚   â””â”€â”€ nan-5.png
â”‚   â”œâ”€â”€ niao/
â”‚   â”‚   â””â”€â”€ niao-5.png
â”‚   â”œâ”€â”€ niu/
â”‚   â”‚   â””â”€â”€ niu-5.png
â”‚   â”œâ”€â”€ nu/
â”‚   â”‚   â””â”€â”€ nu-5.png
â”‚   â”œâ”€â”€ nuan/
â”‚   â”‚   â””â”€â”€ nuan-5.png
â”‚   â”œâ”€â”€ peng/
â”‚   â”‚   â””â”€â”€ peng-5.png
â”‚   â”œâ”€â”€ quan/
â”‚   â”‚   â””â”€â”€ quan-5.png
â”‚   â”œâ”€â”€ ren/
â”‚   â”‚   â””â”€â”€ ren-5.png
â”‚   â”œâ”€â”€ ri/
â”‚   â”‚   â””â”€â”€ ri-5.png
â”‚   â”œâ”€â”€ rou/
â”‚   â”‚   â””â”€â”€ rou-5.png
â”‚   â”œâ”€â”€ sen/
â”‚   â”‚   â””â”€â”€ sen-5.png
â”‚   â”œâ”€â”€ shan/
â”‚   â”‚   â””â”€â”€ shan-5.png
â”‚   â”œâ”€â”€ shan2/
â”‚   â”‚   â””â”€â”€ shan2-5.png
â”‚   â”œâ”€â”€ shui/
â”‚   â”‚   â””â”€â”€ shui-5.png
â”‚   â”œâ”€â”€ tai/
â”‚   â”‚   â””â”€â”€ tai-5.png
â”‚   â”œâ”€â”€ tian/
â”‚   â”‚   â””â”€â”€ tian-5.png
â”‚   â”œâ”€â”€ wang/
â”‚   â”‚   â””â”€â”€ wang-5.png
â”‚   â”œâ”€â”€ wen/
â”‚   â”‚   â””â”€â”€ wen-5.png
â”‚   â”œâ”€â”€ xian/
â”‚   â”‚   â””â”€â”€ xian-5.png
â”‚   â”œâ”€â”€ xuan/
â”‚   â”‚   â””â”€â”€ xuan-5.png
â”‚   â”œâ”€â”€ yan/
â”‚   â”‚   â””â”€â”€ yan-5.png
â”‚   â”œâ”€â”€ yang/
â”‚   â”‚   â””â”€â”€ yang-5.png
â”‚   â”œâ”€â”€ yin/
â”‚   â”‚   â””â”€â”€ yin-5.png
â”‚   â”œâ”€â”€ yu/
â”‚   â”‚   â””â”€â”€ yu-5.png
â”‚   â”œâ”€â”€ yu2/
â”‚   â”‚   â””â”€â”€ yu2-5.png
â”‚   â”œâ”€â”€ yue/
â”‚   â”‚   â””â”€â”€ yue-5.png
â”‚   â”œâ”€â”€ zhong/
â”‚   â”‚   â””â”€â”€ zhong-5.png
â”‚   â”œâ”€â”€ zhu/
â”‚   â”‚   â””â”€â”€ zhu-5.png
â”‚   â”œâ”€â”€ zhu2/
â”‚   â”‚   â””â”€â”€ zhu2-5.png
â”‚   â””â”€â”€ zhuo/
â”‚       â””â”€â”€ zhuo-5.png
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ bai/
â”‚   â”‚   â”œâ”€â”€ bai-1.png
â”‚   â”‚   â”œâ”€â”€ bai-2.png
â”‚   â”‚   â”œâ”€â”€ bai-3.png
â”‚   â”‚   â”œâ”€â”€ bai-4.png
â”‚   â”‚   â””â”€â”€ bai-6.png
â”‚   â”œâ”€â”€ ben/
â”‚   â”‚   â”œâ”€â”€ ben-1.png
â”‚   â”‚   â”œâ”€â”€ ben-2.png
â”‚   â”‚   â”œâ”€â”€ ben-3.png
â”‚   â”‚   â”œâ”€â”€ ben-4.png
â”‚   â”‚   â””â”€â”€ ben-6.png
â”‚   â”œâ”€â”€ chong/
â”‚   â”‚   â”œâ”€â”€ chong-1.png
â”‚   â”‚   â”œâ”€â”€ chong-2.png
â”‚   â”‚   â”œâ”€â”€ chong-3.png
â”‚   â”‚   â”œâ”€â”€ chong-4.png
â”‚   â”‚   â””â”€â”€ chong-6.png
â”‚   â”œâ”€â”€ chu/
â”‚   â”‚   â”œâ”€â”€ chu-1.png
â”‚   â”‚   â”œâ”€â”€ chu-2.png
â”‚   â”‚   â”œâ”€â”€ chu-3.png
â”‚   â”‚   â”œâ”€â”€ chu-4.png
â”‚   â”‚   â””â”€â”€ chu-6.png
â”‚   â”œâ”€â”€ chuan/
â”‚   â”‚   â”œâ”€â”€ chuan-1.png
â”‚   â”‚   â”œâ”€â”€ chuan-2.png
â”‚   â”‚   â”œâ”€â”€ chuan-3.png
â”‚   â”‚   â”œâ”€â”€ chuan-4.png
â”‚   â”‚   â””â”€â”€ chuan-6.png
â”‚   â”œâ”€â”€ cong/
â”‚   â”‚   â”œâ”€â”€ cong-1.png
â”‚   â”‚   â”œâ”€â”€ cong-2.png
â”‚   â”‚   â”œâ”€â”€ cong-3.png
â”‚   â”‚   â”œâ”€â”€ cong-4.png
â”‚   â”‚   â””â”€â”€ cong-6.png
â”‚   â”œâ”€â”€ da/
â”‚   â”‚   â”œâ”€â”€ da-1.png
â”‚   â”‚   â”œâ”€â”€ da-2.png
â”‚   â”‚   â”œâ”€â”€ da-3.png
â”‚   â”‚   â”œâ”€â”€ da-4.png
â”‚   â”‚   â””â”€â”€ da-6.png
â”‚   â”œâ”€â”€ dan/
â”‚   â”‚   â”œâ”€â”€ dan-1.png
â”‚   â”‚   â”œâ”€â”€ dan-2.png
â”‚   â”‚   â”œâ”€â”€ dan-3.png
â”‚   â”‚   â”œâ”€â”€ dan-4.png
â”‚   â”‚   â””â”€â”€ dan-6.png
â”‚   â”œâ”€â”€ dong/
â”‚   â”‚   â”œâ”€â”€ dong-1.png
â”‚   â”‚   â”œâ”€â”€ dong-2.png
â”‚   â”‚   â”œâ”€â”€ dong-3.png
â”‚   â”‚   â”œâ”€â”€ dong-4.png
â”‚   â”‚   â””â”€â”€ dong-6.png
â”‚   â”œâ”€â”€ fei/
â”‚   â”‚   â”œâ”€â”€ fei-1.png
â”‚   â”‚   â”œâ”€â”€ fei-2.png
â”‚   â”‚   â”œâ”€â”€ fei-3.png
â”‚   â”‚   â”œâ”€â”€ fei-4.png
â”‚   â”‚   â””â”€â”€ fei-6.png
â”‚   â”œâ”€â”€ fu/
â”‚   â”‚   â”œâ”€â”€ fu-1.png
â”‚   â”‚   â”œâ”€â”€ fu-2.png
â”‚   â”‚   â”œâ”€â”€ fu-3.png
â”‚   â”‚   â”œâ”€â”€ fu-4.png
â”‚   â”‚   â””â”€â”€ fu-6.png
â”‚   â”œâ”€â”€ fu2/
â”‚   â”‚   â”œâ”€â”€ fu2-1.png
â”‚   â”‚   â”œâ”€â”€ fu2-2.png
â”‚   â”‚   â”œâ”€â”€ fu2-3.png
â”‚   â”‚   â”œâ”€â”€ fu2-4.png
â”‚   â”‚   â””â”€â”€ fu2-6.png
â”‚   â”œâ”€â”€ gao/
â”‚   â”‚   â”œâ”€â”€ gao-1.png
â”‚   â”‚   â”œâ”€â”€ gao-2.png
â”‚   â”‚   â”œâ”€â”€ gao-3.png
â”‚   â”‚   â”œâ”€â”€ gao-4.png
â”‚   â”‚   â””â”€â”€ gao-6.png
â”‚   â”œâ”€â”€ gong/
â”‚   â”‚   â”œâ”€â”€ gong-1.png
â”‚   â”‚   â”œâ”€â”€ gong-2.png
â”‚   â”‚   â”œâ”€â”€ gong-3.png
â”‚   â”‚   â”œâ”€â”€ gong-4.png
â”‚   â”‚   â””â”€â”€ gong-6.png
â”‚   â”œâ”€â”€ guo/
â”‚   â”‚   â”œâ”€â”€ guo-1.png
â”‚   â”‚   â”œâ”€â”€ guo-2.png
â”‚   â”‚   â”œâ”€â”€ guo-3.png
â”‚   â”‚   â”œâ”€â”€ guo-4.png
â”‚   â”‚   â””â”€â”€ guo-6.png
â”‚   â”œâ”€â”€ hu/
â”‚   â”‚   â”œâ”€â”€ hu-1.png
â”‚   â”‚   â”œâ”€â”€ hu-2.png
â”‚   â”‚   â”œâ”€â”€ hu-3.png
â”‚   â”‚   â”œâ”€â”€ hu-4.png
â”‚   â”‚   â””â”€â”€ hu-6.png
â”‚   â”œâ”€â”€ huo/
â”‚   â”‚   â”œâ”€â”€ huo-1.png
â”‚   â”‚   â”œâ”€â”€ huo-2.png
â”‚   â”‚   â”œâ”€â”€ huo-3.png
â”‚   â”‚   â”œâ”€â”€ huo-4.png
â”‚   â”‚   â””â”€â”€ huo-6.png
â”‚   â”œâ”€â”€ kou/
â”‚   â”‚   â”œâ”€â”€ kou-1.png
â”‚   â”‚   â”œâ”€â”€ kou-2.png
â”‚   â”‚   â”œâ”€â”€ kou-3.png
â”‚   â”‚   â”œâ”€â”€ kou-4.png
â”‚   â”‚   â””â”€â”€ kou-6.png
â”‚   â”œâ”€â”€ ku/
â”‚   â”‚   â”œâ”€â”€ ku-1.png
â”‚   â”‚   â”œâ”€â”€ ku-2.png
â”‚   â”‚   â”œâ”€â”€ ku-3.png
â”‚   â”‚   â”œâ”€â”€ ku-4.png
â”‚   â”‚   â””â”€â”€ ku-6.png
â”‚   â”œâ”€â”€ lin/
â”‚   â”‚   â”œâ”€â”€ lin-1.png
â”‚   â”‚   â”œâ”€â”€ lin-2.png
â”‚   â”‚   â”œâ”€â”€ lin-3.png
â”‚   â”‚   â”œâ”€â”€ lin-4.png
â”‚   â”‚   â””â”€â”€ lin-6.png
â”‚   â”œâ”€â”€ ma/
â”‚   â”‚   â”œâ”€â”€ ma-1.png
â”‚   â”‚   â”œâ”€â”€ ma-2.png
â”‚   â”‚   â”œâ”€â”€ ma-3.png
â”‚   â”‚   â”œâ”€â”€ ma-4.png
â”‚   â”‚   â””â”€â”€ ma-6.png
â”‚   â”œâ”€â”€ ma2/
â”‚   â”‚   â”œâ”€â”€ ma2-1.png
â”‚   â”‚   â”œâ”€â”€ ma2-2.png
â”‚   â”‚   â”œâ”€â”€ ma2-3.png
â”‚   â”‚   â”œâ”€â”€ ma2-4.png
â”‚   â”‚   â””â”€â”€ ma2-6.png
â”‚   â”œâ”€â”€ ma3/
â”‚   â”‚   â”œâ”€â”€ ma3-1.png
â”‚   â”‚   â”œâ”€â”€ ma3-2.png
â”‚   â”‚   â”œâ”€â”€ ma3-3.png
â”‚   â”‚   â”œâ”€â”€ ma3-4.png
â”‚   â”‚   â””â”€â”€ ma3-6.png
â”‚   â”œâ”€â”€ mei/
â”‚   â”‚   â”œâ”€â”€ mei-1.png
â”‚   â”‚   â”œâ”€â”€ mei-2.png
â”‚   â”‚   â”œâ”€â”€ mei-3.png
â”‚   â”‚   â”œâ”€â”€ mei-4.png
â”‚   â”‚   â””â”€â”€ mei-6.png
â”‚   â”œâ”€â”€ men/
â”‚   â”‚   â”œâ”€â”€ men-1.png
â”‚   â”‚   â”œâ”€â”€ men-2.png
â”‚   â”‚   â”œâ”€â”€ men-3.png
â”‚   â”‚   â”œâ”€â”€ men-4.png
â”‚   â”‚   â””â”€â”€ men-6.png
â”‚   â”œâ”€â”€ ming/
â”‚   â”‚   â”œâ”€â”€ ming-1.png
â”‚   â”‚   â”œâ”€â”€ ming-2.png
â”‚   â”‚   â”œâ”€â”€ ming-3.png
â”‚   â”‚   â”œâ”€â”€ ming-4.png
â”‚   â”‚   â””â”€â”€ ming-6.png
â”‚   â”œâ”€â”€ mu/
â”‚   â”‚   â”œâ”€â”€ mu-1.png
â”‚   â”‚   â”œâ”€â”€ mu-2.png
â”‚   â”‚   â”œâ”€â”€ mu-3.png
â”‚   â”‚   â”œâ”€â”€ mu-4.png
â”‚   â”‚   â””â”€â”€ mu-6.png
â”‚   â”œâ”€â”€ nan/
â”‚   â”‚   â”œâ”€â”€ nan-1.png
â”‚   â”‚   â”œâ”€â”€ nan-2.png
â”‚   â”‚   â”œâ”€â”€ nan-3.png
â”‚   â”‚   â”œâ”€â”€ nan-4.png
â”‚   â”‚   â””â”€â”€ nan-6.png
â”‚   â”œâ”€â”€ niao/
â”‚   â”‚   â”œâ”€â”€ niao-1.png
â”‚   â”‚   â”œâ”€â”€ niao-2.png
â”‚   â”‚   â”œâ”€â”€ niao-3.png
â”‚   â”‚   â”œâ”€â”€ niao-4.png
â”‚   â”‚   â””â”€â”€ niao-6.png
â”‚   â”œâ”€â”€ niu/
â”‚   â”‚   â”œâ”€â”€ niu-1.png
â”‚   â”‚   â”œâ”€â”€ niu-2.png
â”‚   â”‚   â”œâ”€â”€ niu-3.png
â”‚   â”‚   â”œâ”€â”€ niu-4.png
â”‚   â”‚   â””â”€â”€ niu-6.png
â”‚   â”œâ”€â”€ nu/
â”‚   â”‚   â”œâ”€â”€ nu-1.png
â”‚   â”‚   â”œâ”€â”€ nu-2.png
â”‚   â”‚   â”œâ”€â”€ nu-3.png
â”‚   â”‚   â”œâ”€â”€ nu-4.png
â”‚   â”‚   â””â”€â”€ nu-6.png
â”‚   â”œâ”€â”€ nuan/
â”‚   â”‚   â”œâ”€â”€ nuan-1.png
â”‚   â”‚   â”œâ”€â”€ nuan-2.png
â”‚   â”‚   â”œâ”€â”€ nuan-3.png
â”‚   â”‚   â”œâ”€â”€ nuan-4.png
â”‚   â”‚   â””â”€â”€ nuan-6.png
â”‚   â”œâ”€â”€ peng/
â”‚   â”‚   â”œâ”€â”€ peng-1.png
â”‚   â”‚   â”œâ”€â”€ peng-2.png
â”‚   â”‚   â”œâ”€â”€ peng-3.png
â”‚   â”‚   â”œâ”€â”€ peng-4.png
â”‚   â”‚   â””â”€â”€ peng-6.png
â”‚   â”œâ”€â”€ quan/
â”‚   â”‚   â”œâ”€â”€ quan-1.png
â”‚   â”‚   â”œâ”€â”€ quan-2.png
â”‚   â”‚   â”œâ”€â”€ quan-3.png
â”‚   â”‚   â”œâ”€â”€ quan-4.png
â”‚   â”‚   â””â”€â”€ quan-6.png
â”‚   â”œâ”€â”€ ren/
â”‚   â”‚   â”œâ”€â”€ ren-1.png
â”‚   â”‚   â”œâ”€â”€ ren-2.png
â”‚   â”‚   â”œâ”€â”€ ren-3.png
â”‚   â”‚   â”œâ”€â”€ ren-4.png
â”‚   â”‚   â””â”€â”€ ren-6.png
â”‚   â”œâ”€â”€ ri/
â”‚   â”‚   â”œâ”€â”€ ri-1.png
â”‚   â”‚   â”œâ”€â”€ ri-2.png
â”‚   â”‚   â”œâ”€â”€ ri-3.png
â”‚   â”‚   â”œâ”€â”€ ri-4.png
â”‚   â”‚   â””â”€â”€ ri-6.png
â”‚   â”œâ”€â”€ rou/
â”‚   â”‚   â”œâ”€â”€ rou-1.png
â”‚   â”‚   â”œâ”€â”€ rou-2.png
â”‚   â”‚   â”œâ”€â”€ rou-3.png
â”‚   â”‚   â”œâ”€â”€ rou-4.png
â”‚   â”‚   â””â”€â”€ rou-6.png
â”‚   â”œâ”€â”€ sen/
â”‚   â”‚   â”œâ”€â”€ sen-1.png
â”‚   â”‚   â”œâ”€â”€ sen-2.png
â”‚   â”‚   â”œâ”€â”€ sen-3.png
â”‚   â”‚   â”œâ”€â”€ sen-4.png
â”‚   â”‚   â””â”€â”€ sen-6.png
â”‚   â”œâ”€â”€ shan/
â”‚   â”‚   â”œâ”€â”€ shan-1.png
â”‚   â”‚   â”œâ”€â”€ shan-2.png
â”‚   â”‚   â”œâ”€â”€ shan-3.png
â”‚   â”‚   â”œâ”€â”€ shan-4.png
â”‚   â”‚   â””â”€â”€ shan-6.png
â”‚   â”œâ”€â”€ shan2/
â”‚   â”‚   â”œâ”€â”€ shan2-1.png
â”‚   â”‚   â”œâ”€â”€ shan2-2.png
â”‚   â”‚   â”œâ”€â”€ shan2-3.png
â”‚   â”‚   â”œâ”€â”€ shan2-4.png
â”‚   â”‚   â””â”€â”€ shan2-6.png
â”‚   â”œâ”€â”€ shui/
â”‚   â”‚   â”œâ”€â”€ shui-1.png
â”‚   â”‚   â”œâ”€â”€ shui-2.png
â”‚   â”‚   â”œâ”€â”€ shui-3.png
â”‚   â”‚   â”œâ”€â”€ shui-4.png
â”‚   â”‚   â””â”€â”€ shui-6.png
â”‚   â”œâ”€â”€ tai/
â”‚   â”‚   â”œâ”€â”€ tai-1.png
â”‚   â”‚   â”œâ”€â”€ tai-2.png
â”‚   â”‚   â”œâ”€â”€ tai-3.png
â”‚   â”‚   â”œâ”€â”€ tai-4.png
â”‚   â”‚   â””â”€â”€ tai-6.png
â”‚   â”œâ”€â”€ tian/
â”‚   â”‚   â”œâ”€â”€ tian-1.png
â”‚   â”‚   â”œâ”€â”€ tian-2.png
â”‚   â”‚   â”œâ”€â”€ tian-3.png
â”‚   â”‚   â”œâ”€â”€ tian-4.png
â”‚   â”‚   â””â”€â”€ tian-6.png
â”‚   â”œâ”€â”€ wang/
â”‚   â”‚   â”œâ”€â”€ wang-1.png
â”‚   â”‚   â”œâ”€â”€ wang-2.png
â”‚   â”‚   â”œâ”€â”€ wang-3.png
â”‚   â”‚   â”œâ”€â”€ wang-4.png
â”‚   â”‚   â””â”€â”€ wang-6.png
â”‚   â”œâ”€â”€ wen/
â”‚   â”‚   â”œâ”€â”€ wen-1.png
â”‚   â”‚   â”œâ”€â”€ wen-2.png
â”‚   â”‚   â”œâ”€â”€ wen-3.png
â”‚   â”‚   â”œâ”€â”€ wen-4.png
â”‚   â”‚   â””â”€â”€ wen-6.png
â”‚   â”œâ”€â”€ xian/
â”‚   â”‚   â”œâ”€â”€ xian-1.png
â”‚   â”‚   â”œâ”€â”€ xian-2.png
â”‚   â”‚   â”œâ”€â”€ xian-3.png
â”‚   â”‚   â”œâ”€â”€ xian-4.png
â”‚   â”‚   â””â”€â”€ xian-6.png
â”‚   â”œâ”€â”€ xuan/
â”‚   â”‚   â”œâ”€â”€ xuan-1.png
â”‚   â”‚   â”œâ”€â”€ xuan-2.png
â”‚   â”‚   â”œâ”€â”€ xuan-3.png
â”‚   â”‚   â”œâ”€â”€ xuan-4.png
â”‚   â”‚   â””â”€â”€ xuan-6.png
â”‚   â”œâ”€â”€ yan/
â”‚   â”‚   â”œâ”€â”€ yan-1.png
â”‚   â”‚   â”œâ”€â”€ yan-2.png
â”‚   â”‚   â”œâ”€â”€ yan-3.png
â”‚   â”‚   â”œâ”€â”€ yan-4.png
â”‚   â”‚   â””â”€â”€ yan-6.png
â”‚   â”œâ”€â”€ yang/
â”‚   â”‚   â”œâ”€â”€ yang-1.png
â”‚   â”‚   â”œâ”€â”€ yang-2.png
â”‚   â”‚   â”œâ”€â”€ yang-3.png
â”‚   â”‚   â”œâ”€â”€ yang-4.png
â”‚   â”‚   â””â”€â”€ yang-6.png
â”‚   â”œâ”€â”€ yin/
â”‚   â”‚   â”œâ”€â”€ yin-1.png
â”‚   â”‚   â”œâ”€â”€ yin-2.png
â”‚   â”‚   â”œâ”€â”€ yin-3.png
â”‚   â”‚   â”œâ”€â”€ yin-4.png
â”‚   â”‚   â””â”€â”€ yin-6.png
â”‚   â”œâ”€â”€ yu/
â”‚   â”‚   â”œâ”€â”€ yu-1.png
â”‚   â”‚   â”œâ”€â”€ yu-2.png
â”‚   â”‚   â”œâ”€â”€ yu-3.png
â”‚   â”‚   â”œâ”€â”€ yu-4.png
â”‚   â”‚   â””â”€â”€ yu-6.png
â”‚   â”œâ”€â”€ yu2/
â”‚   â”‚   â”œâ”€â”€ yu2-1.png
â”‚   â”‚   â”œâ”€â”€ yu2-2.png
â”‚   â”‚   â”œâ”€â”€ yu2-3.png
â”‚   â”‚   â”œâ”€â”€ yu2-4.png
â”‚   â”‚   â””â”€â”€ yu2-6.png
â”‚   â”œâ”€â”€ yue/
â”‚   â”‚   â”œâ”€â”€ yue-1.png
â”‚   â”‚   â”œâ”€â”€ yue-2.png
â”‚   â”‚   â”œâ”€â”€ yue-3.png
â”‚   â”‚   â”œâ”€â”€ yue-4.png
â”‚   â”‚   â””â”€â”€ yue-6.png
â”‚   â”œâ”€â”€ zhong/
â”‚   â”‚   â”œâ”€â”€ zhong-1.png
â”‚   â”‚   â”œâ”€â”€ zhong-2.png
â”‚   â”‚   â”œâ”€â”€ zhong-3.png
â”‚   â”‚   â”œâ”€â”€ zhong-4.png
â”‚   â”‚   â””â”€â”€ zhong-6.png
â”‚   â”œâ”€â”€ zhu/
â”‚   â”‚   â”œâ”€â”€ zhu-1.png
â”‚   â”‚   â”œâ”€â”€ zhu-2.png
â”‚   â”‚   â”œâ”€â”€ zhu-3.png
â”‚   â”‚   â”œâ”€â”€ zhu-4.png
â”‚   â”‚   â””â”€â”€ zhu-6.png
â”‚   â”œâ”€â”€ zhu2/
â”‚   â”‚   â”œâ”€â”€ zhu2-1.png
â”‚   â”‚   â”œâ”€â”€ zhu2-2.png
â”‚   â”‚   â”œâ”€â”€ zhu2-3.png
â”‚   â”‚   â”œâ”€â”€ zhu2-4.png
â”‚   â”‚   â””â”€â”€ zhu2-6.png
â”‚   â””â”€â”€ zhuo/
â”‚       â”œâ”€â”€ zhuo-1.png
â”‚       â”œâ”€â”€ zhuo-2.png
â”‚       â”œâ”€â”€ zhuo-3.png
â”‚       â”œâ”€â”€ zhuo-4.png
â”‚       â””â”€â”€ zhuo-6.png
â””â”€â”€ val/
    â”œâ”€â”€ bai/
    â”‚   â””â”€â”€ bai-7.png
    â”œâ”€â”€ ben/
    â”‚   â””â”€â”€ ben-7.png
    â”œâ”€â”€ chong/
    â”‚   â””â”€â”€ chong-7.png
    â”œâ”€â”€ chu/
    â”‚   â””â”€â”€ chu-7.png
    â”œâ”€â”€ chuan/
    â”‚   â””â”€â”€ chuan-7.png
    â”œâ”€â”€ cong/
    â”‚   â””â”€â”€ cong-7.png
    â”œâ”€â”€ da/
    â”‚   â””â”€â”€ da-7.png
    â”œâ”€â”€ dan/
    â”‚   â””â”€â”€ dan-7.png
    â”œâ”€â”€ dong/
    â”‚   â””â”€â”€ dong-7.png
    â”œâ”€â”€ fei/
    â”‚   â””â”€â”€ fei-7.png
    â”œâ”€â”€ fu/
    â”‚   â””â”€â”€ fu-7.png
    â”œâ”€â”€ fu2/
    â”‚   â””â”€â”€ fu2-7.png
    â”œâ”€â”€ gao/
    â”‚   â””â”€â”€ gao-7.png
    â”œâ”€â”€ gong/
    â”‚   â””â”€â”€ gong-7.png
    â”œâ”€â”€ guo/
    â”‚   â””â”€â”€ guo-7.png
    â”œâ”€â”€ hu/
    â”‚   â””â”€â”€ hu-7.png
    â”œâ”€â”€ huo/
    â”‚   â””â”€â”€ huo-7.png
    â”œâ”€â”€ kou/
    â”‚   â””â”€â”€ kou-7.png
    â”œâ”€â”€ ku/
    â”‚   â””â”€â”€ ku-7.png
    â”œâ”€â”€ lin/
    â”‚   â””â”€â”€ lin-7.png
    â”œâ”€â”€ ma/
    â”‚   â””â”€â”€ ma-7.png
    â”œâ”€â”€ ma2/
    â”‚   â””â”€â”€ ma2-7.png
    â”œâ”€â”€ ma3/
    â”‚   â””â”€â”€ ma3-7.png
    â”œâ”€â”€ mei/
    â”‚   â””â”€â”€ mei-7.png
    â”œâ”€â”€ men/
    â”‚   â””â”€â”€ men-7.png
    â”œâ”€â”€ ming/
    â”‚   â””â”€â”€ ming-7.png
    â”œâ”€â”€ mu/
    â”‚   â””â”€â”€ mu-7.png
    â”œâ”€â”€ nan/
    â”‚   â””â”€â”€ nan-7.png
    â”œâ”€â”€ niao/
    â”‚   â””â”€â”€ niao-7.png
    â”œâ”€â”€ niu/
    â”‚   â””â”€â”€ niu-7.png
    â”œâ”€â”€ nu/
    â”‚   â””â”€â”€ nu-7.png
    â”œâ”€â”€ nuan/
    â”‚   â””â”€â”€ nuan-7.png
    â”œâ”€â”€ peng/
    â”‚   â””â”€â”€ peng-7.png
    â”œâ”€â”€ quan/
    â”‚   â””â”€â”€ quan-7.png
    â”œâ”€â”€ ren/
    â”‚   â””â”€â”€ ren-7.png
    â”œâ”€â”€ ri/
    â”‚   â””â”€â”€ ri-7.png
    â”œâ”€â”€ rou/
    â”‚   â””â”€â”€ rou-7.png
    â”œâ”€â”€ sen/
    â”‚   â””â”€â”€ sen-7.png
    â”œâ”€â”€ shan/
    â”‚   â””â”€â”€ shan-7.png
    â”œâ”€â”€ shan2/
    â”‚   â””â”€â”€ shan2-7.png
    â”œâ”€â”€ shui/
    â”‚   â””â”€â”€ shui-7.png
    â”œâ”€â”€ tai/
    â”‚   â””â”€â”€ tai-7.png
    â”œâ”€â”€ tian/
    â”‚   â””â”€â”€ tian-7.png
    â”œâ”€â”€ wang/
    â”‚   â””â”€â”€ wang-7.png
    â”œâ”€â”€ wen/
    â”‚   â””â”€â”€ wen-7.png
    â”œâ”€â”€ xian/
    â”‚   â””â”€â”€ xian-7.png
    â”œâ”€â”€ xuan/
    â”‚   â””â”€â”€ xuan-7.png
    â”œâ”€â”€ yan/
    â”‚   â””â”€â”€ yan-7.png
    â”œâ”€â”€ yang/
    â”‚   â””â”€â”€ yang-7.png
    â”œâ”€â”€ yin/
    â”‚   â””â”€â”€ yin-7.png
    â”œâ”€â”€ yu/
    â”‚   â””â”€â”€ yu-7.png
    â”œâ”€â”€ yu2/
    â”‚   â””â”€â”€ yu2-7.png
    â”œâ”€â”€ yue/
    â”‚   â””â”€â”€ yue-7.png
    â”œâ”€â”€ zhong/
    â”‚   â””â”€â”€ zhong-7.png
    â”œâ”€â”€ zhu/
    â”‚   â””â”€â”€ zhu-7.png
    â”œâ”€â”€ zhu2/
    â”‚   â””â”€â”€ zhu2-7.png
    â””â”€â”€ zhuo/
        â””â”€â”€ zhuo-7.png</code></pre>
</div>
</div>
</div><div class="column">
<div id="3ea416e2" class="cell" data-execution_count="24">
<div class="cell-output cell-output-stdout">
<pre><code>train/
â”œâ”€â”€ bai/
â”‚   â”œâ”€â”€ bai-1.png
â”‚   â”œâ”€â”€ bai-2.png
â”‚   â”œâ”€â”€ bai-3.png
â”‚   â”œâ”€â”€ bai-4.png
â”‚   â””â”€â”€ bai-6.png
...
val/
â”œâ”€â”€ bai/
â”‚   â””â”€â”€ bai-7.png
â”œâ”€â”€ ben/
â”‚   â””â”€â”€ ben-7.png
...
test/
â”œâ”€â”€ bai/
â”‚   â””â”€â”€ bai-5.png
â”œâ”€â”€ ben/
â”‚   â””â”€â”€ ben-5.png
...</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="keras-image-dataset-loading" class="slide level2">
<h2>Keras image dataset loading</h2>
<div class="columns">
<div class="column">
<div id="7d0c3bff" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a></a><span class="im">from</span> keras.utils <span class="im">import</span><span class="op">\</span></span>
<span id="cb36-2"><a></a>  image_dataset_from_directory</span>
<span id="cb36-3"><a></a></span>
<span id="cb36-4"><a></a>data_dir <span class="op">=</span> <span class="st">"mandarin-split"</span></span>
<span id="cb36-5"><a></a>batch_size <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb36-6"><a></a>img_height <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb36-7"><a></a>img_width <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb36-8"><a></a>img_size <span class="op">=</span> (img_height, img_width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div id="238c20d3" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a></a>train_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb37-2"><a></a>    data_dir <span class="op">+</span> <span class="st">"/train"</span>,</span>
<span id="cb37-3"><a></a>    image_size<span class="op">=</span>img_size,</span>
<span id="cb37-4"><a></a>    batch_size<span class="op">=</span>batch_size,</span>
<span id="cb37-5"><a></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb37-6"><a></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column">
<div id="65b727cd" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a></a>val_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb38-2"><a></a>    data_dir <span class="op">+</span> <span class="st">"/val"</span>,</span>
<span id="cb38-3"><a></a>    image_size<span class="op">=</span>img_size,</span>
<span id="cb38-4"><a></a>    batch_size<span class="op">=</span>batch_size,</span>
<span id="cb38-5"><a></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb38-6"><a></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column">
<div id="217b5421" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a></a>test_ds <span class="op">=</span> image_dataset_from_directory(</span>
<span id="cb39-2"><a></a>    data_dir <span class="op">+</span> <span class="st">"/test"</span>,</span>
<span id="cb39-3"><a></a>    image_size<span class="op">=</span>img_size,</span>
<span id="cb39-4"><a></a>    batch_size<span class="op">=</span>batch_size,</span>
<span id="cb39-5"><a></a>    shuffle<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb39-6"><a></a>    color_mode<span class="op">=</span><span class="st">'grayscale'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="inspecting-the-datasets" class="slide level2">
<h2>Inspecting the datasets</h2>
<div id="f95ca2df" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a></a><span class="bu">print</span>(train_ds.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['bai', 'ben', 'chong', 'chu', 'chuan', 'cong', 'da', 'dan', 'dong', 'fei', 'fu', 'fu2', 'gao', 'gong', 'guo', 'hu', 'huo', 'kou', 'ku', 'lin', 'ma', 'ma2', 'ma3', 'mei', 'men', 'ming', 'mu', 'nan', 'niao', 'niu', 'nu', 'nuan', 'peng', 'quan', 'ren', 'ri', 'rou', 'sen', 'shan', 'shan2', 'shui', 'tai', 'tian', 'wang', 'wen', 'xian', 'xuan', 'yan', 'yang', 'yin', 'yu', 'yu2', 'yue', 'zhong', 'zhu', 'zhu2', 'zhuo']</code></pre>
</div>
</div>
<div id="f96812fa" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a></a><span class="co"># NB: Need shuffle=False earlier for these X &amp; y to line up.</span></span>
<span id="cb42-2"><a></a>X_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(train_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb42-3"><a></a>y_train <span class="op">=</span> np.concatenate(<span class="bu">list</span>(train_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb42-4"><a></a></span>
<span id="cb42-5"><a></a>X_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(val_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb42-6"><a></a>y_val <span class="op">=</span> np.concatenate(<span class="bu">list</span>(val_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb42-7"><a></a></span>
<span id="cb42-8"><a></a>X_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(test_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: x)))</span>
<span id="cb42-9"><a></a>y_test <span class="op">=</span> np.concatenate(<span class="bu">list</span>(test_ds.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: y)))</span>
<span id="cb42-10"><a></a></span>
<span id="cb42-11"><a></a>X_train.shape, y_train.shape, X_val.shape, y_val.shape, X_test.shape, y_test.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>((285, 80, 80, 1), (285,), (57, 80, 80, 1), (57,), (57, 80, 80, 1), (57,))</code></pre>
</div>
</div>
</section>
<section id="plotting-some-characters-setup" class="slide level2">
<h2>Plotting some characters (setup)</h2>
<div id="4528b8e0" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a></a><span class="kw">def</span> plot_mandarin_characters(ds, plot_char_label <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb44-2"><a></a>    num_plotted <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb44-3"><a></a>    <span class="cf">for</span> images, labels <span class="kw">in</span> ds:</span>
<span id="cb44-4"><a></a>       <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(images.shape[<span class="dv">0</span>]):</span>
<span id="cb44-5"><a></a>           label <span class="op">=</span> labels[i]</span>
<span id="cb44-6"><a></a>           <span class="cf">if</span> label <span class="op">==</span> plot_char_label:</span>
<span id="cb44-7"><a></a>               plt.subplot(<span class="dv">1</span>, <span class="dv">5</span>, num_plotted <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb44-8"><a></a>               plt.imshow(images[i].numpy().astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb44-9"><a></a>               plt.title(ds.class_names[label])</span>
<span id="cb44-10"><a></a>               plt.axis(<span class="st">"off"</span>)</span>
<span id="cb44-11"><a></a>               num_plotted <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb44-12"><a></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-some-training-characters" class="slide level2 smaller">
<h2>Plotting some training characters</h2>
<div id="bbb6fbfe" class="cell" data-execution_count="33">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-34-output-1.png"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-34-output-2.png"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-some-valtest-characters" class="slide level2">
<h2>Plotting some val/test characters</h2>
<div class="columns">
<div class="column">
<div id="194abe4a" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a></a>bai_val <span class="op">=</span> X_val[y_val <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb45-2"><a></a>plt.imshow(bai_val, cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-35-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div id="15635353" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a></a>bai_test <span class="op">=</span> X_test[y_test <span class="op">==</span> <span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb46-2"><a></a>plt.imshow(bai_test)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-36-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="demo-character-recognition-ii" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Demo: Character Recognition II</h1>

</section>
<section id="make-the-cnn" class="slide level2">
<h2>Make the CNN</h2>
<div id="0322352a" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a></a><span class="im">from</span> keras.layers <span class="op">\</span></span>
<span id="cb47-2"><a></a>  <span class="im">import</span> Rescaling, Conv2D, MaxPooling2D, Flatten</span>
<span id="cb47-3"><a></a></span>
<span id="cb47-4"><a></a>num_classes <span class="op">=</span> np.unique(y_train).shape[<span class="dv">0</span>]</span>
<span id="cb47-5"><a></a>random.seed(<span class="dv">123</span>)</span>
<span id="cb47-6"><a></a></span>
<span id="cb47-7"><a></a>model <span class="op">=</span> Sequential([</span>
<span id="cb47-8"><a></a>  Input((img_height, img_width, <span class="dv">1</span>)),</span>
<span id="cb47-9"><a></a>  Rescaling(<span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>),</span>
<span id="cb47-10"><a></a>  Conv2D(<span class="dv">16</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv1"</span>),</span>
<span id="cb47-11"><a></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool1"</span>),</span>
<span id="cb47-12"><a></a>  Conv2D(<span class="dv">32</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv2"</span>),</span>
<span id="cb47-13"><a></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool2"</span>),</span>
<span id="cb47-14"><a></a>  Conv2D(<span class="dv">64</span>, <span class="dv">3</span>, padding<span class="op">=</span><span class="st">"same"</span>, activation<span class="op">=</span><span class="st">"relu"</span>, name<span class="op">=</span><span class="st">"conv3"</span>),</span>
<span id="cb47-15"><a></a>  MaxPooling2D(name<span class="op">=</span><span class="st">"pool3"</span>),</span>
<span id="cb47-16"><a></a>  Flatten(), Dense(<span class="dv">128</span>, activation<span class="op">=</span><span class="st">"relu"</span>), Dense(num_classes)</span>
<span id="cb47-17"><a></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The <code>Rescaling</code> layer will rescale the intensities to [0, 1].</p>
</div>
</div>
</div>
<div class="footer">
<p>Architecture inspired by <a href="https://www.tensorflow.org/tutorials/images/classification">https://www.tensorflow.org/tutorials/images/classification</a>.</p>
</div>
</section>
<section id="inspect-the-model" class="slide level2">
<h2>Inspect the model</h2>
<div id="7305e701" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ<span style="font-weight: bold"> Layer (type)                    </span>â”ƒ<span style="font-weight: bold"> Output Shape              </span>â”ƒ<span style="font-weight: bold">    Param # </span>â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ rescaling (<span style="color: #0087ff; text-decoration-color: #0087ff">Rescaling</span>)           â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">80</span>, <span style="color: #00af00; text-decoration-color: #00af00">80</span>, <span style="color: #00af00; text-decoration-color: #00af00">1</span>)         â”‚          <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                  â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">80</span>, <span style="color: #00af00; text-decoration-color: #00af00">80</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)        â”‚        <span style="color: #00af00; text-decoration-color: #00af00">160</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pool1 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)            â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)        â”‚          <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                  â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>, <span style="color: #00af00; text-decoration-color: #00af00">40</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)        â”‚      <span style="color: #00af00; text-decoration-color: #00af00">4,640</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pool2 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)            â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">20</span>, <span style="color: #00af00; text-decoration-color: #00af00">20</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)        â”‚          <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ conv3 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                  â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">20</span>, <span style="color: #00af00; text-decoration-color: #00af00">20</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)        â”‚     <span style="color: #00af00; text-decoration-color: #00af00">18,496</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pool3 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)            â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)        â”‚          <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ flatten (<span style="color: #0087ff; text-decoration-color: #0087ff">Flatten</span>)               â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">6400</span>)              â”‚          <span style="color: #00af00; text-decoration-color: #00af00">0</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                   â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">128</span>)               â”‚    <span style="color: #00af00; text-decoration-color: #00af00">819,328</span> â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 â”‚ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">57</span>)                â”‚      <span style="color: #00af00; text-decoration-color: #00af00">7,353</span> â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">849,977</span> (3.24 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">849,977</span> (3.24 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div>
</div>
</section>
<section id="plot-the-cnn" class="slide level2">
<h2>Plot the CNN</h2>
<div id="b0e5b8c3" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a></a>plot_model(model, show_shapes<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-39-output-1.png" class="r-stretch"></section>
<section id="fit-the-cnn" class="slide level2">
<h2>Fit the CNN</h2>
<div id="6aad45f3" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a></a>loss <span class="op">=</span> keras.losses.SparseCategoricalCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb50-2"><a></a>topk <span class="op">=</span> keras.metrics.SparseTopKCategoricalAccuracy(k<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb50-3"><a></a>model.compile(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span>loss, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>, topk])</span>
<span id="cb50-4"><a></a></span>
<span id="cb50-5"><a></a>epochs <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb50-6"><a></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">15</span>, restore_best_weights<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb50-7"><a></a>    monitor<span class="op">=</span><span class="st">"val_accuracy"</span>, verbose<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-8"><a></a></span>
<span id="cb50-9"><a></a>hist <span class="op">=</span> model.fit(train_ds.shuffle(<span class="dv">1000</span>), validation_data<span class="op">=</span>val_ds,</span>
<span id="cb50-10"><a></a>  epochs<span class="op">=</span>epochs, callbacks<span class="op">=</span>[es], verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 61: early stopping
Restoring model weights from the end of the best epoch: 46.</code></pre>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Instead of using softmax activation, just added <code>from_logits=True</code> to the loss function; this is more numerically stable.</p>
</div>
</div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves-setup" class="slide level2">
<h2>Plot the loss/accuracy curves (setup)</h2>
<div id="7e3f2667" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a></a><span class="kw">def</span> plot_history(hist):</span>
<span id="cb52-2"><a></a>    epochs <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(hist.history[<span class="st">"loss"</span>]))</span>
<span id="cb52-3"><a></a></span>
<span id="cb52-4"><a></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb52-5"><a></a>    plt.plot(epochs, hist.history[<span class="st">"accuracy"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb52-6"><a></a>    plt.plot(epochs, hist.history[<span class="st">"val_accuracy"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb52-7"><a></a>    plt.legend(loc<span class="op">=</span><span class="st">"lower right"</span>)</span>
<span id="cb52-8"><a></a>    plt.title(<span class="st">"Accuracy"</span>)</span>
<span id="cb52-9"><a></a></span>
<span id="cb52-10"><a></a>    plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb52-11"><a></a>    plt.plot(epochs, hist.history[<span class="st">"loss"</span>], label<span class="op">=</span><span class="st">"Train"</span>)</span>
<span id="cb52-12"><a></a>    plt.plot(epochs, hist.history[<span class="st">"val_loss"</span>], label<span class="op">=</span><span class="st">"Val"</span>)</span>
<span id="cb52-13"><a></a>    plt.legend(loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb52-14"><a></a>    plt.title(<span class="st">"Loss"</span>)</span>
<span id="cb52-15"><a></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-the-lossaccuracy-curves" class="slide level2">
<h2>Plot the loss/accuracy curves</h2>
<div id="696343d2" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a></a>plot_history(hist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-43-output-1.png" class="r-stretch"></section>
<section id="look-at-the-metrics" class="slide level2">
<h2>Look at the metrics</h2>
<div id="c5771b5b" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a></a><span class="bu">print</span>(model.evaluate(train_ds, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb54-2"><a></a><span class="bu">print</span>(model.evaluate(val_ds, verbose<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb54-3"><a></a><span class="bu">print</span>(model.evaluate(test_ds, verbose<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.000872915843501687, 1.0, 1.0]
[1.3904294967651367, 0.7719298005104065, 0.9473684430122375]
[0.9015927314758301, 0.8070175647735596, 0.9649122953414917]</code></pre>
</div>
</div>
</section>
<section id="predict-on-the-test-set" class="slide level2">
<h2>Predict on the test set</h2>
<div id="eca9c8c4" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a></a>model.predict(X_test[<span class="dv">17</span>], verbose<span class="op">=</span><span class="dv">0</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre>Exception encountered when calling MaxPooling2D.call().

<span class="ansi-bold">Given input size: (16x80x1). Calculated output size: (16x40x0). Output size is too small</span>

Arguments received by MaxPooling2D.call():
  â€¢ inputs=torch.Tensor(shape=torch.Size([32, 80, 1, 16]), dtype=float32)</pre>
</div>
</div>
</div>
<div id="0b689d3b" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a></a>X_test[<span class="dv">17</span>].shape, X_test[<span class="dv">17</span>][np.newaxis, :].shape, X_test[[<span class="dv">17</span>]].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>((80, 80, 1), (1, 80, 80, 1), (1, 80, 80, 1))</code></pre>
</div>
</div>
<div id="6f686374" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a></a>model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>array([[  5.3 , -39.16, -19.69,  -1.85,  -5.79, -21.37, -29.5 , -19.02,
        -24.34, -19.76, -24.25,   4.51, -12.56, -38.95,   4.08,  -4.33,
        -17.79,  17.11, -24.11,  -3.67,  -5.65, -11.93,  -5.19, -26.43,
         11.84,   0.11, -28.81,   7.49,   2.03, -30.62, -25.36,  -1.65,
         -8.67, -30.7 , -33.91,  15.12,  -4.21, -14.29,  -0.13,   0.58,
        -27.55, -35.24, -32.54, -17.89,  -5.48, -10.58,  -9.2 , -14.83,
        -15.91,   9.42, -13.04, -13.91,   1.75, -22.18,  -9.81, -13.85,
        -13.8 ]], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="predict-on-the-test-set-ii" class="slide level2">
<h2>Predict on the test set II</h2>
<div id="2da54c49" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a></a>model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>).argmax()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>17</code></pre>
</div>
</div>
<div id="c64f532c" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a></a>test_ds.class_names[model.predict(X_test[[<span class="dv">17</span>]], verbose<span class="op">=</span><span class="dv">0</span>).argmax()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>'kou'</code></pre>
</div>
</div>
<div id="5bf58795" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a></a>plt.imshow(X_test[<span class="dv">17</span>], cmap<span class="op">=</span><span class="st">"gray"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-50-output-1.png" class="r-stretch"></section></section>
<section>
<section id="error-analysis" class="title-slide slide level1 center">
<h1>Error Analysis</h1>

</section>
<section id="error-analysis-setup" class="slide level2">
<h2>Error analysis (setup)</h2>
<div id="779cbfe5" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a></a><span class="kw">def</span> plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, class_names):</span>
<span id="cb66-2"><a></a>  plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">10</span>))</span>
<span id="cb66-3"><a></a></span>
<span id="cb66-4"><a></a>  num_errors <span class="op">=</span> np.sum(y_pred <span class="op">!=</span> y_test)</span>
<span id="cb66-5"><a></a>  err_num <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb66-6"><a></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X_test.shape[<span class="dv">0</span>]):</span>
<span id="cb66-7"><a></a>      <span class="cf">if</span> y_pred[i] <span class="op">!=</span> y_test[i]:</span>
<span id="cb66-8"><a></a>          ax <span class="op">=</span> plt.subplot(num_errors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>err_num <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb66-9"><a></a>          plt.imshow(X_test[i].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb66-10"><a></a>          plt.title(<span class="ss">f"Guessed '</span><span class="sc">{</span>class_names[y_pred[i]]<span class="sc">}</span><span class="ss">' True '</span><span class="sc">{</span>class_names[y_test[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb66-11"><a></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb66-12"><a></a>          </span>
<span id="cb66-13"><a></a>          actual_pred_char_ind <span class="op">=</span> np.argmax(y_test <span class="op">==</span> y_pred[i])</span>
<span id="cb66-14"><a></a>          ax <span class="op">=</span> plt.subplot(num_errors, <span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>err_num <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb66-15"><a></a>          plt.imshow(X_val[actual_pred_char_ind].astype(<span class="st">"uint8"</span>), cmap<span class="op">=</span><span class="st">"gray"</span>)</span>
<span id="cb66-16"><a></a>          plt.title(<span class="ss">f"A real '</span><span class="sc">{</span>class_names[y_pred[i]]<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb66-17"><a></a>          plt.axis(<span class="st">"off"</span>)</span>
<span id="cb66-18"><a></a>          err_num <span class="op">+=</span> <span class="dv">1</span>     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="error-analysis-i" class="slide level2">
<h2>Error analysis I</h2>

<img data-src="error-analysis-found-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from first assessment of test errors.</p></section>
<section id="error-analysis-ii" class="slide level2">
<h2>Error analysis II</h2>

<img data-src="error-analysis-found-another-data-problem.png" class="r-stretch quarto-figure-center"><p class="caption">Extract from second assessment of test errors.</p></section>
<section id="error-analysis-iii" class="slide level2">
<h2>Error analysis III</h2>
<div id="dfce48fd" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a></a>y_pred <span class="op">=</span> model.predict(X_val, verbose<span class="op">=</span><span class="dv">0</span>).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb67-2"><a></a>plot_error_analysis(X_train, y_train, X_val, y_val, y_pred, val_ds.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-52-output-1.png" class="r-stretch"></section>
<section id="error-analysis-iv" class="slide level2">
<h2>Error analysis IV</h2>
<div id="89bb4cd0" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a></a>y_pred <span class="op">=</span> model.predict(X_test, verbose<span class="op">=</span><span class="dv">0</span>).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb68-2"><a></a>plot_error_analysis(X_train, y_train, X_test, y_test, y_pred, test_ds.class_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="computer-vision_files/figure-revealjs/cell-53-output-1.png" class="r-stretch"></section>
<section id="confidence-of-predictions" class="slide level2">
<h2>Confidence of predictions</h2>
<div id="e755f6ce" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a></a>y_pred <span class="op">=</span> keras.activations.softmax(model(X_test))</span>
<span id="cb69-2"><a></a>y_pred_class <span class="op">=</span> keras.ops.argmax(y_pred, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb69-3"><a></a>y_pred_prob <span class="op">=</span> y_pred[np.arange(y_pred.shape[<span class="dv">0</span>]), y_pred_class]</span>
<span id="cb69-4"><a></a></span>
<span id="cb69-5"><a></a>y_pred_class <span class="op">=</span> keras.ops.convert_to_numpy(y_pred_class)</span>
<span id="cb69-6"><a></a>y_pred_prob <span class="op">=</span> keras.ops.convert_to_numpy(y_pred_prob)</span>
<span id="cb69-7"><a></a></span>
<span id="cb69-8"><a></a>confidence_when_correct <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">==</span> y_test]</span>
<span id="cb69-9"><a></a>confidence_when_wrong <span class="op">=</span> y_pred_prob[y_pred_class <span class="op">!=</span> y_test]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column">
<div id="bce3c7d0" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a></a>plt.hist(confidence_when_correct)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-55-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div id="faf4af7e" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a></a>plt.hist(confidence_when_wrong)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="computer-vision_files/figure-revealjs/cell-56-output-1.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="hyperparameter-tuning" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Hyperparameter tuning</h1>

</section>
<section id="trial-error" class="slide level2">
<h2>Trial &amp; error</h2>
<div class="columns">
<div class="column">
<p><br> <br></p>
<p>Frankly, a lot of this is just â€˜enlightenedâ€™ trial and error.</p>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="twitter-advice.png"></p>
<figcaption>Or â€˜received wisdomâ€™ from expertsâ€¦</figcaption>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: <a href="https://twitter.com/tetraduzione/status/1525501171221274627?s=20&amp;t=ulVFesw-f7hCuG9KyaoYbQ">Twitter</a>.</p>
</div>
</section>
<section id="keras-tuner" class="slide level2">
<h2>Keras Tuner</h2>
<div id="2e8d87f5" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a></a><span class="op">!</span>pip install keras<span class="op">-</span>tuner</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fad9d4d1" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a></a><span class="im">import</span> keras_tuner <span class="im">as</span> kt</span>
<span id="cb73-2"><a></a></span>
<span id="cb73-3"><a></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb73-4"><a></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb73-5"><a></a>    model.add(</span>
<span id="cb73-6"><a></a>        Dense(</span>
<span id="cb73-7"><a></a>            hp.Choice(<span class="st">"neurons"</span>, [<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>]),</span>
<span id="cb73-8"><a></a>            activation<span class="op">=</span>hp.Choice(<span class="st">"activation"</span>,</span>
<span id="cb73-9"><a></a>                [<span class="st">"relu"</span>, <span class="st">"leaky_relu"</span>, <span class="st">"tanh"</span>]),</span>
<span id="cb73-10"><a></a>        )</span>
<span id="cb73-11"><a></a>    )</span>
<span id="cb73-12"><a></a>  </span>
<span id="cb73-13"><a></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb73-14"><a></a>    </span>
<span id="cb73-15"><a></a>    learning_rate <span class="op">=</span> hp.Float(<span class="st">"lr"</span>,</span>
<span id="cb73-16"><a></a>        min_value<span class="op">=</span><span class="fl">1e-4</span>, max_value<span class="op">=</span><span class="fl">1e-2</span>, sampling<span class="op">=</span><span class="st">"log"</span>)</span>
<span id="cb73-17"><a></a>    opt <span class="op">=</span> keras.optimizers.Adam(learning_rate<span class="op">=</span>learning_rate)</span>
<span id="cb73-18"><a></a></span>
<span id="cb73-19"><a></a>    model.compile(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb73-20"><a></a>    </span>
<span id="cb73-21"><a></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-random-search" class="slide level2">
<h2>Do a random search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div id="0d47f305" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a></a>tuner <span class="op">=</span> kt.RandomSearch(</span>
<span id="cb74-2"><a></a>  build_model,</span>
<span id="cb74-3"><a></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb74-4"><a></a>  max_trials<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb74-5"><a></a>  directory<span class="op">=</span><span class="st">"random-search"</span>)</span>
<span id="cb74-6"><a></a></span>
<span id="cb74-7"><a></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb74-8"><a></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb74-9"><a></a></span>
<span id="cb74-10"><a></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb74-11"><a></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb74-12"><a></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb74-13"><a></a></span>
<span id="cb74-14"><a></a>best_model <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reloading Tuner from random-search/untitled_project/tuner0.json</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div id="dd9a2c6b" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in random-search/untitled_project
Showing 1 best trials
Objective(name="val_loss", direction="min")

Trial 02 summary
Hyperparameters:
neurons: 8
activation: tanh
lr: 0.0021043482724264983
Score: 0.3167361915111542</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tune-layers-separately" class="slide level2">
<h2>Tune layers separately</h2>
<div id="e7bd4008" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a></a><span class="kw">def</span> build_model(hp):</span>
<span id="cb78-2"><a></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb78-3"><a></a></span>
<span id="cb78-4"><a></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(hp.Int(<span class="st">"numHiddenLayers"</span>, <span class="dv">1</span>, <span class="dv">3</span>)):</span>
<span id="cb78-5"><a></a>      <span class="co"># Tune number of units in each layer separately.</span></span>
<span id="cb78-6"><a></a>      model.add(</span>
<span id="cb78-7"><a></a>          Dense(</span>
<span id="cb78-8"><a></a>              hp.Choice(<span class="ss">f"neurons_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, [<span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>]),</span>
<span id="cb78-9"><a></a>              activation<span class="op">=</span><span class="st">"relu"</span></span>
<span id="cb78-10"><a></a>          )</span>
<span id="cb78-11"><a></a>      )</span>
<span id="cb78-12"><a></a>    model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">"exponential"</span>))</span>
<span id="cb78-13"><a></a></span>
<span id="cb78-14"><a></a>    opt <span class="op">=</span> keras.optimizers.Adam(learning_rate<span class="op">=</span><span class="fl">0.0005</span>)</span>
<span id="cb78-15"><a></a>    model.compile(optimizer<span class="op">=</span>opt, loss<span class="op">=</span><span class="st">"poisson"</span>)</span>
<span id="cb78-16"><a></a>    </span>
<span id="cb78-17"><a></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="do-a-bayesian-search" class="slide level2">
<h2>Do a Bayesian search</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div id="87e97ace" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a></a>tuner <span class="op">=</span> kt.BayesianOptimization(</span>
<span id="cb79-2"><a></a>  build_model,</span>
<span id="cb79-3"><a></a>  objective<span class="op">=</span><span class="st">"val_loss"</span>,</span>
<span id="cb79-4"><a></a>  directory<span class="op">=</span><span class="st">"bayesian-search"</span>,</span>
<span id="cb79-5"><a></a>  max_trials<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb79-6"><a></a></span>
<span id="cb79-7"><a></a>es <span class="op">=</span> EarlyStopping(patience<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb79-8"><a></a>  restore_best_weights<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb79-9"><a></a></span>
<span id="cb79-10"><a></a>tuner.search(X_train_sc, y_train,</span>
<span id="cb79-11"><a></a>  epochs<span class="op">=</span><span class="dv">100</span>, callbacks <span class="op">=</span> [es],</span>
<span id="cb79-12"><a></a>  validation_data<span class="op">=</span>(X_val_sc, y_val))</span>
<span id="cb79-13"><a></a></span>
<span id="cb79-14"><a></a>best_model <span class="op">=</span> tuner.get_best_models()[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reloading Tuner from bayesian-search/untitled_project/tuner0.json</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div id="d5a7d963" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a></a>tuner.results_summary(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Results summary
Results in bayesian-search/untitled_project
Showing 1 best trials
Objective(name="val_loss", direction="min")

Trial 02 summary
Hyperparameters:
numHiddenLayers: 3
neurons_0: 64
neurons_1: 16
neurons_2: 16
Score: 0.3142806887626648</code></pre>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="leveraging-solutions-from-benchmark-problems" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Leveraging Solutions From Benchmark Problems</h1>

</section>
<section id="demo-object-classification" class="slide level2">
<h2>Demo: Object classification</h2>
<div class="columns">
<div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="teach-images.png"></p>
<figcaption>Example object classification run.</figcaption>
</figure>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://info.deeplearning.ai/hs-fs/hubfs/NOCODE.gif?width=1199&amp;upscale=true&amp;name=NOCODE.gif"></p>
<figcaption>Example of object classification.</figcaption>
</figure>
</div>
</div>
</div>
<div class="footer">
<p>Source: Teachable Machine, <a href="https://teachablemachine.withgoogle.com/">https://teachablemachine.withgoogle.com/</a>.</p>
</div>
</section>
<section id="how-does-that-work" class="slide level2">
<h2>How does that work?</h2>
<blockquote>
<p>â€¦ these models use a technique called transfer learning. Thereâ€™s a pretrained neural network, and when you create your own classes, you can sort of picture that your classes are becoming the last layer or step of the neural net. Specifically, both the image and pose models are learning off of pretrained mobilenet models â€¦</p>
</blockquote>
<p><a href="https://teachablemachine.withgoogle.com/faq#Diving-Deeper">Teachable Machine FAQ</a></p>
</section>
<section id="benchmarks" class="slide level2">
<h2>Benchmarks</h2>
<p><a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-11 / CIFAR-100 dataset</a> from Canadian Institute for Advanced Research</p>
<ul>
<li>9 classes: 60000 32x32 colour images</li>
<li>99 classes: 60000 32x32 colour images</li>
</ul>
<p><a href="https://www.image-net.org/index.php">ImageNet</a> and the <em>ImageNet Large Scale Visual Recognition Challenge (ILSVRC)</em>; originally <a href="https://image-net.org/challenges/LSVRC/2014/browse-synsets">1,000 synsets</a>.</p>
<ul>
<li>In 2021: 14,197,122 labelled images from 21,841 synsets.</li>
<li>See <a href="https://keras.io/api/applications/">Keras applications</a> for downloadable models.</li>
</ul>
</section>
<section id="lenet-6-1998" class="slide level2 smaller">
<h2>LeNet-6 (1998)</h2>
<table style="width:100%;">
<colgroup>
<col style="width: 9%">
<col style="width: 23%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel size</th>
<th>Stride</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>0</td>
<td>32Ã—32</td>
<td>â€“</td>
<td>â€“</td>
<td>â€“</td>
</tr>
<tr class="even">
<td>C0</td>
<td>Convolution</td>
<td>6</td>
<td>28Ã—28</td>
<td>5Ã—5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S1</td>
<td>Avg pooling</td>
<td>6</td>
<td>14Ã—14</td>
<td>2Ã—2</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C2</td>
<td>Convolution</td>
<td>16</td>
<td>10Ã—10</td>
<td>5Ã—5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>Avg pooling</td>
<td>16</td>
<td>5Ã—5</td>
<td>2Ã—2</td>
<td>2</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>C4</td>
<td>Convolution</td>
<td>120</td>
<td>1Ã—1</td>
<td>5Ã—5</td>
<td>1</td>
<td>tanh</td>
</tr>
<tr class="odd">
<td>F5</td>
<td>Fully connected</td>
<td>â€“</td>
<td>84</td>
<td>â€“</td>
<td>â€“</td>
<td>tanh</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully connected</td>
<td>â€“</td>
<td>9</td>
<td>â€“</td>
<td>â€“</td>
<td>RBF</td>
</tr>
</tbody>
</table>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>MNIST images are 27Ã—28 pixels, and with zero-padding (for a 5Ã—5 kernel) that becomes 32Ã—32.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: AurÃ©lien GÃ©ron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Chapter 14.</p>
</div>
</section>
<section id="alexnet-2011" class="slide level2 smaller">
<h2>AlexNet (2011)</h2>
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Type</th>
<th>Channels</th>
<th>Size</th>
<th>Kernel</th>
<th>Stride</th>
<th>Padding</th>
<th>Activation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>In</td>
<td>Input</td>
<td>2</td>
<td>227Ã—227</td>
<td>â€“</td>
<td>â€“</td>
<td>â€“</td>
<td>â€“</td>
</tr>
<tr class="even">
<td>C0</td>
<td>Convolution</td>
<td>96</td>
<td>55Ã—55</td>
<td>11Ã—11</td>
<td>4</td>
<td>valid</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S1</td>
<td>Max pool</td>
<td>96</td>
<td>27Ã—27</td>
<td>3Ã—3</td>
<td>2</td>
<td>valid</td>
<td>â€“</td>
</tr>
<tr class="even">
<td>C2</td>
<td>Convolution</td>
<td>256</td>
<td>27Ã—27</td>
<td>5Ã—5</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>Max pool</td>
<td>256</td>
<td>13Ã—13</td>
<td>3Ã—3</td>
<td>2</td>
<td>valid</td>
<td>â€“</td>
</tr>
<tr class="even">
<td>C4</td>
<td>Convolution</td>
<td>384</td>
<td>13Ã—13</td>
<td>3Ã—3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>C5</td>
<td>Convolution</td>
<td>384</td>
<td>13Ã—13</td>
<td>3Ã—3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>C6</td>
<td>Convolution</td>
<td>256</td>
<td>13Ã—13</td>
<td>3Ã—3</td>
<td>1</td>
<td>same</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>S7</td>
<td>Max pool</td>
<td>256</td>
<td>6Ã—6</td>
<td>3Ã—3</td>
<td>2</td>
<td>valid</td>
<td>â€“</td>
</tr>
<tr class="even">
<td>F8</td>
<td>Fully conn.</td>
<td>â€“</td>
<td>4,096</td>
<td>â€“</td>
<td>â€“</td>
<td>â€“</td>
<td>ReLU</td>
</tr>
<tr class="odd">
<td>F9</td>
<td>Fully conn.</td>
<td>â€“</td>
<td>4,096</td>
<td>â€“</td>
<td>â€“</td>
<td>â€“</td>
<td>ReLU</td>
</tr>
<tr class="even">
<td>Out</td>
<td>Fully conn.</td>
<td>â€“</td>
<td>0,000</td>
<td>â€“</td>
<td>â€“</td>
<td>â€“</td>
<td>Softmax</td>
</tr>
</tbody>
</table>
<div class="footer">
<p>Winner of the ILSVRC 2011 challenge (top-five error 17%), developed by Alex Krizhevsky, Ilya Sutskever, and Geoffrey Hinton.</p>
</div>
</section>
<section id="data-augmentation" class="slide level2">
<h2>Data Augmentation</h2>

<img data-src="data-augmentation.png" class="r-stretch quarto-figure-center"><p class="caption">Examples of data augmentation.</p><div class="footer">
<p>Source: Buah et al.&nbsp;(2019), <em>Can Artificial Intelligence Assist Project Developers in Long-Term Management of Energy Projects? The Case of CO2 Capture and Storage</em>.</p>
</div>
</section>
<section id="inception-module-2013" class="slide level2">
<h2>Inception module (2013)</h2>
<p>Used in ILSVRC 2013 winning solution (top-5 error &lt; 7%).</p>
<div class="columns">
<div class="column" style="width:59%;">
<p><img data-src="inception-module-fig-2b.png"></p>
</div><div class="column" style="width:39%;">
<p><br></p>
<p><img data-src="inception-meme.jpeg"></p>
</div>
</div>
<p>VGGNet was the runner-up.</p>
<div class="footer">
<p>Source: Szegedy, C. et al.&nbsp;(2014), <a href="https://arxiv.org/pdf/1409.4842.pdf"><em>Going deeper with convolutions</em></a>. and <a href="https://knowyourmeme.com/memes/we-need-to-go-deeper">KnowYourMeme.com</a></p>
</div>
</section>
<section id="googlenet-inception_v0-2014" class="slide level2">
<h2>GoogLeNet / Inception_v0 (2014)</h2>

<img data-src="Geron-mls2_1414.png" class="r-stretch quarto-figure-center"><p class="caption">Schematic of the GoogLeNet architecture.</p><div class="footer">
<p>Source: AurÃ©lien GÃ©ron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-14.</p>
</div>
</section>
<section id="depth-is-important-for-image-tasks" class="slide level2">
<h2>Depth is important for image tasks</h2>

<img data-src="goodfellow-depth-matters.png" class="r-stretch quarto-figure-center"><p class="caption">Deeper models arenâ€™t just better because they have more parameters. Model depth given in the legend. Accuracy is on the Street View House Numbers dataset.</p><div class="footer">
<p>Source: Goodfellow et al.&nbsp;(2015), <a href="http://www.deeplearningbook.org">Deep Learning</a>, Figure 6.7.</p>
</div>
</section>
<section id="residual-connection" class="slide level2">
<h2>Residual connection</h2>

<img data-src="Geron-mls2_1415.png" class="r-stretch quarto-figure-center"><p class="caption">Illustration of a residual connection.</p><div class="footer">
<p>Source: AurÃ©lien GÃ©ron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-15.</p>
</div>
</section>
<section id="resnet-2014" class="slide level2">
<h2>ResNet (2014)</h2>
<p>ResNet won the ILSVRC 2014 challenge (top-5 error 3.6%), developed by <a href="https://arxiv.org/abs/1512.03385">Kaiming He et al.</a></p>

<img data-src="Geron-mls2_1417.png" class="r-stretch quarto-figure-center"><p class="caption">Diagram of the ResNet architecture.</p><div class="footer">
<p>Source: AurÃ©lien GÃ©ron (2018), <em>Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow</em>, 2nd Edition, Figure 14-17.</p>
</div>
</section></section>
<section>
<section id="transfer-learning" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Transfer Learning</h1>

</section>
<section id="pretrained-model" class="slide level2">
<h2>Pretrained model</h2>
<div id="ed02e902" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a></a><span class="kw">def</span> classify_imagenet(paths, model_module, ModelClass, dims):</span>
<span id="cb83-2"><a></a>    images <span class="op">=</span> [keras.utils.load_img(path, target_size<span class="op">=</span>dims) <span class="cf">for</span> path <span class="kw">in</span> paths]</span>
<span id="cb83-3"><a></a>    image_array <span class="op">=</span> np.array([keras.utils.img_to_array(img) <span class="cf">for</span> img <span class="kw">in</span> images])</span>
<span id="cb83-4"><a></a>    inputs <span class="op">=</span> model_module.preprocess_input(image_array)</span>
<span id="cb83-5"><a></a>   </span>
<span id="cb83-6"><a></a>    model <span class="op">=</span> ModelClass(weights<span class="op">=</span><span class="st">"imagenet"</span>)</span>
<span id="cb83-7"><a></a>    Y_proba <span class="op">=</span> model.predict(inputs, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb83-8"><a></a>    top_k <span class="op">=</span> model_module.decode_predictions(Y_proba, top<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb83-9"><a></a></span>
<span id="cb83-10"><a></a>    <span class="cf">for</span> image_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(images)):</span>
<span id="cb83-11"><a></a>        <span class="bu">print</span>(<span class="ss">f"Image #</span><span class="sc">{</span>image_index<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb83-12"><a></a>        <span class="cf">for</span> class_id, name, y_proba <span class="kw">in</span> top_k[image_index]:</span>
<span id="cb83-13"><a></a>            <span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>class_id<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span><span class="bu">int</span>(y_proba<span class="op">*</span><span class="dv">100</span>)<span class="sc">}</span><span class="ss">%"</span>)</span>
<span id="cb83-14"><a></a>        <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicted-classes-mobilenet" class="slide level2">
<h2>Predicted classes (MobileNet)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="6b64ef95" class="cell" data-execution_count="67">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 39%
 n04591157 - Windsor_tie 34%
 n02749479 - assault_rifle 13%

Image #1:
 n03529860 - home_theater 25%
 n02749479 - assault_rifle 9%
 n04009552 - projector 5%

Image #2:
 n03529860 - home_theater 9%
 n03924679 - photocopier 7%
 n02786058 - Band_Aid 6%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenetv2" class="slide level2">
<h2>Predicted classes (MobileNetV2)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="a1fda160" class="cell" data-execution_count="68">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 34%
 n04591157 - Windsor_tie 8%
 n03630383 - lab_coat 7%

Image #1:
 n04023962 - punching_bag 9%
 n04336792 - stretcher 4%
 n03529860 - home_theater 4%

Image #2:
 n04404412 - television 42%
 n02977058 - cash_machine 6%
 n04152593 - screen 3%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-inceptionv3" class="slide level2">
<h2>Predicted classes (InceptionV3)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="4dc75f16" class="cell" data-execution_count="69">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n04350905 - suit 25%
 n04591157 - Windsor_tie 11%
 n03630383 - lab_coat 6%

Image #1:
 n04507155 - umbrella 52%
 n04404412 - television 2%
 n03529860 - home_theater 2%

Image #2:
 n04404412 - television 17%
 n02777292 - balance_beam 7%
 n03942813 - ping-pong_ball 6%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="patrick-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="umbrella-0.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="hand-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenet-1" class="slide level2">
<h2>Predicted classes (MobileNet)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="96ece1d7" class="cell" data-execution_count="70">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n03483316 - hand_blower 21%
 n03271574 - electric_fan 8%
 n07579787 - plate 4%

Image #1:
 n03942813 - ping-pong_ball 88%
 n02782093 - balloon 3%
 n04023962 - punching_bag 1%

Image #2:
 n04557648 - water_bottle 31%
 n04336792 - stretcher 14%
 n03868863 - oxygen_mask 7%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-mobilenetv2-1" class="slide level2">
<h2>Predicted classes (MobileNetV2)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="95681e52" class="cell" data-execution_count="71">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n03868863 - oxygen_mask 37%
 n03483316 - hand_blower 7%
 n03271574 - electric_fan 7%

Image #1:
 n03942813 - ping-pong_ball 29%
 n04270147 - spatula 12%
 n03970156 - plunger 8%

Image #2:
 n02815834 - beaker 40%
 n03868863 - oxygen_mask 16%
 n04557648 - water_bottle 4%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="predicted-classes-inceptionv3-1" class="slide level2">
<h2>Predicted classes (InceptionV3)</h2>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:50%;">
<p><br><br></p>
<div id="7d345faf" class="cell" data-execution_count="72">
<div class="cell-output cell-output-stdout">
<pre><code>Image #0:
 n02815834 - beaker 19%
 n03179701 - desk 15%
 n03868863 - oxygen_mask 9%

Image #1:
 n03942813 - ping-pong_ball 87%
 n02782093 - balloon 8%
 n02790996 - barbell 0%

Image #2:
 n04557648 - water_bottle 55%
 n03983396 - pop_bottle 9%
 n03868863 - oxygen_mask 7%
</code></pre>
</div>
</div>
</div><div class="column" style="width:20%;">
<p><img src="charger-4.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="table-tennis-17.jpg" data-lazy-loaded="" style="padding: 0px; margin: 0px"> <img src="water-bottle-15.jpg" data-lazy-loaded="" style="padding: 0px; margin=0px"></p>
</div><div class="column" style="width:15%;">

</div>
</div>
</section>
<section id="transfer-learning-1" class="slide level2">
<h2>Transfer learning</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a></a><span class="co"># Pull in the base model we are transferring from.</span></span>
<span id="cb90-2"><a></a>base_model <span class="op">=</span> keras.applications.Xception(</span>
<span id="cb90-3"><a></a>    weights<span class="op">=</span><span class="st">'imagenet'</span>,  <span class="co"># Load weights pre-trained on ImageNet.</span></span>
<span id="cb90-4"><a></a>    input_shape<span class="op">=</span>(<span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">3</span>),</span>
<span id="cb90-5"><a></a>    include_top<span class="op">=</span><span class="va">False</span>)  <span class="co"># Discard the ImageNet classifier at the top.</span></span>
<span id="cb90-6"><a></a></span>
<span id="cb90-7"><a></a><span class="co"># Tell it not to update its weights.</span></span>
<span id="cb90-8"><a></a>base_model.trainable <span class="op">=</span> <span class="va">False</span></span>
<span id="cb90-9"><a></a></span>
<span id="cb90-10"><a></a><span class="co"># Make our new model on top of the base model.</span></span>
<span id="cb90-11"><a></a>inputs <span class="op">=</span> keras.Input(shape<span class="op">=</span>(<span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">3</span>))</span>
<span id="cb90-12"><a></a>x <span class="op">=</span> base_model(inputs, training<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb90-13"><a></a>x <span class="op">=</span> keras.layers.GlobalAveragePooling1D()(x)</span>
<span id="cb90-14"><a></a>outputs <span class="op">=</span> keras.layers.Dense(<span class="dv">0</span>)(x)</span>
<span id="cb90-15"><a></a>model <span class="op">=</span> keras.Model(inputs, outputs)</span>
<span id="cb90-16"><a></a></span>
<span id="cb90-17"><a></a><span class="co"># Compile and fit on our data.</span></span>
<span id="cb90-18"><a></a>model.compile(optimizer<span class="op">=</span>keras.optimizers.Adam(),</span>
<span id="cb90-19"><a></a>              loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb90-20"><a></a>              metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb90-21"><a></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">19</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="footer">
<p>Source: FranÃ§ois Chollet (2019), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section>
<section id="fine-tuning" class="slide level2">
<h2>Fine-tuning</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a></a><span class="co"># Unfreeze the base model</span></span>
<span id="cb91-2"><a></a>base_model.trainable <span class="op">=</span> <span class="va">True</span></span>
<span id="cb91-3"><a></a></span>
<span id="cb91-4"><a></a><span class="co"># It's important to recompile your model after you make any changes</span></span>
<span id="cb91-5"><a></a><span class="co"># to the `trainable` attribute of any inner layer, so that your changes</span></span>
<span id="cb91-6"><a></a><span class="co"># are take into account</span></span>
<span id="cb91-7"><a></a>model.compile(</span>
<span id="cb91-8"><a></a>    optimizer<span class="op">=</span>keras.optimizers.Adam(<span class="fl">0e-5</span>),  <span class="co"># Very low learning rate</span></span>
<span id="cb91-9"><a></a>    loss<span class="op">=</span>keras.losses.BinaryCrossentropy(from_logits<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb91-10"><a></a>    metrics<span class="op">=</span>[keras.metrics.BinaryAccuracy()])</span>
<span id="cb91-11"><a></a></span>
<span id="cb91-12"><a></a><span class="co"># Train end-to-end. Be careful to stop before you overfit!</span></span>
<span id="cb91-13"><a></a>model.fit(new_dataset, epochs<span class="op">=</span><span class="dv">9</span>, callbacks<span class="op">=</span>..., validation_data<span class="op">=</span>...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p>Keep the learning rate low, otherwise you may accidentally throw away the useful information in the base model.</p>
</div>
</div>
</div>
<div class="footer">
<p>Source: FranÃ§ois Chollet (2019), <a href="https://keras.io/guides/transfer_learning/">Transfer learning &amp; fine-tuning</a>, Keras documentation.</p>
</div>
</section></section>
<section id="section" class="title-slide slide level1 center" data-visibility="uncounted">
<h1></h1>
<h2>
Glossary
</h2>
<div class="columns">
<div class="column">
<ul>
<li>AlexNet</li>
<li>benchmark problems</li>
<li>channels</li>
<li>CIFAR-10 / CIFAR-100</li>
<li>computer vision</li>
<li>convolutional layer</li>
<li>convolutional network</li>
<li>error analysis</li>
<li>filter</li>
</ul>
</div><div class="column">
<ul>
<li>GoogLeNet &amp; Inception</li>
<li>ImageNet challenge</li>
<li>fine-tuning</li>
<li>flatten layer</li>
<li>kernel</li>
<li>max pooling</li>
<li>MNIST</li>
<li>stride</li>
<li>transfer learning</li>
</ul>
</div>
</div>

<div class="quarto-auto-generated-content">
<p><img src="../unsw-logo.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":4,"grid":false,"background":["rgba(255,255,255,0.0)","https://github.com/rajgoel/reveal.js-plugins/raw/master/chalkboard/img/blackboard.png"]},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1000,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.12,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>